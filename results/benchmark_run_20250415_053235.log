Cleaning up existing shards directory...
Creating fresh shards directory...
Starting benchmark at Tue Apr 15 05:32:35 UTC 2025
CPU count: 16



=========================================
   WEBDATASET BENCHMARK
   Tue Apr 15 05:32:35 UTC 2025
=========================================

Reading parquet file: ./data/benchmark_shard.parquet
Loaded 176453 samples from parquet file
Processing all 176453 samples as train split
Processing dataset:   0%|          | 0/176453 [00:00<?, ?it/s]Processing dataset:   0%|          | 420/176453 [00:00<00:41, 4198.88it/s]Processing dataset:   0%|          | 875/176453 [00:00<00:39, 4400.74it/s]Processing dataset:   1%|          | 1324/176453 [00:00<00:39, 4437.56it/s]Processing dataset:   1%|          | 1779/176453 [00:00<00:39, 4478.46it/s]Processing dataset:   1%|▏         | 2230/176453 [00:00<00:38, 4488.31it/s]Processing dataset:   2%|▏         | 2683/176453 [00:00<00:38, 4502.24it/s]Processing dataset:   2%|▏         | 3138/176453 [00:00<00:38, 4517.27it/s]Processing dataset:   2%|▏         | 3593/176453 [00:00<00:38, 4523.77it/s]Processing dataset:   2%|▏         | 4046/176453 [00:00<00:38, 4502.98it/s]Processing dataset:   3%|▎         | 4504/176453 [00:01<00:37, 4525.61it/s]Processing dataset:   3%|▎         | 4957/176453 [00:01<00:37, 4526.88it/s]Processing dataset:   3%|▎         | 5416/176453 [00:01<00:37, 4545.29it/s]Processing dataset:   3%|▎         | 5872/176453 [00:01<00:37, 4547.74it/s]Processing dataset:   4%|▎         | 6328/176453 [00:01<00:37, 4549.24it/s]Processing dataset:   4%|▍         | 6783/176453 [00:01<00:37, 4540.67it/s]Processing dataset:   4%|▍         | 7241/176453 [00:01<00:37, 4550.87it/s]Processing dataset:   4%|▍         | 7700/176453 [00:01<00:37, 4559.56it/s]Processing dataset:   5%|▍         | 8156/176453 [00:01<00:36, 4548.77it/s]Processing dataset:   5%|▍         | 8615/176453 [00:01<00:36, 4559.66it/s]Processing dataset:   5%|▌         | 9075/176453 [00:02<00:36, 4568.96it/s]Processing dataset:   5%|▌         | 9535/176453 [00:02<00:36, 4575.37it/s]Processing dataset:   6%|▌         | 9993/176453 [00:02<00:36, 4529.64it/s]Processing dataset:   6%|▌         | 10449/176453 [00:02<00:36, 4537.39it/s]Processing dataset:   6%|▌         | 10912/176453 [00:02<00:36, 4564.19it/s]Processing dataset:   6%|▋         | 11372/176453 [00:02<00:36, 4573.16it/s]Processing dataset:   7%|▋         | 11830/176453 [00:02<00:36, 4558.59it/s]Processing dataset:   7%|▋         | 12292/176453 [00:02<00:35, 4574.25it/s]Processing dataset:   7%|▋         | 12750/176453 [00:02<00:35, 4571.88it/s]Processing dataset:   7%|▋         | 13208/176453 [00:02<00:35, 4566.59it/s]Processing dataset:   8%|▊         | 13666/176453 [00:03<00:35, 4569.05it/s]Processing dataset:   8%|▊         | 14127/176453 [00:03<00:35, 4580.40it/s]Processing dataset:   8%|▊         | 14586/176453 [00:03<00:35, 4571.10it/s]Processing dataset:   9%|▊         | 15045/176453 [00:03<00:35, 4575.54it/s]Processing dataset:   9%|▉         | 15503/176453 [00:03<00:35, 4554.06it/s]Processing dataset:   9%|▉         | 15962/176453 [00:03<00:35, 4564.12it/s]Processing dataset:   9%|▉         | 16421/176453 [00:03<00:35, 4569.46it/s]Processing dataset:  10%|▉         | 16878/176453 [00:03<00:34, 4566.66it/s]Processing dataset:  10%|▉         | 17343/176453 [00:03<00:34, 4590.65it/s]Processing dataset:  10%|█         | 17803/176453 [00:03<00:34, 4590.35it/s]Processing dataset:  10%|█         | 18266/176453 [00:04<00:34, 4599.47it/s]Processing dataset:  11%|█         | 18726/176453 [00:04<00:34, 4596.32it/s]Processing dataset:  11%|█         | 19186/176453 [00:04<00:34, 4564.46it/s]Processing dataset:  11%|█         | 19649/176453 [00:04<00:34, 4583.41it/s]Processing dataset:  11%|█▏        | 20108/176453 [00:04<00:34, 4559.93it/s]Processing dataset:  12%|█▏        | 20570/176453 [00:04<00:34, 4575.19it/s]Processing dataset:  12%|█▏        | 21028/176453 [00:04<00:34, 4551.62it/s]Processing dataset:  12%|█▏        | 21489/176453 [00:04<00:33, 4568.49it/s]Processing dataset:  12%|█▏        | 21948/176453 [00:04<00:33, 4572.48it/s]Processing dataset:  13%|█▎        | 22412/176453 [00:04<00:33, 4591.86it/s]Processing dataset:  13%|█▎        | 22872/176453 [00:05<00:33, 4584.30it/s]Processing dataset:  13%|█▎        | 23331/176453 [00:05<00:33, 4559.84it/s]Processing dataset:  13%|█▎        | 23788/176453 [00:05<00:33, 4560.36it/s]Processing dataset:  14%|█▎        | 24245/176453 [00:05<00:33, 4562.07it/s]Processing dataset:  14%|█▍        | 24705/176453 [00:05<00:33, 4570.28it/s]Processing dataset:  14%|█▍        | 25167/176453 [00:05<00:33, 4582.29it/s]Processing dataset:  15%|█▍        | 25627/176453 [00:05<00:32, 4586.87it/s]Processing dataset:  15%|█▍        | 26086/176453 [00:05<00:32, 4582.87it/s]Processing dataset:  15%|█▌        | 26547/176453 [00:05<00:32, 4588.97it/s]Processing dataset:  15%|█▌        | 27006/176453 [00:05<00:32, 4577.39it/s]Processing dataset:  16%|█▌        | 27467/176453 [00:06<00:32, 4586.66it/s]Processing dataset:  16%|█▌        | 27926/176453 [00:06<00:32, 4586.79it/s]Processing dataset:  16%|█▌        | 28388/176453 [00:06<00:32, 4594.15it/s]Processing dataset:  16%|█▋        | 28848/176453 [00:06<00:32, 4590.36it/s]Processing dataset:  17%|█▋        | 29308/176453 [00:06<00:32, 4587.25it/s]Processing dataset:  17%|█▋        | 29772/176453 [00:06<00:31, 4600.59it/s]Processing dataset:  17%|█▋        | 30233/176453 [00:06<00:31, 4591.34it/s]Processing dataset:  17%|█▋        | 30693/176453 [00:06<00:31, 4584.57it/s]Processing dataset:  18%|█▊        | 31152/176453 [00:06<00:31, 4554.88it/s]Processing dataset:  18%|█▊        | 31610/176453 [00:06<00:31, 4560.39it/s]Processing dataset:  18%|█▊        | 32067/176453 [00:07<00:31, 4558.59it/s]Processing dataset:  18%|█▊        | 32528/176453 [00:07<00:31, 4573.44it/s]Processing dataset:  19%|█▊        | 32986/176453 [00:07<00:31, 4548.55it/s]Processing dataset:  19%|█▉        | 33447/176453 [00:07<00:31, 4565.29it/s]Processing dataset:  19%|█▉        | 33913/176453 [00:07<00:31, 4591.22it/s]Processing dataset:  19%|█▉        | 34378/176453 [00:07<00:30, 4608.67it/s]Processing dataset:  20%|█▉        | 34839/176453 [00:07<00:30, 4583.28it/s]Processing dataset:  20%|██        | 35300/176453 [00:07<00:30, 4588.81it/s]Processing dataset:  20%|██        | 35761/176453 [00:07<00:30, 4592.49it/s]Processing dataset:  21%|██        | 36223/176453 [00:07<00:30, 4600.14it/s]Processing dataset:  21%|██        | 36684/176453 [00:08<00:30, 4594.38it/s]Processing dataset:  21%|██        | 37148/176453 [00:08<00:30, 4607.53it/s]Processing dataset:  21%|██▏       | 37618/176453 [00:08<00:29, 4633.57it/s]Processing dataset:  22%|██▏       | 38082/176453 [00:08<00:29, 4626.06it/s]Processing dataset:  22%|██▏       | 38545/176453 [00:08<00:29, 4613.74it/s]Processing dataset:  22%|██▏       | 39007/176453 [00:08<00:30, 4579.30it/s]Processing dataset:  22%|██▏       | 39466/176453 [00:08<00:29, 4581.96it/s]Processing dataset:  23%|██▎       | 39926/176453 [00:08<00:29, 4587.21it/s]Processing dataset:  23%|██▎       | 40390/176453 [00:08<00:29, 4602.34it/s]Processing dataset:  23%|██▎       | 40851/176453 [00:08<00:29, 4603.56it/s]Processing dataset:  23%|██▎       | 41312/176453 [00:09<00:29, 4601.94it/s]Processing dataset:  24%|██▎       | 41773/176453 [00:09<00:29, 4599.09it/s]Processing dataset:  24%|██▍       | 42235/176453 [00:09<00:29, 4604.07it/s]Processing dataset:  24%|██▍       | 42696/176453 [00:09<00:29, 4582.77it/s]Processing dataset:  24%|██▍       | 43155/176453 [00:09<00:29, 4576.82it/s]Processing dataset:  25%|██▍       | 43616/176453 [00:09<00:28, 4583.96it/s]Processing dataset:  25%|██▍       | 44079/176453 [00:09<00:28, 4594.92it/s]Processing dataset:  25%|██▌       | 44545/176453 [00:09<00:28, 4613.08it/s]Processing dataset:  26%|██▌       | 45009/176453 [00:09<00:28, 4618.66it/s]Processing dataset:  26%|██▌       | 45471/176453 [00:09<00:28, 4606.88it/s]Processing dataset:  26%|██▌       | 45932/176453 [00:10<00:28, 4573.51it/s]Processing dataset:  26%|██▋       | 46390/176453 [00:10<00:28, 4544.04it/s]Processing dataset:  27%|██▋       | 46846/176453 [00:10<00:28, 4548.52it/s]Processing dataset:  27%|██▋       | 47303/176453 [00:10<00:28, 4553.94it/s]Processing dataset:  27%|██▋       | 47759/176453 [00:10<00:28, 4545.70it/s]Processing dataset:  27%|██▋       | 48215/176453 [00:10<00:28, 4548.51it/s]Processing dataset:  28%|██▊       | 48670/176453 [00:10<00:28, 4545.88it/s]Processing dataset:  28%|██▊       | 49127/176453 [00:10<00:27, 4550.63it/s]Processing dataset:  28%|██▊       | 49588/176453 [00:10<00:27, 4566.33it/s]Processing dataset:  28%|██▊       | 50045/176453 [00:10<00:27, 4544.06it/s]Processing dataset:  29%|██▊       | 50500/176453 [00:11<00:27, 4498.48it/s]Processing dataset:  29%|██▉       | 50952/176453 [00:11<00:27, 4504.39it/s]Processing dataset:  29%|██▉       | 51410/176453 [00:11<00:27, 4526.77it/s]Processing dataset:  29%|██▉       | 51869/176453 [00:11<00:27, 4542.84it/s]Processing dataset:  30%|██▉       | 52324/176453 [00:11<00:27, 4543.82it/s]Processing dataset:  30%|██▉       | 52779/176453 [00:11<00:27, 4527.82it/s]Processing dataset:  30%|███       | 53232/176453 [00:11<00:27, 4523.48it/s]Processing dataset:  30%|███       | 53687/176453 [00:11<00:27, 4530.14it/s]Processing dataset:  31%|███       | 54141/176453 [00:11<00:27, 4496.24it/s]Processing dataset:  31%|███       | 54591/176453 [00:11<00:27, 4487.84it/s]Processing dataset:  31%|███       | 55040/176453 [00:12<00:27, 4475.20it/s]Processing dataset:  31%|███▏      | 55491/176453 [00:12<00:26, 4482.50it/s]Processing dataset:  32%|███▏      | 55940/176453 [00:12<00:26, 4476.68it/s]Processing dataset:  32%|███▏      | 56391/176453 [00:12<00:26, 4485.05it/s]Processing dataset:  32%|███▏      | 56840/176453 [00:12<00:26, 4475.53it/s]Processing dataset:  32%|███▏      | 57293/176453 [00:12<00:26, 4490.83it/s]Processing dataset:  33%|███▎      | 57746/176453 [00:12<00:26, 4493.28it/s]Processing dataset:  33%|███▎      | 58196/176453 [00:12<00:26, 4485.57it/s]Processing dataset:  33%|███▎      | 58645/176453 [00:12<00:26, 4464.21it/s]Processing dataset:  33%|███▎      | 59092/176453 [00:12<00:26, 4462.94it/s]Processing dataset:  34%|███▎      | 59539/176453 [00:13<00:26, 4454.14it/s]Processing dataset:  34%|███▍      | 59993/176453 [00:13<00:26, 4478.26it/s]Processing dataset:  34%|███▍      | 60449/176453 [00:13<00:25, 4500.63it/s]Processing dataset:  35%|███▍      | 60904/176453 [00:13<00:25, 4513.88it/s]Processing dataset:  35%|███▍      | 61356/176453 [00:13<00:25, 4503.90it/s]Processing dataset:  35%|███▌      | 61807/176453 [00:13<00:25, 4486.79it/s]Processing dataset:  35%|███▌      | 62259/176453 [00:13<00:25, 4494.89it/s]Processing dataset:  36%|███▌      | 62711/176453 [00:13<00:25, 4501.67it/s]Processing dataset:  36%|███▌      | 63167/176453 [00:13<00:25, 4517.03it/s]Processing dataset:  36%|███▌      | 63622/176453 [00:13<00:24, 4526.72it/s]Processing dataset:  36%|███▋      | 64075/176453 [00:14<00:24, 4524.39it/s]Processing dataset:  37%|███▋      | 64529/176453 [00:14<00:24, 4527.74it/s]Processing dataset:  37%|███▋      | 64985/176453 [00:14<00:24, 4534.91it/s]Processing dataset:  37%|███▋      | 65439/176453 [00:14<00:24, 4512.91it/s]Processing dataset:  37%|███▋      | 65891/176453 [00:14<00:24, 4513.04it/s]Processing dataset:  38%|███▊      | 66343/176453 [00:14<00:29, 3728.43it/s]Processing dataset:  38%|███▊      | 66795/176453 [00:14<00:27, 3933.19it/s]Processing dataset:  38%|███▊      | 67252/176453 [00:14<00:26, 4105.76it/s]Processing dataset:  38%|███▊      | 67705/176453 [00:14<00:25, 4222.58it/s]Processing dataset:  39%|███▊      | 68164/176453 [00:15<00:25, 4324.65it/s]Processing dataset:  39%|███▉      | 68623/176453 [00:15<00:24, 4398.86it/s]Processing dataset:  39%|███▉      | 69077/176453 [00:15<00:24, 4439.10it/s]Processing dataset:  39%|███▉      | 69527/176453 [00:15<00:23, 4456.55it/s]Processing dataset:  40%|███▉      | 69980/176453 [00:15<00:23, 4477.23it/s]Processing dataset:  40%|███▉      | 70437/176453 [00:15<00:23, 4504.18it/s]Processing dataset:  40%|████      | 70897/176453 [00:15<00:23, 4531.08it/s]Processing dataset:  40%|████      | 71352/176453 [00:15<00:23, 4534.48it/s]Processing dataset:  41%|████      | 71807/176453 [00:15<00:23, 4539.05it/s]Processing dataset:  41%|████      | 72262/176453 [00:15<00:22, 4541.06it/s]Processing dataset:  41%|████      | 72717/176453 [00:16<00:22, 4524.36it/s]Processing dataset:  41%|████▏     | 73170/176453 [00:16<00:22, 4519.43it/s]Processing dataset:  42%|████▏     | 73625/176453 [00:16<00:22, 4528.03it/s]Processing dataset:  42%|████▏     | 74081/176453 [00:16<00:22, 4535.47it/s]Processing dataset:  42%|████▏     | 74538/176453 [00:16<00:22, 4545.67it/s]Processing dataset:  43%|████▎     | 74996/176453 [00:16<00:22, 4553.01it/s]Processing dataset:  43%|████▎     | 75452/176453 [00:16<00:22, 4554.91it/s]Processing dataset:  43%|████▎     | 75908/176453 [00:16<00:22, 4547.59it/s]Processing dataset:  43%|████▎     | 76363/176453 [00:16<00:22, 4545.19it/s]Processing dataset:  44%|████▎     | 76818/176453 [00:16<00:22, 4522.69it/s]Processing dataset:  44%|████▍     | 77271/176453 [00:17<00:21, 4511.37it/s]Processing dataset:  44%|████▍     | 77727/176453 [00:17<00:21, 4523.93it/s]Processing dataset:  44%|████▍     | 78182/176453 [00:17<00:21, 4530.08it/s]Processing dataset:  45%|████▍     | 78637/176453 [00:17<00:21, 4535.80it/s]Processing dataset:  45%|████▍     | 79091/176453 [00:17<00:21, 4495.17it/s]Processing dataset:  45%|████▌     | 79542/176453 [00:17<00:21, 4497.27it/s]Processing dataset:  45%|████▌     | 80004/176453 [00:17<00:21, 4533.29it/s]Processing dataset:  46%|████▌     | 80465/176453 [00:17<00:21, 4553.06it/s]Processing dataset:  46%|████▌     | 80921/176453 [00:17<00:21, 4536.71it/s]Processing dataset:  46%|████▌     | 81382/176453 [00:17<00:20, 4556.16it/s]Processing dataset:  46%|████▋     | 81843/176453 [00:18<00:20, 4571.60it/s]Processing dataset:  47%|████▋     | 82301/176453 [00:18<00:20, 4571.56it/s]Processing dataset:  47%|████▋     | 82759/176453 [00:18<00:20, 4566.49it/s]Processing dataset:  47%|████▋     | 83218/176453 [00:18<00:20, 4572.02it/s]Processing dataset:  47%|████▋     | 83678/176453 [00:18<00:20, 4577.10it/s]Processing dataset:  48%|████▊     | 84136/176453 [00:18<00:20, 4566.11it/s]Processing dataset:  48%|████▊     | 84593/176453 [00:18<00:20, 4540.59it/s]Processing dataset:  48%|████▊     | 85048/176453 [00:18<00:20, 4532.27it/s]Processing dataset:  48%|████▊     | 85510/176453 [00:18<00:19, 4556.12it/s]Processing dataset:  49%|████▊     | 85966/176453 [00:18<00:19, 4554.98it/s]Processing dataset:  49%|████▉     | 86424/176453 [00:19<00:19, 4560.42it/s]Processing dataset:  49%|████▉     | 86883/176453 [00:19<00:19, 4569.10it/s]Processing dataset:  49%|████▉     | 87341/176453 [00:19<00:19, 4570.09it/s]Processing dataset:  50%|████▉     | 87800/176453 [00:19<00:19, 4573.82it/s]Processing dataset:  50%|█████     | 88258/176453 [00:19<00:19, 4563.08it/s]Processing dataset:  50%|█████     | 88715/176453 [00:19<00:19, 4548.88it/s]Processing dataset:  51%|█████     | 89173/176453 [00:19<00:19, 4554.15it/s]Processing dataset:  51%|█████     | 89629/176453 [00:19<00:19, 4553.10it/s]Processing dataset:  51%|█████     | 90091/176453 [00:19<00:18, 4570.14it/s]Processing dataset:  51%|█████▏    | 90549/176453 [00:19<00:19, 4504.73it/s]Processing dataset:  52%|█████▏    | 91001/176453 [00:20<00:18, 4506.46it/s]Processing dataset:  52%|█████▏    | 91460/176453 [00:20<00:18, 4530.12it/s]Processing dataset:  52%|█████▏    | 91914/176453 [00:20<00:18, 4522.41it/s]Processing dataset:  52%|█████▏    | 92367/176453 [00:20<00:18, 4516.39it/s]Processing dataset:  53%|█████▎    | 92825/176453 [00:20<00:18, 4534.54it/s]Processing dataset:  53%|█████▎    | 93283/176453 [00:20<00:18, 4547.97it/s]Processing dataset:  53%|█████▎    | 93742/176453 [00:20<00:18, 4559.26it/s]Processing dataset:  53%|█████▎    | 94202/176453 [00:20<00:17, 4570.39it/s]Processing dataset:  54%|█████▎    | 94663/176453 [00:20<00:17, 4582.21it/s]Processing dataset:  54%|█████▍    | 95125/176453 [00:20<00:17, 4593.33it/s]Processing dataset:  54%|█████▍    | 95585/176453 [00:21<00:17, 4586.00it/s]Processing dataset:  54%|█████▍    | 96044/176453 [00:21<00:17, 4557.32it/s]Processing dataset:  55%|█████▍    | 96500/176453 [00:21<00:17, 4553.88it/s]Processing dataset:  55%|█████▍    | 96956/176453 [00:21<00:17, 4554.59it/s]Processing dataset:  55%|█████▌    | 97420/176453 [00:21<00:17, 4579.70it/s]Processing dataset:  55%|█████▌    | 97882/176453 [00:21<00:17, 4589.38it/s]Processing dataset:  56%|█████▌    | 98341/176453 [00:21<00:17, 4585.59it/s]Processing dataset:  56%|█████▌    | 98800/176453 [00:21<00:16, 4582.70it/s]Processing dataset:  56%|█████▋    | 99259/176453 [00:21<00:16, 4572.85it/s]Processing dataset:  57%|█████▋    | 99720/176453 [00:21<00:16, 4582.70it/s]Processing dataset:  57%|█████▋    | 100179/176453 [00:22<00:16, 4568.38it/s]Processing dataset:  57%|█████▋    | 100636/176453 [00:22<00:16, 4564.90it/s]Processing dataset:  57%|█████▋    | 101094/176453 [00:22<00:16, 4566.55it/s]Processing dataset:  58%|█████▊    | 101551/176453 [00:22<00:16, 4565.03it/s]Processing dataset:  58%|█████▊    | 102008/176453 [00:22<00:16, 4559.76it/s]Processing dataset:  58%|█████▊    | 102464/176453 [00:22<00:16, 4558.25it/s]Processing dataset:  58%|█████▊    | 102924/176453 [00:22<00:16, 4568.43it/s]Processing dataset:  59%|█████▊    | 103382/176453 [00:22<00:15, 4569.74it/s]Processing dataset:  59%|█████▉    | 103839/176453 [00:22<00:15, 4546.84it/s]Processing dataset:  59%|█████▉    | 104294/176453 [00:22<00:15, 4540.00it/s]Processing dataset:  59%|█████▉    | 104749/176453 [00:23<00:15, 4539.28it/s]Processing dataset:  60%|█████▉    | 105203/176453 [00:23<00:15, 4532.02it/s]Processing dataset:  60%|█████▉    | 105665/176453 [00:23<00:15, 4555.80it/s]Processing dataset:  60%|██████    | 106126/176453 [00:23<00:15, 4570.54it/s]Processing dataset:  60%|██████    | 106586/176453 [00:23<00:15, 4578.19it/s]Processing dataset:  61%|██████    | 107044/176453 [00:23<00:15, 4568.81it/s]Processing dataset:  61%|██████    | 107501/176453 [00:23<00:15, 4554.59it/s]Processing dataset:  61%|██████    | 107957/176453 [00:23<00:15, 4550.88it/s]Processing dataset:  61%|██████▏   | 108417/176453 [00:23<00:14, 4563.40it/s]Processing dataset:  62%|██████▏   | 108874/176453 [00:23<00:14, 4562.89it/s]Processing dataset:  62%|██████▏   | 109337/176453 [00:24<00:14, 4581.45it/s]Processing dataset:  62%|██████▏   | 109796/176453 [00:24<00:14, 4570.20it/s]Processing dataset:  62%|██████▏   | 110256/176453 [00:24<00:14, 4575.92it/s]Processing dataset:  63%|██████▎   | 110717/176453 [00:24<00:14, 4586.09it/s]Processing dataset:  63%|██████▎   | 111176/176453 [00:24<00:14, 4583.41it/s]Processing dataset:  63%|██████▎   | 111635/176453 [00:24<00:14, 4562.92it/s]Processing dataset:  64%|██████▎   | 112092/176453 [00:24<00:14, 4544.68it/s]Processing dataset:  64%|██████▍   | 112551/176453 [00:24<00:14, 4556.49it/s]Processing dataset:  64%|██████▍   | 113007/176453 [00:24<00:13, 4549.27it/s]Processing dataset:  64%|██████▍   | 113464/176453 [00:24<00:13, 4552.23it/s]Processing dataset:  65%|██████▍   | 113925/176453 [00:25<00:13, 4567.96it/s]Processing dataset:  65%|██████▍   | 114385/176453 [00:25<00:13, 4574.89it/s]Processing dataset:  65%|██████▌   | 114846/176453 [00:25<00:13, 4583.01it/s]Processing dataset:  65%|██████▌   | 115305/176453 [00:25<00:13, 4556.20it/s]Processing dataset:  66%|██████▌   | 115767/176453 [00:25<00:13, 4572.90it/s]Processing dataset:  66%|██████▌   | 116227/176453 [00:25<00:13, 4579.67it/s]Processing dataset:  66%|██████▌   | 116685/176453 [00:25<00:13, 4579.73it/s]Processing dataset:  66%|██████▋   | 117143/176453 [00:25<00:12, 4579.30it/s]Processing dataset:  67%|██████▋   | 117604/176453 [00:25<00:12, 4586.48it/s]Processing dataset:  67%|██████▋   | 118063/176453 [00:26<00:12, 4558.97it/s]Processing dataset:  67%|██████▋   | 118522/176453 [00:26<00:12, 4567.04it/s]Processing dataset:  67%|██████▋   | 118979/176453 [00:26<00:12, 4548.18it/s]Processing dataset:  68%|██████▊   | 119436/176453 [00:26<00:12, 4552.29it/s]Processing dataset:  68%|██████▊   | 119894/176453 [00:26<00:12, 4557.81it/s]Processing dataset:  68%|██████▊   | 120350/176453 [00:26<00:12, 4553.23it/s]Processing dataset:  68%|██████▊   | 120811/176453 [00:26<00:12, 4569.56it/s]Processing dataset:  69%|██████▊   | 121268/176453 [00:26<00:12, 4566.43it/s]Processing dataset:  69%|██████▉   | 121725/176453 [00:26<00:12, 4559.17it/s]Processing dataset:  69%|██████▉   | 122181/176453 [00:26<00:11, 4536.88it/s]Processing dataset:  70%|██████▉   | 122635/176453 [00:27<00:11, 4527.04it/s]Processing dataset:  70%|██████▉   | 123088/176453 [00:27<00:11, 4506.40it/s]Processing dataset:  70%|███████   | 123539/176453 [00:27<00:11, 4500.34it/s]Processing dataset:  70%|███████   | 123995/176453 [00:27<00:11, 4515.69it/s]Processing dataset:  71%|███████   | 124447/176453 [00:27<00:11, 4512.40it/s]Processing dataset:  71%|███████   | 124899/176453 [00:27<00:11, 4490.02it/s]Processing dataset:  71%|███████   | 125360/176453 [00:27<00:11, 4525.17it/s]Processing dataset:  71%|███████▏  | 125821/176453 [00:27<00:11, 4548.66it/s]Processing dataset:  72%|███████▏  | 126280/176453 [00:27<00:11, 4558.85it/s]Processing dataset:  72%|███████▏  | 126736/176453 [00:27<00:10, 4530.19it/s]Processing dataset:  72%|███████▏  | 127190/176453 [00:28<00:10, 4491.18it/s]Processing dataset:  72%|███████▏  | 127649/176453 [00:28<00:10, 4519.01it/s]Processing dataset:  73%|███████▎  | 128107/176453 [00:28<00:10, 4535.03it/s]Processing dataset:  73%|███████▎  | 128561/176453 [00:28<00:10, 4535.83it/s]Processing dataset:  73%|███████▎  | 129016/176453 [00:28<00:10, 4539.53it/s]Processing dataset:  73%|███████▎  | 129472/176453 [00:28<00:10, 4544.34it/s]Processing dataset:  74%|███████▎  | 129928/176453 [00:28<00:10, 4546.46it/s]Processing dataset:  74%|███████▍  | 130383/176453 [00:28<00:10, 4539.59it/s]Processing dataset:  74%|███████▍  | 130837/176453 [00:28<00:10, 4467.90it/s]Processing dataset:  74%|███████▍  | 131297/176453 [00:28<00:10, 4504.13it/s]Processing dataset:  75%|███████▍  | 131753/176453 [00:29<00:09, 4519.41it/s]Processing dataset:  75%|███████▍  | 132210/176453 [00:29<00:09, 4532.11it/s]Processing dataset:  75%|███████▌  | 132665/176453 [00:29<00:09, 4536.49it/s]Processing dataset:  75%|███████▌  | 133125/176453 [00:29<00:09, 4554.17it/s]Processing dataset:  76%|███████▌  | 133582/176453 [00:29<00:09, 4557.49it/s]Processing dataset:  76%|███████▌  | 134038/176453 [00:29<00:09, 4550.34it/s]Processing dataset:  76%|███████▌  | 134494/176453 [00:29<00:09, 4537.77it/s]Processing dataset:  76%|███████▋  | 134948/176453 [00:29<00:09, 4495.37it/s]Processing dataset:  77%|███████▋  | 135399/176453 [00:29<00:09, 4498.37it/s]Processing dataset:  77%|███████▋  | 135849/176453 [00:29<00:09, 4492.84it/s]Processing dataset:  77%|███████▋  | 136301/176453 [00:30<00:08, 4500.53it/s]Processing dataset:  78%|███████▊  | 136753/176453 [00:30<00:08, 4504.00it/s]Processing dataset:  78%|███████▊  | 137207/176453 [00:30<00:08, 4512.44it/s]Processing dataset:  78%|███████▊  | 137659/176453 [00:30<00:08, 4496.45it/s]Processing dataset:  78%|███████▊  | 138109/176453 [00:30<00:08, 4493.55it/s]Processing dataset:  79%|███████▊  | 138559/176453 [00:30<00:08, 4473.01it/s]Processing dataset:  79%|███████▉  | 139011/176453 [00:30<00:08, 4485.09it/s]Processing dataset:  79%|███████▉  | 139467/176453 [00:30<00:08, 4506.66it/s]Processing dataset:  79%|███████▉  | 139918/176453 [00:30<00:08, 4447.47it/s]Processing dataset:  80%|███████▉  | 140365/176453 [00:30<00:08, 4451.66it/s]Processing dataset:  80%|███████▉  | 140811/176453 [00:31<00:08, 4444.37it/s]Processing dataset:  80%|████████  | 141262/176453 [00:31<00:07, 4463.38it/s]Processing dataset:  80%|████████  | 141716/176453 [00:31<00:07, 4486.04it/s]Processing dataset:  81%|████████  | 142177/176453 [00:31<00:07, 4520.51it/s]Processing dataset:  81%|████████  | 142630/176453 [00:31<00:07, 4498.51it/s]Processing dataset:  81%|████████  | 143083/176453 [00:31<00:07, 4507.51it/s]Processing dataset:  81%|████████▏ | 143541/176453 [00:31<00:07, 4527.48it/s]Processing dataset:  82%|████████▏ | 143997/176453 [00:31<00:07, 4534.97it/s]Processing dataset:  82%|████████▏ | 144451/176453 [00:31<00:07, 4534.47it/s]Processing dataset:  82%|████████▏ | 144905/176453 [00:32<00:08, 3709.37it/s]Processing dataset:  82%|████████▏ | 145357/176453 [00:32<00:07, 3917.99it/s]Processing dataset:  83%|████████▎ | 145809/176453 [00:32<00:07, 4079.32it/s]Processing dataset:  83%|████████▎ | 146251/176453 [00:32<00:07, 4171.84it/s]Processing dataset:  83%|████████▎ | 146704/176453 [00:32<00:06, 4272.35it/s]Processing dataset:  83%|████████▎ | 147160/176453 [00:32<00:06, 4352.82it/s]Processing dataset:  84%|████████▎ | 147618/176453 [00:32<00:06, 4416.61it/s]Processing dataset:  84%|████████▍ | 148075/176453 [00:32<00:06, 4460.14it/s]Processing dataset:  84%|████████▍ | 148525/176453 [00:32<00:06, 4471.03it/s]Processing dataset:  84%|████████▍ | 148975/176453 [00:32<00:06, 4449.62it/s]Processing dataset:  85%|████████▍ | 149428/176453 [00:33<00:06, 4471.49it/s]Processing dataset:  85%|████████▍ | 149885/176453 [00:33<00:05, 4499.79it/s]Processing dataset:  85%|████████▌ | 150336/176453 [00:33<00:05, 4487.82it/s]Processing dataset:  85%|████████▌ | 150794/176453 [00:33<00:05, 4513.42it/s]Processing dataset:  86%|████████▌ | 151248/176453 [00:33<00:05, 4520.68it/s]Processing dataset:  86%|████████▌ | 151701/176453 [00:33<00:05, 4519.95it/s]Processing dataset:  86%|████████▌ | 152159/176453 [00:33<00:05, 4535.69it/s]Processing dataset:  86%|████████▋ | 152613/176453 [00:33<00:05, 4527.07it/s]Processing dataset:  87%|████████▋ | 153071/176453 [00:33<00:05, 4542.06it/s]Processing dataset:  87%|████████▋ | 153526/176453 [00:33<00:05, 4539.06it/s]Processing dataset:  87%|████████▋ | 153980/176453 [00:34<00:04, 4528.55it/s]Processing dataset:  88%|████████▊ | 154435/176453 [00:34<00:04, 4534.33it/s]Processing dataset:  88%|████████▊ | 154889/176453 [00:34<00:04, 4534.67it/s]Processing dataset:  88%|████████▊ | 155343/176453 [00:34<00:04, 4533.15it/s]Processing dataset:  88%|████████▊ | 155797/176453 [00:34<00:04, 4532.03it/s]Processing dataset:  89%|████████▊ | 156255/176453 [00:34<00:04, 4543.30it/s]Processing dataset:  89%|████████▉ | 156714/176453 [00:34<00:04, 4555.93it/s]Processing dataset:  89%|████████▉ | 157170/176453 [00:34<00:04, 4552.89it/s]Processing dataset:  89%|████████▉ | 157626/176453 [00:34<00:04, 4431.72it/s]Processing dataset:  90%|████████▉ | 158070/176453 [00:34<00:04, 4384.55it/s]Processing dataset:  90%|████████▉ | 158523/176453 [00:35<00:04, 4426.96it/s]Processing dataset:  90%|█████████ | 158977/176453 [00:35<00:03, 4460.06it/s]Processing dataset:  90%|█████████ | 159431/176453 [00:35<00:03, 4482.51it/s]Processing dataset:  91%|█████████ | 159886/176453 [00:35<00:03, 4501.43it/s]Processing dataset:  91%|█████████ | 160345/176453 [00:35<00:03, 4526.96it/s]Processing dataset:  91%|█████████ | 160803/176453 [00:35<00:03, 4542.22it/s]Processing dataset:  91%|█████████▏| 161259/176453 [00:35<00:03, 4547.40it/s]Processing dataset:  92%|█████████▏| 161714/176453 [00:35<00:03, 4547.57it/s]Processing dataset:  92%|█████████▏| 162169/176453 [00:35<00:03, 4519.10it/s]Processing dataset:  92%|█████████▏| 162621/176453 [00:35<00:03, 4519.21it/s]Processing dataset:  92%|█████████▏| 163073/176453 [00:36<00:02, 4510.57it/s]Processing dataset:  93%|█████████▎| 163530/176453 [00:36<00:02, 4525.81it/s]Processing dataset:  93%|█████████▎| 163985/176453 [00:36<00:02, 4531.77it/s]Processing dataset:  93%|█████████▎| 164439/176453 [00:36<00:02, 4520.29it/s]Processing dataset:  93%|█████████▎| 164896/176453 [00:36<00:02, 4534.60it/s]Processing dataset:  94%|█████████▎| 165351/176453 [00:36<00:02, 4536.68it/s]Processing dataset:  94%|█████████▍| 165805/176453 [00:36<00:02, 4513.76it/s]Processing dataset:  94%|█████████▍| 166259/176453 [00:36<00:02, 4520.10it/s]Processing dataset:  94%|█████████▍| 166713/176453 [00:36<00:02, 4524.17it/s]Processing dataset:  95%|█████████▍| 167166/176453 [00:36<00:02, 4482.37it/s]Processing dataset:  95%|█████████▍| 167619/176453 [00:37<00:01, 4493.13it/s]Processing dataset:  95%|█████████▌| 168074/176453 [00:37<00:01, 4509.41it/s]Processing dataset:  96%|█████████▌| 168533/176453 [00:37<00:01, 4531.62it/s]Processing dataset:  96%|█████████▌| 168988/176453 [00:37<00:01, 4534.40it/s]Processing dataset:  96%|█████████▌| 169445/176453 [00:37<00:01, 4543.84it/s]Processing dataset:  96%|█████████▋| 169900/176453 [00:37<00:01, 4527.54it/s]Processing dataset:  97%|█████████▋| 170355/176453 [00:37<00:01, 4532.29it/s]Processing dataset:  97%|█████████▋| 170809/176453 [00:37<00:01, 4529.39it/s]Processing dataset:  97%|█████████▋| 171264/176453 [00:37<00:01, 4534.45it/s]Processing dataset:  97%|█████████▋| 171718/176453 [00:37<00:01, 4532.46it/s]Processing dataset:  98%|█████████▊| 172172/176453 [00:38<00:00, 4531.94it/s]Processing dataset:  98%|█████████▊| 172629/176453 [00:38<00:00, 4541.56it/s]Processing dataset:  98%|█████████▊| 173090/176453 [00:38<00:00, 4561.23it/s]Processing dataset:  98%|█████████▊| 173547/176453 [00:38<00:00, 4545.93it/s]Processing dataset:  99%|█████████▊| 174002/176453 [00:38<00:00, 4535.24it/s]Processing dataset:  99%|█████████▉| 174459/176453 [00:38<00:00, 4544.17it/s]Processing dataset:  99%|█████████▉| 174916/176453 [00:38<00:00, 4551.74it/s]Processing dataset:  99%|█████████▉| 175373/176453 [00:38<00:00, 4555.24it/s]Processing dataset: 100%|█████████▉| 175829/176453 [00:38<00:00, 4551.76it/s]Processing dataset: 100%|█████████▉| 176288/176453 [00:38<00:00, 4562.49it/s]Processing dataset: 100%|██████████| 176453/176453 [00:38<00:00, 4525.39it/s]
Dataset processed. Output in ./shards/webdataset/
Dataset write time: 39.07 seconds
Total script execution time: 91.03 seconds
Converting ./data/benchmark_shard.parquet to WebDataset format in ./shards/webdataset
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/webdataset_converter.py --data ./data/benchmark_shard.parquet --shards ./shards/webdataset --prefix benchmark

Timing Summary:
  Converter execution time: 94.55 seconds
  Total script time: 94.56 seconds


=========================================
   MOSAICML MDS BENCHMARK
   Tue Apr 15 05:34:10 UTC 2025
=========================================

Reading parquet file: ./data/benchmark_shard.parquet
Loaded 176453 samples from parquet file
Using 16 worker processes
Writing 176453 samples to MDS format at: ./shards/mds
  0%|          | 0/176453 [00:00<?, ?it/s]  1%|          | 1659/176453 [00:00<00:10, 16585.11it/s]  2%|▏         | 3318/176453 [00:00<00:16, 10795.02it/s]  3%|▎         | 4512/176453 [00:00<00:19, 9043.49it/s]   3%|▎         | 5667/176453 [00:00<00:20, 8240.56it/s]  4%|▍         | 7633/176453 [00:00<00:18, 8927.32it/s]  5%|▌         | 9595/176453 [00:01<00:17, 9293.95it/s]  7%|▋         | 11565/176453 [00:01<00:17, 9511.95it/s]  8%|▊         | 13505/176453 [00:01<00:17, 9576.40it/s]  9%|▉         | 15486/176453 [00:01<00:16, 9683.51it/s] 10%|▉         | 17405/176453 [00:01<00:16, 9706.97it/s] 11%|█         | 19291/176453 [00:02<00:16, 9700.95it/s] 12%|█▏        | 21187/176453 [00:02<00:15, 9706.38it/s] 13%|█▎        | 23094/176453 [00:02<00:15, 9732.86it/s] 14%|█▍        | 25041/176453 [00:02<00:15, 9787.89it/s] 15%|█▌        | 26991/176453 [00:02<00:15, 9836.14it/s] 16%|█▋        | 28919/176453 [00:02<00:14, 9850.17it/s] 17%|█▋        | 30824/176453 [00:03<00:14, 9835.82it/s] 19%|█▊        | 32772/176453 [00:03<00:14, 9857.59it/s] 20%|█▉        | 34700/176453 [00:03<00:14, 9859.62it/s] 21%|██        | 36656/176453 [00:03<00:14, 9887.93it/s] 22%|██▏       | 38522/176453 [00:03<00:14, 9679.65it/s] 23%|██▎       | 40451/176453 [00:04<00:13, 9734.19it/s] 24%|██▍       | 42334/176453 [00:04<00:13, 9731.07it/s] 25%|██▌       | 44313/176453 [00:04<00:13, 9839.36it/s] 26%|██▌       | 46244/176453 [00:04<00:13, 9861.86it/s] 27%|██▋       | 48130/176453 [00:04<00:13, 9834.26it/s] 28%|██▊       | 50071/176453 [00:05<00:12, 9858.98it/s] 30%|██▉       | 52067/176453 [00:05<00:12, 9952.76it/s] 31%|███       | 54041/176453 [00:05<00:12, 9994.54it/s] 32%|███▏      | 55973/176453 [00:05<00:12, 9971.37it/s] 33%|███▎      | 57895/176453 [00:05<00:11, 9943.24it/s] 34%|███▍      | 59870/176453 [00:06<00:11, 9959.86it/s] 35%|███▌      | 61800/176453 [00:06<00:11, 9933.24it/s] 36%|███▌      | 63705/176453 [00:06<00:11, 9891.01it/s] 37%|███▋      | 65596/176453 [00:06<00:11, 9845.87it/s] 38%|███▊      | 67534/176453 [00:06<00:11, 9862.61it/s] 39%|███▉      | 69491/176453 [00:07<00:10, 9891.20it/s] 40%|████      | 71440/176453 [00:07<00:10, 9896.15it/s] 42%|████▏     | 73337/176453 [00:07<00:10, 9839.86it/s] 43%|████▎     | 75294/176453 [00:07<00:10, 9873.75it/s] 44%|████▍     | 77294/176453 [00:07<00:09, 9960.96it/s] 45%|████▍     | 79226/176453 [00:08<00:09, 9934.39it/s] 46%|████▌     | 81242/176453 [00:08<00:09, 10001.81it/s] 47%|████▋     | 83156/176453 [00:08<00:09, 9947.09it/s]  48%|████▊     | 85022/176453 [00:08<00:09, 9862.53it/s] 49%|████▉     | 86980/176453 [00:08<00:09, 9896.46it/s] 50%|█████     | 88888/176453 [00:09<00:08, 9872.40it/s] 51%|█████▏    | 90766/176453 [00:09<00:08, 9825.88it/s] 53%|█████▎    | 92645/176453 [00:09<00:08, 9791.65it/s] 54%|█████▎    | 94544/176453 [00:09<00:08, 9790.43it/s] 55%|█████▍    | 96468/176453 [00:09<00:08, 9820.59it/s] 56%|█████▌    | 98339/176453 [00:10<00:07, 9782.73it/s] 57%|█████▋    | 100281/176453 [00:10<00:07, 9829.02it/s] 58%|█████▊    | 102238/176453 [00:10<00:07, 9868.24it/s] 59%|█████▉    | 104186/176453 [00:10<00:07, 9896.72it/s] 60%|██████    | 106113/176453 [00:10<00:07, 9905.32it/s] 61%|██████    | 108015/176453 [00:10<00:06, 9884.50it/s] 62%|██████▏   | 109933/176453 [00:11<00:06, 9874.64it/s] 63%|██████▎   | 111902/176453 [00:11<00:06, 9925.37it/s] 65%|██████▍   | 113841/176453 [00:11<00:06, 9931.10it/s] 66%|██████▌   | 115734/176453 [00:11<00:06, 9890.43it/s] 67%|██████▋   | 117638/176453 [00:11<00:05, 9877.98it/s] 68%|██████▊   | 119593/176453 [00:12<00:05, 9912.02it/s] 69%|██████▉   | 121501/176453 [00:12<00:05, 9881.68it/s] 70%|██████▉   | 123406/176453 [00:12<00:05, 9855.44it/s] 71%|███████   | 125335/176453 [00:12<00:05, 9873.33it/s] 72%|███████▏  | 127243/176453 [00:12<00:04, 9868.19it/s] 73%|███████▎  | 129217/176453 [00:13<00:04, 9941.15it/s] 74%|███████▍  | 131158/176453 [00:13<00:04, 9947.49it/s] 75%|███████▌  | 133072/176453 [00:13<00:04, 9919.71it/s] 76%|███████▋  | 134967/176453 [00:13<00:04, 9884.32it/s] 78%|███████▊  | 136954/176453 [00:13<00:03, 9954.46it/s] 79%|███████▊  | 138879/176453 [00:14<00:03, 9545.31it/s] 80%|███████▉  | 140813/176453 [00:14<00:04, 8238.17it/s] 81%|████████  | 142698/176453 [00:14<00:03, 8634.48it/s] 82%|████████▏ | 144644/176453 [00:14<00:03, 8999.27it/s] 83%|████████▎ | 146601/176453 [00:15<00:03, 9270.73it/s] 84%|████████▍ | 148523/176453 [00:15<00:02, 9439.93it/s] 85%|████████▌ | 150398/176453 [00:15<00:02, 9522.16it/s] 86%|████████▋ | 152323/176453 [00:15<00:02, 8921.83it/s] 87%|████████▋ | 154204/176453 [00:15<00:02, 8348.77it/s] 88%|████████▊ | 156107/176453 [00:16<00:02, 8013.52it/s] 90%|████████▉ | 158055/176453 [00:16<00:02, 7936.77it/s] 91%|█████████ | 159930/176453 [00:16<00:02, 7710.47it/s] 92%|█████████▏| 161909/176453 [00:17<00:02, 7255.67it/s] 93%|█████████▎| 163891/176453 [00:17<00:01, 6416.00it/s] 94%|█████████▍| 165790/176453 [00:17<00:01, 5917.07it/s] 95%|█████████▌| 167733/176453 [00:18<00:01, 5554.95it/s] 96%|█████████▌| 169696/176453 [00:18<00:01, 5428.40it/s] 97%|█████████▋| 171633/176453 [00:18<00:00, 5322.61it/s] 98%|█████████▊| 173594/176453 [00:19<00:00, 5191.26it/s] 99%|█████████▉| 175565/176453 [00:19<00:00, 5188.65it/s]100%|██████████| 176453/176453 [00:19<00:00, 8931.86it/s]
Successfully wrote MDS dataset to ./shards/mds
Conversion completed in 29.32 seconds
Converting ./data/benchmark_shard.parquet to MDS format in ./shards/mds
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/mosaicdataset_converter.py --data ./data/benchmark_shard.parquet --out_dir ./shards/mds
MDS conversion completed in 33.37 seconds


=========================================
   LITDATA BENCHMARK
   Tue Apr 15 05:34:49 UTC 2025
=========================================

Seed set to 42
Reading parquet file: ./data/benchmark_shard.parquet
Loaded 176453 samples from parquet file
Preparing data samples...
  0%|          | 0/176453 [00:00<?, ?it/s]  2%|▏         | 2849/176453 [00:00<00:06, 28481.47it/s]  3%|▎         | 5698/176453 [00:00<00:06, 28325.44it/s]  5%|▍         | 8625/176453 [00:00<00:05, 28753.03it/s]  7%|▋         | 11549/176453 [00:00<00:05, 28943.83it/s]  8%|▊         | 14477/176453 [00:00<00:05, 29062.56it/s] 10%|▉         | 17411/176453 [00:00<00:05, 29154.57it/s] 12%|█▏        | 20337/176453 [00:00<00:05, 29185.66it/s] 13%|█▎        | 23265/176453 [00:00<00:05, 29215.07it/s] 15%|█▍        | 26190/176453 [00:00<00:05, 29224.32it/s] 16%|█▋        | 29113/176453 [00:01<00:05, 29224.21it/s] 18%|█▊        | 32036/176453 [00:01<00:04, 29224.71it/s] 20%|█▉        | 34959/176453 [00:01<00:04, 29220.69it/s] 21%|██▏       | 37882/176453 [00:01<00:04, 29201.95it/s] 23%|██▎       | 40803/176453 [00:01<00:04, 29199.89it/s] 25%|██▍       | 43724/176453 [00:01<00:04, 29202.80it/s] 26%|██▋       | 46648/176453 [00:01<00:04, 29211.42it/s] 28%|██▊       | 49575/176453 [00:01<00:04, 29227.24it/s] 30%|██▉       | 52498/176453 [00:01<00:04, 29219.98it/s] 31%|███▏      | 55422/176453 [00:01<00:04, 29224.93it/s] 33%|███▎      | 58345/176453 [00:02<00:04, 29226.25it/s] 35%|███▍      | 61268/176453 [00:02<00:03, 29225.84it/s] 36%|███▋      | 64195/176453 [00:02<00:03, 29236.59it/s] 38%|███▊      | 67119/176453 [00:02<00:03, 29237.05it/s] 40%|███▉      | 70043/176453 [00:02<00:03, 29211.26it/s] 41%|████▏     | 72965/176453 [00:02<00:03, 29209.53it/s] 43%|████▎     | 75887/176453 [00:02<00:03, 29209.96it/s] 45%|████▍     | 78815/176453 [00:02<00:03, 29229.36it/s] 46%|████▋     | 81741/176453 [00:02<00:03, 29236.20it/s] 48%|████▊     | 84671/176453 [00:02<00:03, 29252.39it/s] 50%|████▉     | 87597/176453 [00:03<00:03, 29252.17it/s] 51%|█████▏    | 90523/176453 [00:03<00:02, 29225.48it/s] 53%|█████▎    | 93446/176453 [00:03<00:02, 29213.56it/s] 55%|█████▍    | 96368/176453 [00:03<00:02, 29205.13it/s] 56%|█████▋    | 99293/176453 [00:03<00:02, 29218.38it/s] 58%|█████▊    | 102215/176453 [00:03<00:02, 29202.92it/s] 60%|█████▉    | 105136/176453 [00:03<00:02, 29187.01it/s] 61%|██████    | 108055/176453 [00:03<00:02, 29172.28it/s] 63%|██████▎   | 110977/176453 [00:03<00:02, 29183.92it/s] 65%|██████▍   | 113901/176453 [00:03<00:02, 29197.96it/s] 66%|██████▌   | 116824/176453 [00:04<00:02, 29205.59it/s] 68%|██████▊   | 119750/176453 [00:04<00:01, 29219.53it/s] 70%|██████▉   | 122680/176453 [00:04<00:01, 29242.59it/s] 71%|███████   | 125605/176453 [00:04<00:02, 19965.81it/s] 73%|███████▎  | 128530/176453 [00:04<00:02, 22065.13it/s] 75%|███████▍  | 131459/176453 [00:04<00:01, 23829.35it/s] 76%|███████▌  | 134391/176453 [00:04<00:01, 25249.31it/s] 78%|███████▊  | 137321/176453 [00:04<00:01, 26341.38it/s] 79%|███████▉  | 140251/176453 [00:04<00:01, 27161.90it/s] 81%|████████  | 143192/176453 [00:05<00:01, 27798.34it/s] 83%|████████▎ | 146124/176453 [00:05<00:01, 28237.25it/s] 84%|████████▍ | 149012/176453 [00:05<00:00, 28352.39it/s] 86%|████████▌ | 151893/176453 [00:05<00:00, 28247.00it/s] 88%|████████▊ | 154750/176453 [00:05<00:00, 28275.57it/s] 89%|████████▉ | 157600/176453 [00:05<00:00, 28251.17it/s] 91%|█████████ | 160509/176453 [00:05<00:00, 28496.90it/s] 93%|█████████▎| 163397/176453 [00:05<00:00, 28607.95it/s] 94%|█████████▍| 166286/176453 [00:05<00:00, 28689.95it/s] 96%|█████████▌| 169182/176453 [00:05<00:00, 28769.91it/s] 98%|█████████▊| 172067/176453 [00:06<00:00, 28793.09it/s] 99%|█████████▉| 174990/176453 [00:06<00:00, 28921.16it/s]100%|██████████| 176453/176453 [00:06<00:00, 28392.78it/s]
<sys>:0: UserWarning: A newer version of litdata is available (0.2.45). Please consider upgrading with `pip install -U litdata`. Not all functionalities of the platform can be guaranteed to work with the current version.
Converting 176453 samples to LitData format...
Create an account on https://lightning.ai/ to optimize your data faster using multiple nodes and large machines.
Setting multiprocessing start_method to spawn. 
Storing the files under /home/ec2-user/benchmark-dataloader/shards/litdata
Setup started with fast_dev_run=False.
Setup finished in 0.003 seconds. Found 176453 items to process.
Starting 16 workers with 176453 items. The progress bar is only updated when a worker finishes.
Rank 0 inferred the following `['str', 'bytes', 'str']` data format.
Worker 0 is terminating.
Worker 0 is done.
Rank 1 inferred the following `['str', 'bytes', 'str']` data format.
Worker 1 is terminating.
Worker 1 is done.
Rank 2 inferred the following `['str', 'bytes', 'str']` data format.
Worker 2 is terminating.
Worker 2 is done.
Rank 3 inferred the following `['str', 'bytes', 'str']` data format.
Worker 3 is terminating.
Worker 3 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 4 inferred the following `['str', 'bytes', 'str']` data format.
Worker 4 is terminating.
Worker 4 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 5 inferred the following `['str', 'bytes', 'str']` data format.
Worker 5 is terminating.
Worker 5 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 6 inferred the following `['str', 'bytes', 'str']` data format.
Worker 6 is terminating.
Worker 6 is done.
Rank 7 inferred the following `['str', 'bytes', 'str']` data format.
Worker 7 is terminating.
Worker 7 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 8 inferred the following `['str', 'bytes', 'str']` data format.
Worker 8 is terminating.
Worker 8 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 9 inferred the following `['str', 'bytes', 'str']` data format.
Worker 9 is terminating.
Worker 9 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 10 inferred the following `['str', 'bytes', 'str']` data format.
Worker 10 is terminating.
Worker 10 is done.
Rank 11 inferred the following `['str', 'bytes', 'str']` data format.
Worker 11 is terminating.
Worker 11 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 12 inferred the following `['str', 'bytes', 'str']` data format.
Worker 12 is terminating.
Worker 12 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 13 inferred the following `['str', 'bytes', 'str']` data format.
Worker 13 is terminating.
Worker 13 is done.
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Workers are ready ! Starting data processing...

Progress:   0%|          | 0/176453 [00:00<?, ?it/s][ARank 14 inferred the following `['str', 'bytes', 'str']` data format.
Worker 14 is terminating.
Worker 14 is done.

Progress:  95%|█████████▍| 167175/176453 [00:01<00:00, 98762.63it/s][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Rank 15 inferred the following `['str', 'bytes', 'str']` data format.
Worker 15 is terminating.
Worker 15 is done.

Progress: 100%|██████████| 176453/176453 [00:15<00:00, 11506.52it/s][AProgress: 100%|██████████| 176453/176453 [00:16<00:00, 10780.60it/s]
Workers are finished.
Finished data processing!

LitData statistics:
  Output directory: ./shards/litdata
  Number of samples: 176453
  Number of files created: 97

Timing Summary:
  Dataset write time: 243.87 seconds
  Total script time: 259.49 seconds
Converting ./data/benchmark_shard.parquet to LitData format in ./shards/litdata
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/litdata_converter.py --data ./data/benchmark_shard.parquet --out_dir ./shards/litdata --prefix benchmark

Timing Summary:
  Dataset write time: 268.68 seconds
  Total script time: 268.68 seconds


=========================================
   BENCHMARK SUMMARY
   Tue Apr 15 05:39:18 UTC 2025
=========================================

BENCHMARK SUMMARY
Date: Tue Apr 15 05:39:18 UTC 2025
CPU Count: 16

| Format | Total Time (s) | Dataset Write (s) | Size (GB) | # Files |
| --- | --- | --- | --- | --- |
| LitData (PL) | 269.00 | 243.87 | 5.54 | 97 |
| WebDataset (WDS) | 95.00 | 39.07 | 6.32 | 46 |
| MosaicML Dataset (MDS) | 39.00 | 29.32 | 5.71 | 93 |

Total benchmark time: 403.00 seconds

Benchmark complete! Summary saved to results/summary_20250415_053235.txt
Full logs available at results/benchmark_run_20250415_053235.log
