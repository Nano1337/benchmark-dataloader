DATASET STREAMING BENCHMARKS
Started at: 2025-04-25 05:22:48
Configuration: batch_size=256, num_workers=4, prefetch_factor=4



========== WebDataset ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/.venv/lib/python3.13/site-packages/webdataset/compat.py:389: UserWarning: WebDataset(shardshuffle=...) is None; set explicitly to False or a number
  warnings.warn(
Seed set to 42
Using remote path: s3://datology-assets-dev/users/haoli/shards/webdataset
Using remote path: s3://datology-assets-dev/users/haoli/shards/webdataset
Listing objects...
Found 23 objects in S3
Found 23 train tar files matching pattern 'benchmark-train-'
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2: 0it [00:00, ?it/s]
Epoch 1/2: 1it [00:02,  2.74s/it]
Epoch 1/2: 9it [00:04,  2.20it/s]
Epoch 1/2: 17it [00:05,  3.12it/s]
Epoch 1/2: 25it [00:06,  3.68it/s]
Epoch 1/2: 33it [00:08,  4.07it/s]
Epoch 1/2: 41it [00:09,  4.34it/s]
Epoch 1/2: 49it [00:10,  4.54it/s]
Epoch 1/2: 57it [00:13,  4.14it/s]
Epoch 1/2: 65it [00:15,  4.30it/s]
Epoch 1/2: 73it [00:16,  4.43it/s]
Epoch 1/2: 81it [00:17,  4.55it/s]
Epoch 1/2: 89it [00:19,  4.65it/s]
Epoch 1/2: 97it [00:20,  4.73it/s]
Epoch 1/2: 105it [00:21,  4.80it/s]
Epoch 1/2: 113it [00:23,  4.87it/s]
Epoch 1/2: 121it [00:26,  4.60it/s]
Epoch 1/2: 129it [00:27,  4.67it/s]
Epoch 1/2: 137it [00:28,  4.73it/s]
Epoch 1/2: 145it [00:30,  4.79it/s]
Epoch 1/2: 153it [00:31,  4.85it/s]
Epoch 1/2: 161it [00:32,  4.89it/s]
Epoch 1/2: 169it [00:34,  4.94it/s]
Epoch 1/2: 177it [00:37,  4.75it/s]
Epoch 1/2: 185it [00:38,  4.79it/s]
Epoch 1/2: 193it [00:39,  4.83it/s]
Epoch 1/2: 201it [00:41,  4.87it/s]
Epoch 1/2: 209it [00:42,  4.91it/s]
Epoch 1/2: 217it [00:43,  4.94it/s]
Epoch 1/2: 225it [00:45,  4.97it/s]
Epoch 1/2: 233it [00:46,  5.00it/s]
Epoch 1/2: 241it [00:49,  4.83it/s]
Epoch 1/2: 249it [00:51,  4.87it/s]
Epoch 1/2: 257it [00:52,  4.89it/s]
Epoch 1/2: 265it [00:53,  4.92it/s]
Epoch 1/2: 273it [00:55,  4.95it/s]
Epoch 1/2: 281it [00:56,  4.97it/s]
Epoch 1/2: 289it [00:57,  4.99it/s]
Epoch 1/2: 297it [01:00,  4.87it/s]
Epoch 1/2: 305it [01:02,  4.90it/s]
Epoch 1/2: 313it [01:03,  4.92it/s]
Epoch 1/2: 321it [01:05,  4.89it/s]
Epoch 1/2: 329it [01:07,  4.87it/s]
Epoch 1/2: 337it [01:08,  4.89it/s]
Epoch 1/2: 345it [01:10,  4.86it/s]
Epoch 1/2: 348it [01:11,  4.90it/s]
Time to first batch: 2.7372s
Epoch 1: Processed 88514 samples in 71.03s (1246.11 images/sec)

Epoch 2/2: 0it [00:00, ?it/s]
Epoch 2/2: 5it [00:01,  3.36it/s]
Epoch 2/2: 13it [00:02,  4.59it/s]
Epoch 2/2: 21it [00:04,  5.02it/s]
Epoch 2/2: 29it [00:05,  5.24it/s]
Epoch 2/2: 37it [00:06,  5.40it/s]
Epoch 2/2: 45it [00:08,  5.48it/s]
Epoch 2/2: 53it [00:09,  5.55it/s]
Epoch 2/2: 61it [00:10,  5.60it/s]
Epoch 2/2: 69it [00:12,  5.64it/s]
Epoch 2/2: 77it [00:13,  5.67it/s]
Epoch 2/2: 85it [00:14,  5.70it/s]
Epoch 2/2: 93it [00:16,  5.73it/s]
Epoch 2/2: 101it [00:17,  5.75it/s]
Epoch 2/2: 109it [00:18,  5.77it/s]
Epoch 2/2: 117it [00:20,  5.78it/s]
Epoch 2/2: 125it [00:21,  5.79it/s]
Epoch 2/2: 133it [00:22,  5.81it/s]
Epoch 2/2: 141it [00:24,  5.82it/s]
Epoch 2/2: 149it [00:25,  5.83it/s]
Epoch 2/2: 157it [00:26,  5.84it/s]
Epoch 2/2: 165it [00:28,  5.85it/s]
Epoch 2/2: 173it [00:29,  5.85it/s]
Epoch 2/2: 181it [00:30,  5.86it/s]
Epoch 2/2: 189it [00:32,  5.87it/s]
Epoch 2/2: 197it [00:33,  5.87it/s]
Epoch 2/2: 205it [00:34,  5.88it/s]
Epoch 2/2: 213it [00:36,  5.89it/s]
Epoch 2/2: 221it [00:37,  5.88it/s]
Epoch 2/2: 229it [00:38,  5.88it/s]
Epoch 2/2: 237it [00:40,  5.89it/s]
Epoch 2/2: 245it [00:41,  5.89it/s]
Epoch 2/2: 253it [00:42,  5.90it/s]
Epoch 2/2: 261it [00:44,  5.90it/s]
Epoch 2/2: 269it [00:45,  5.90it/s]
Epoch 2/2: 277it [00:46,  5.91it/s]
Epoch 2/2: 285it [00:48,  5.91it/s]
Epoch 2/2: 293it [00:49,  5.91it/s]
Epoch 2/2: 301it [00:50,  5.91it/s]
Epoch 2/2: 309it [00:52,  5.90it/s]
Epoch 2/2: 317it [00:54,  5.85it/s]
Epoch 2/2: 325it [00:55,  5.83it/s]
Epoch 2/2: 333it [00:57,  5.78it/s]
Epoch 2/2: 341it [00:59,  5.73it/s]
Epoch 2/2: 348it [01:00,  5.72it/s]
Epoch 2: Processed 88514 samples in 60.88s (1453.99 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 131.91s
  Throughput: 1453.99 images/sec
  Time to first batch: 2.7372s
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark


========== MosaicML MDS ==========
Seed set to 42
Seed set to 42
Using remote path: s3://datology-assets-dev/users/haoli/shards/mds
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   0%|          | 1/346 [00:26<2:35:13, 27.00s/it]
Epoch 1/2:   3%|▎         | 9/346 [00:28<17:40,  3.15s/it]  
Epoch 1/2:   5%|▍         | 17/346 [00:29<09:32,  1.74s/it]
Epoch 1/2:   7%|▋         | 25/346 [00:30<06:36,  1.24s/it]
Epoch 1/2:  10%|▉         | 33/346 [00:32<05:05,  1.03it/s]
Epoch 1/2:  12%|█▏        | 41/346 [00:33<04:09,  1.22it/s]
Epoch 1/2:  14%|█▍        | 49/346 [00:34<03:30,  1.41it/s]
Epoch 1/2:  16%|█▋        | 57/346 [00:36<03:02,  1.58it/s]
Epoch 1/2:  19%|█▉        | 65/346 [00:37<02:41,  1.74it/s]
Epoch 1/2:  21%|██        | 73/346 [00:38<02:24,  1.89it/s]
Epoch 1/2:  23%|██▎       | 81/346 [00:40<02:10,  2.02it/s]
Epoch 1/2:  26%|██▌       | 89/346 [00:41<01:59,  2.15it/s]
Epoch 1/2:  28%|██▊       | 97/346 [00:42<01:49,  2.28it/s]
Epoch 1/2:  30%|███       | 105/346 [00:43<01:40,  2.39it/s]
Epoch 1/2:  33%|███▎      | 113/346 [00:45<01:33,  2.50it/s]
Epoch 1/2:  35%|███▍      | 121/346 [00:46<01:26,  2.60it/s]
Epoch 1/2:  37%|███▋      | 129/346 [00:47<01:20,  2.69it/s]
Epoch 1/2:  40%|███▉      | 137/346 [00:49<01:15,  2.78it/s]
Epoch 1/2:  42%|████▏     | 145/346 [00:50<01:10,  2.87it/s]
Epoch 1/2:  44%|████▍     | 153/346 [00:51<01:05,  2.95it/s]
Epoch 1/2:  47%|████▋     | 161/346 [00:53<01:01,  3.03it/s]
Epoch 1/2:  49%|████▉     | 169/346 [00:54<00:57,  3.10it/s]
Epoch 1/2:  51%|█████     | 177/346 [00:55<00:53,  3.17it/s]
Epoch 1/2:  53%|█████▎    | 185/346 [00:57<00:49,  3.24it/s]
Epoch 1/2:  56%|█████▌    | 193/346 [00:58<00:46,  3.30it/s]
Epoch 1/2:  58%|█████▊    | 201/346 [00:59<00:43,  3.37it/s]
Epoch 1/2:  60%|██████    | 209/346 [01:01<00:40,  3.42it/s]
Epoch 1/2:  63%|██████▎   | 217/346 [01:02<00:37,  3.48it/s]
Epoch 1/2:  65%|██████▌   | 225/346 [01:03<00:34,  3.53it/s]
Epoch 1/2:  67%|██████▋   | 233/346 [01:04<00:31,  3.58it/s]
Epoch 1/2:  70%|██████▉   | 241/346 [01:06<00:28,  3.63it/s]
Epoch 1/2:  72%|███████▏  | 249/346 [01:07<00:26,  3.68it/s]
Epoch 1/2:  74%|███████▍  | 257/346 [01:08<00:23,  3.73it/s]
Epoch 1/2:  77%|███████▋  | 265/346 [01:10<00:21,  3.77it/s]
Epoch 1/2:  79%|███████▉  | 273/346 [01:11<00:19,  3.81it/s]
Epoch 1/2:  81%|████████  | 281/346 [01:12<00:16,  3.85it/s]
Epoch 1/2:  84%|████████▎ | 289/346 [01:14<00:14,  3.89it/s]
Epoch 1/2:  86%|████████▌ | 297/346 [01:15<00:12,  3.93it/s]
Epoch 1/2:  88%|████████▊ | 305/346 [01:16<00:10,  3.97it/s]
Epoch 1/2:  90%|█████████ | 313/346 [01:18<00:08,  4.00it/s]
Epoch 1/2:  93%|█████████▎| 321/346 [01:19<00:06,  4.04it/s]
Epoch 1/2:  95%|█████████▌| 329/346 [01:20<00:04,  4.08it/s]
Epoch 1/2:  97%|█████████▋| 337/346 [01:21<00:02,  4.11it/s]
Epoch 1/2: 100%|█████████▉| 345/346 [01:23<00:00,  4.15it/s]
Epoch 1/2: 100%|██████████| 346/346 [01:23<00:00,  4.16it/s]
Time to first batch: 26.9966s
Epoch 1: Processed 88514 samples in 83.23s (1063.47 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   1%|▏         | 5/346 [00:01<01:44,  3.26it/s]
Epoch 2/2:   4%|▍         | 13/346 [00:02<01:14,  4.48it/s]
Epoch 2/2:   6%|▌         | 21/346 [00:04<01:05,  4.97it/s]
Epoch 2/2:   8%|▊         | 29/346 [00:05<01:00,  5.26it/s]
Epoch 2/2:  11%|█         | 37/346 [00:06<00:56,  5.43it/s]
Epoch 2/2:  13%|█▎        | 45/346 [00:08<00:54,  5.54it/s]
Epoch 2/2:  15%|█▌        | 53/346 [00:09<00:52,  5.60it/s]
Epoch 2/2:  18%|█▊        | 61/346 [00:10<00:50,  5.65it/s]
Epoch 2/2:  20%|█▉        | 69/346 [00:12<00:48,  5.71it/s]
Epoch 2/2:  22%|██▏       | 77/346 [00:13<00:46,  5.74it/s]
Epoch 2/2:  25%|██▍       | 85/346 [00:14<00:45,  5.78it/s]
Epoch 2/2:  27%|██▋       | 93/346 [00:16<00:43,  5.80it/s]
Epoch 2/2:  29%|██▉       | 101/346 [00:17<00:42,  5.81it/s]
Epoch 2/2:  32%|███▏      | 109/346 [00:18<00:40,  5.84it/s]
Epoch 2/2:  34%|███▍      | 117/346 [00:19<00:39,  5.86it/s]
Epoch 2/2:  36%|███▌      | 125/346 [00:21<00:37,  5.86it/s]
Epoch 2/2:  38%|███▊      | 133/346 [00:22<00:36,  5.87it/s]
Epoch 2/2:  41%|████      | 141/346 [00:23<00:34,  5.88it/s]
Epoch 2/2:  43%|████▎     | 149/346 [00:25<00:33,  5.89it/s]
Epoch 2/2:  45%|████▌     | 157/346 [00:26<00:32,  5.91it/s]
Epoch 2/2:  48%|████▊     | 165/346 [00:27<00:30,  5.91it/s]
Epoch 2/2:  50%|█████     | 173/346 [00:29<00:29,  5.92it/s]
Epoch 2/2:  52%|█████▏    | 181/346 [00:30<00:27,  5.92it/s]
Epoch 2/2:  55%|█████▍    | 189/346 [00:31<00:26,  5.93it/s]
Epoch 2/2:  57%|█████▋    | 197/346 [00:33<00:25,  5.95it/s]
Epoch 2/2:  59%|█████▉    | 205/346 [00:34<00:23,  5.95it/s]
Epoch 2/2:  62%|██████▏   | 213/346 [00:35<00:22,  5.96it/s]
Epoch 2/2:  64%|██████▍   | 221/346 [00:36<00:20,  5.97it/s]
Epoch 2/2:  66%|██████▌   | 229/346 [00:38<00:19,  5.98it/s]
Epoch 2/2:  68%|██████▊   | 237/346 [00:39<00:18,  5.99it/s]
Epoch 2/2:  71%|███████   | 245/346 [00:40<00:16,  6.00it/s]
Epoch 2/2:  73%|███████▎  | 253/346 [00:42<00:15,  6.00it/s]
Epoch 2/2:  75%|███████▌  | 261/346 [00:43<00:14,  6.01it/s]
Epoch 2/2:  78%|███████▊  | 269/346 [00:44<00:12,  6.01it/s]
Epoch 2/2:  80%|████████  | 277/346 [00:46<00:11,  6.01it/s]
Epoch 2/2:  82%|████████▏ | 285/346 [00:47<00:10,  6.02it/s]
Epoch 2/2:  85%|████████▍ | 293/346 [00:48<00:08,  6.02it/s]
Epoch 2/2:  87%|████████▋ | 301/346 [00:49<00:07,  6.03it/s]
Epoch 2/2:  89%|████████▉ | 309/346 [00:51<00:06,  6.03it/s]
Epoch 2/2:  92%|█████████▏| 317/346 [00:52<00:04,  6.04it/s]
Epoch 2/2:  94%|█████████▍| 325/346 [00:53<00:03,  6.04it/s]
Epoch 2/2:  96%|█████████▌| 333/346 [00:55<00:02,  6.05it/s]
Epoch 2/2:  99%|█████████▊| 341/346 [00:56<00:00,  6.06it/s]
Epoch 2/2: 100%|██████████| 346/346 [00:57<00:00,  6.06it/s]
Epoch 2: Processed 88514 samples in 57.09s (1550.52 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 140.32s
  Throughput: 1550.52 images/sec
  Time to first batch: 26.9966s
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark


========== LitData ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/stream/lightning_data.py:77: A newer version of litdata is available (0.2.45). Please consider upgrading with `pip install -U litdata`. Not all functionalities of the platform can be guaranteed to work with the current version.
Seed set to 42
Using S3 path from environment...
Using remote path: s3://datology-assets-dev/users/haoli/shards/litdata
Using remote path: s3://datology-assets-dev/users/haoli/shards/litdata
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   1%|▏         | 5/346 [00:01<01:31,  3.71it/s]
Epoch 1/2:   4%|▍         | 13/346 [00:02<01:06,  4.98it/s]
Epoch 1/2:   6%|▌         | 21/346 [00:03<00:59,  5.44it/s]
Epoch 1/2:   8%|▊         | 29/346 [00:05<00:56,  5.63it/s]
Epoch 1/2:  11%|█         | 37/346 [00:06<00:53,  5.75it/s]
Epoch 1/2:  13%|█▎        | 45/346 [00:07<00:51,  5.86it/s]
Epoch 1/2:  15%|█▌        | 53/346 [00:08<00:49,  5.93it/s]
Epoch 1/2:  18%|█▊        | 61/346 [00:10<00:47,  5.96it/s]
Epoch 1/2:  20%|█▉        | 69/346 [00:11<00:45,  6.03it/s]
Epoch 1/2:  22%|██▏       | 77/346 [00:12<00:44,  6.07it/s]
Epoch 1/2:  25%|██▍       | 85/346 [00:13<00:42,  6.10it/s]
Epoch 1/2:  27%|██▋       | 93/346 [00:15<00:41,  6.13it/s]
Epoch 1/2:  29%|██▉       | 101/346 [00:16<00:39,  6.15it/s]
Epoch 1/2:  32%|███▏      | 109/346 [00:17<00:38,  6.17it/s]
Epoch 1/2:  34%|███▍      | 117/346 [00:18<00:37,  6.18it/s]
Epoch 1/2:  36%|███▌      | 125/346 [00:20<00:35,  6.19it/s]
Epoch 1/2:  38%|███▊      | 133/346 [00:21<00:34,  6.20it/s]
Epoch 1/2:  41%|████      | 141/346 [00:22<00:33,  6.20it/s]
Epoch 1/2:  43%|████▎     | 149/346 [00:24<00:31,  6.21it/s]
Epoch 1/2:  45%|████▌     | 157/346 [00:25<00:30,  6.21it/s]
Epoch 1/2:  48%|████▊     | 165/346 [00:26<00:29,  6.22it/s]
Epoch 1/2:  50%|█████     | 173/346 [00:27<00:27,  6.23it/s]
Epoch 1/2:  52%|█████▏    | 181/346 [00:28<00:26,  6.25it/s]
Epoch 1/2:  55%|█████▍    | 189/346 [00:30<00:25,  6.26it/s]
Epoch 1/2:  57%|█████▋    | 197/346 [00:31<00:23,  6.26it/s]
Epoch 1/2:  59%|█████▉    | 205/346 [00:32<00:22,  6.27it/s]
Epoch 1/2:  62%|██████▏   | 213/346 [00:33<00:21,  6.28it/s]
Epoch 1/2:  64%|██████▍   | 221/346 [00:35<00:19,  6.29it/s]
Epoch 1/2:  66%|██████▌   | 229/346 [00:36<00:18,  6.29it/s]
Epoch 1/2:  68%|██████▊   | 237/346 [00:37<00:17,  6.29it/s]
Epoch 1/2:  71%|███████   | 245/346 [00:38<00:16,  6.30it/s]
Epoch 1/2:  73%|███████▎  | 253/346 [00:40<00:14,  6.30it/s]
Epoch 1/2:  75%|███████▌  | 261/346 [00:41<00:13,  6.31it/s]
Epoch 1/2:  78%|███████▊  | 269/346 [00:42<00:12,  6.31it/s]
Epoch 1/2:  80%|████████  | 277/346 [00:43<00:10,  6.32it/s]
Epoch 1/2:  82%|████████▏ | 285/346 [00:45<00:09,  6.32it/s]
Epoch 1/2:  85%|████████▍ | 293/346 [00:46<00:08,  6.33it/s]
Epoch 1/2:  87%|████████▋ | 301/346 [00:47<00:07,  6.33it/s]
Epoch 1/2:  89%|████████▉ | 309/346 [00:48<00:05,  6.34it/s]
Epoch 1/2:  92%|█████████▏| 317/346 [00:50<00:04,  6.34it/s]
Epoch 1/2:  94%|█████████▍| 325/346 [00:51<00:03,  6.34it/s]
Epoch 1/2:  96%|█████████▌| 333/346 [00:52<00:02,  6.34it/s]
Epoch 1/2:  99%|█████████▊| 341/346 [00:53<00:00,  6.35it/s]
Epoch 1/2: 100%|██████████| 346/346 [00:54<00:00,  6.34it/s]
Time to first batch: 0.7246s
Epoch 1: Processed 88514 samples in 54.60s (1621.00 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   1%|▏         | 5/346 [00:01<01:30,  3.77it/s]
Epoch 2/2:   4%|▍         | 13/346 [00:02<01:05,  5.06it/s]
Epoch 2/2:   6%|▌         | 21/346 [00:03<00:58,  5.52it/s]
Epoch 2/2:   8%|▊         | 29/346 [00:05<00:55,  5.69it/s]
Epoch 2/2:  11%|█         | 37/346 [00:06<00:53,  5.82it/s]
Epoch 2/2:  13%|█▎        | 45/346 [00:07<00:50,  5.92it/s]
Epoch 2/2:  15%|█▌        | 53/346 [00:08<00:48,  5.99it/s]
Epoch 2/2:  18%|█▊        | 61/346 [00:10<00:47,  6.02it/s]
Epoch 2/2:  20%|█▉        | 69/346 [00:11<00:45,  6.08it/s]
Epoch 2/2:  22%|██▏       | 77/346 [00:12<00:44,  6.11it/s]
Epoch 2/2:  25%|██▍       | 85/346 [00:13<00:42,  6.13it/s]
Epoch 2/2:  27%|██▋       | 93/346 [00:15<00:41,  6.15it/s]
Epoch 2/2:  29%|██▉       | 101/346 [00:16<00:39,  6.16it/s]
Epoch 2/2:  32%|███▏      | 109/346 [00:17<00:38,  6.19it/s]
Epoch 2/2:  34%|███▍      | 117/346 [00:18<00:36,  6.21it/s]
Epoch 2/2:  36%|███▌      | 125/346 [00:20<00:35,  6.22it/s]
Epoch 2/2:  38%|███▊      | 133/346 [00:21<00:34,  6.24it/s]
Epoch 2/2:  41%|████      | 141/346 [00:22<00:32,  6.25it/s]
Epoch 2/2:  43%|████▎     | 149/346 [00:23<00:31,  6.26it/s]
Epoch 2/2:  45%|████▌     | 157/346 [00:25<00:30,  6.27it/s]
Epoch 2/2:  48%|████▊     | 165/346 [00:26<00:28,  6.27it/s]
Epoch 2/2:  50%|█████     | 173/346 [00:27<00:27,  6.28it/s]
Epoch 2/2:  52%|█████▏    | 181/346 [00:28<00:26,  6.29it/s]
Epoch 2/2:  55%|█████▍    | 189/346 [00:29<00:24,  6.30it/s]
Epoch 2/2:  57%|█████▋    | 197/346 [00:31<00:23,  6.30it/s]
Epoch 2/2:  59%|█████▉    | 205/346 [00:32<00:22,  6.31it/s]
Epoch 2/2:  62%|██████▏   | 213/346 [00:33<00:21,  6.32it/s]
Epoch 2/2:  64%|██████▍   | 221/346 [00:34<00:19,  6.33it/s]
Epoch 2/2:  66%|██████▌   | 229/346 [00:36<00:18,  6.33it/s]
Epoch 2/2:  68%|██████▊   | 237/346 [00:37<00:17,  6.34it/s]
Epoch 2/2:  71%|███████   | 245/346 [00:38<00:15,  6.34it/s]
Epoch 2/2:  73%|███████▎  | 253/346 [00:39<00:14,  6.35it/s]
Epoch 2/2:  75%|███████▌  | 261/346 [00:41<00:13,  6.35it/s]
Epoch 2/2:  78%|███████▊  | 269/346 [00:42<00:12,  6.36it/s]
Epoch 2/2:  80%|████████  | 277/346 [00:43<00:10,  6.36it/s]
Epoch 2/2:  82%|████████▏ | 285/346 [00:44<00:09,  6.36it/s]
Epoch 2/2:  85%|████████▍ | 293/346 [00:46<00:08,  6.37it/s]
Epoch 2/2:  87%|████████▋ | 301/346 [00:47<00:07,  6.37it/s]
Epoch 2/2:  89%|████████▉ | 309/346 [00:48<00:05,  6.37it/s]
Epoch 2/2:  92%|█████████▏| 317/346 [00:49<00:04,  6.37it/s]
Epoch 2/2:  94%|█████████▍| 325/346 [00:51<00:03,  6.37it/s]
Epoch 2/2:  96%|█████████▌| 333/346 [00:52<00:02,  6.37it/s]
Epoch 2/2:  99%|█████████▊| 341/346 [00:53<00:00,  6.37it/s]
Epoch 2/2: 100%|██████████| 346/346 [00:54<00:00,  6.36it/s]
Epoch 2: Processed 88514 samples in 54.41s (1626.73 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 109.02s
  Throughput: 1626.73 images/sec
  Time to first batch: 0.7246s
Benchmark complete
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark


========== Energon ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/.venv/lib/python3.13/site-packages/megatron/energon/loader.py:89: FutureWarning: Passing a worker_config to get_loader() is deprecated and will have no effect.
  warn_deprecated(
Using MSC_CONFIG: /home/ec2-user/benchmark-dataloader/stream/.msc_config.yaml
Using remote path: s3://datology-assets-dev/users/haoli/shards/energon
rank=0, worker=0: sample_range=[0, 22129] in 221 slices, sum(count)=22129: indexes=[0, 100, 201 ...<216> 21930, 22029, 22129] slices=[benchmark-train-000000.tar[0(start), 100], benchmark-train-000000.tar[100, 201], benchmark-train-000000.tar[201, 301] ...<216> benchmark-train-000005.tar[2483, 2583], benchmark-train-000005.tar[2583, 2682], benchmark-train-000005.tar[2682, 2782]]
rank=0, worker=1: sample_range=[22129, 44257] in 221 slices, sum(count)=22128: indexes=[22129, 22228, 22328 ...<216> 44057, 44157, 44257] slices=[benchmark-train-000005.tar[2782, 2881], benchmark-train-000005.tar[2881, 2981], benchmark-train-000005.tar[2981, 3080] ...<216> benchmark-train-000011.tar[1493, 1592], benchmark-train-000011.tar[1592, 1692], benchmark-train-000011.tar[1692, 1792]]
rank=0, worker=2: sample_range=[44257, 66386] in 221 slices, sum(count)=22129: indexes=[44257, 44356, 44456 ...<216> 66180, 66283, 66386] slices=[benchmark-train-000011.tar[1792, 1891], benchmark-train-000011.tar[1891, 1991], benchmark-train-000011.tar[1991, 2091] ...<216> benchmark-train-000017.tar[410, 512], benchmark-train-000017.tar[512, 615], benchmark-train-000017.tar[615, 718]]
rank=0, worker=3: sample_range=[66386, 88514] in 221 slices, sum(count)=22128: indexes=[66386, 66487, 66588 ...<216> 88313, 88413, 88514] slices=[benchmark-train-000017.tar[718, 819], benchmark-train-000017.tar[819, 920], benchmark-train-000017.tar[920, 1021] ...<216> benchmark-train-000022.tar[3114, 3215], benchmark-train-000022.tar[3215, 3315], benchmark-train-000022.tar[3315, 3416(end)]]
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   0%|          | 1/346 [00:31<3:01:38, 31.59s/it]
Epoch 1/2:   2%|▏         | 8/346 [00:32<22:56,  4.07s/it]  
Epoch 1/2:   4%|▍         | 15/346 [00:34<12:41,  2.30s/it]
Epoch 1/2:   6%|▋         | 22/346 [00:37<09:10,  1.70s/it]
Epoch 1/2:   8%|▊         | 29/346 [00:40<07:19,  1.39s/it]
Epoch 1/2:  10%|█         | 36/346 [00:41<06:00,  1.16s/it]
Epoch 1/2:  12%|█▏        | 43/346 [00:44<05:12,  1.03s/it]
Epoch 1/2:  14%|█▍        | 50/346 [00:47<04:40,  1.06it/s]
Epoch 1/2:  16%|█▋        | 57/346 [00:49<04:08,  1.16it/s]
Epoch 1/2:  18%|█▊        | 64/346 [00:51<03:44,  1.25it/s]
Epoch 1/2:  21%|██        | 71/346 [00:53<03:28,  1.32it/s]
Epoch 1/2:  23%|██▎       | 78/346 [00:57<03:17,  1.36it/s]
Epoch 1/2:  25%|██▍       | 85/346 [00:58<02:59,  1.46it/s]
Epoch 1/2:  27%|██▋       | 92/346 [01:00<02:46,  1.53it/s]
Epoch 1/2:  29%|██▊       | 99/346 [01:03<02:37,  1.57it/s]
Epoch 1/2:  31%|███       | 106/346 [01:05<02:29,  1.61it/s]
Epoch 1/2:  33%|███▎      | 113/346 [01:06<02:17,  1.69it/s]
Epoch 1/2:  35%|███▍      | 120/346 [01:09<02:10,  1.73it/s]
Epoch 1/2:  37%|███▋      | 127/346 [01:12<02:05,  1.75it/s]
Epoch 1/2:  39%|███▊      | 134/346 [01:14<01:58,  1.79it/s]
Epoch 1/2:  41%|████      | 142/346 [01:17<01:51,  1.83it/s]
Epoch 1/2:  43%|████▎     | 150/346 [01:21<01:45,  1.85it/s]
Epoch 1/2:  46%|████▌     | 158/346 [01:23<01:39,  1.89it/s]
Epoch 1/2:  48%|████▊     | 166/346 [01:26<01:33,  1.92it/s]
Epoch 1/2:  50%|█████     | 174/346 [01:29<01:28,  1.95it/s]
Epoch 1/2:  53%|█████▎    | 182/346 [01:31<01:22,  1.98it/s]
Epoch 1/2:  55%|█████▍    | 190/346 [01:34<01:17,  2.02it/s]
Epoch 1/2:  57%|█████▋    | 198/346 [01:36<01:12,  2.04it/s]
Epoch 1/2:  60%|█████▉    | 206/346 [01:39<01:07,  2.07it/s]
Epoch 1/2:  62%|██████▏   | 214/346 [01:42<01:02,  2.10it/s]
Epoch 1/2:  64%|██████▍   | 222/346 [01:44<00:58,  2.11it/s]
Epoch 1/2:  66%|██████▋   | 230/346 [01:47<00:54,  2.14it/s]
Epoch 1/2:  69%|██████▉   | 238/346 [01:49<00:49,  2.16it/s]
Epoch 1/2:  71%|███████   | 246/346 [01:52<00:45,  2.18it/s]
Epoch 1/2:  73%|███████▎  | 254/346 [01:55<00:41,  2.21it/s]
Epoch 1/2:  76%|███████▌  | 262/346 [01:57<00:37,  2.22it/s]
Epoch 1/2:  78%|███████▊  | 270/346 [02:00<00:33,  2.24it/s]
Epoch 1/2:  80%|████████  | 278/346 [02:03<00:30,  2.25it/s]
Epoch 1/2:  83%|████████▎ | 286/346 [02:05<00:26,  2.27it/s]
Epoch 1/2:  85%|████████▍ | 294/346 [02:08<00:22,  2.29it/s]
Epoch 1/2:  87%|████████▋ | 302/346 [02:10<00:19,  2.31it/s]
Epoch 1/2:  90%|████████▉ | 310/346 [02:13<00:15,  2.33it/s]
Epoch 1/2:  92%|█████████▏| 318/346 [02:15<00:11,  2.34it/s]
Epoch 1/2:  94%|█████████▍| 326/346 [02:18<00:08,  2.36it/s]
Epoch 1/2:  97%|█████████▋| 334/346 [02:20<00:05,  2.38it/s]
Epoch 1/2:  99%|█████████▉| 342/346 [02:22<00:01,  2.41it/s]
Epoch 1/2: 100%|██████████| 346/346 [02:23<00:00,  2.41it/s]
Time to first batch: 31.5899s
Epoch 1: Processed 88576 samples in 143.80s (615.99 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   0%|          | 1/346 [00:01<07:07,  1.24s/it]
Epoch 2/2:   2%|▏         | 7/346 [00:02<02:25,  2.34it/s]
Epoch 2/2:   4%|▍         | 13/346 [00:04<01:46,  3.12it/s]
Epoch 2/2:   5%|▌         | 19/346 [00:05<01:42,  3.18it/s]
Epoch 2/2:   7%|▋         | 25/346 [00:09<01:59,  2.69it/s]
Epoch 2/2:   9%|▉         | 31/346 [00:11<01:55,  2.74it/s]
Epoch 2/2:  11%|█▏        | 39/346 [00:13<01:44,  2.95it/s]
Epoch 2/2:  14%|█▎        | 47/346 [00:15<01:39,  3.01it/s]
Epoch 2/2:  16%|█▌        | 55/346 [00:18<01:40,  2.90it/s]
Epoch 2/2:  18%|█▊        | 63/346 [00:20<01:34,  3.01it/s]
Epoch 2/2:  21%|██        | 71/346 [00:23<01:30,  3.04it/s]
Epoch 2/2:  23%|██▎       | 79/346 [00:26<01:29,  3.00it/s]
Epoch 2/2:  25%|██▌       | 87/346 [00:28<01:26,  3.01it/s]
Epoch 2/2:  27%|██▋       | 95/346 [00:31<01:23,  3.02it/s]
Epoch 2/2:  30%|██▉       | 103/346 [00:34<01:20,  3.01it/s]
Epoch 2/2:  32%|███▏      | 111/346 [00:36<01:17,  3.02it/s]
Epoch 2/2:  34%|███▍      | 119/346 [00:39<01:14,  3.04it/s]
Epoch 2/2:  37%|███▋      | 127/346 [00:42<01:12,  3.01it/s]
Epoch 2/2:  39%|███▉      | 135/346 [00:44<01:10,  3.01it/s]
Epoch 2/2:  41%|████▏     | 143/346 [00:47<01:06,  3.04it/s]
Epoch 2/2:  44%|████▎     | 151/346 [00:50<01:04,  3.01it/s]
Epoch 2/2:  46%|████▌     | 159/346 [00:53<01:02,  3.00it/s]
Epoch 2/2:  48%|████▊     | 167/346 [00:55<00:59,  3.02it/s]
Epoch 2/2:  51%|█████     | 175/346 [00:58<00:57,  2.99it/s]
Epoch 2/2:  53%|█████▎    | 183/346 [01:01<00:54,  2.99it/s]
Epoch 2/2:  55%|█████▌    | 191/346 [01:03<00:51,  3.00it/s]
Epoch 2/2:  58%|█████▊    | 199/346 [01:06<00:48,  3.00it/s]
Epoch 2/2:  60%|█████▉    | 207/346 [01:09<00:46,  3.00it/s]
Epoch 2/2:  62%|██████▏   | 215/346 [01:11<00:43,  3.02it/s]
Epoch 2/2:  64%|██████▍   | 223/346 [01:13<00:40,  3.03it/s]
Epoch 2/2:  67%|██████▋   | 231/346 [01:16<00:38,  3.02it/s]
Epoch 2/2:  69%|██████▉   | 239/346 [01:18<00:35,  3.03it/s]
Epoch 2/2:  71%|███████▏  | 247/346 [01:21<00:32,  3.02it/s]
Epoch 2/2:  74%|███████▎  | 255/346 [01:24<00:30,  3.02it/s]
Epoch 2/2:  76%|███████▌  | 263/346 [01:26<00:27,  3.03it/s]
Epoch 2/2:  78%|███████▊  | 271/346 [01:29<00:24,  3.02it/s]
Epoch 2/2:  81%|████████  | 279/346 [01:31<00:22,  3.03it/s]
Epoch 2/2:  83%|████████▎ | 287/346 [01:34<00:19,  3.04it/s]
Epoch 2/2:  85%|████████▌ | 295/346 [01:37<00:16,  3.03it/s]
Epoch 2/2:  88%|████████▊ | 303/346 [01:39<00:14,  3.04it/s]
Epoch 2/2:  90%|████████▉ | 311/346 [01:42<00:11,  3.03it/s]
Epoch 2/2:  92%|█████████▏| 319/346 [01:44<00:08,  3.04it/s]
Epoch 2/2:  95%|█████████▍| 327/346 [01:47<00:06,  3.04it/s]
Epoch 2/2:  97%|█████████▋| 335/346 [01:49<00:03,  3.06it/s]
Epoch 2/2:  99%|█████████▉| 343/346 [01:52<00:00,  3.06it/s]
Epoch 2/2: 100%|██████████| 346/346 [01:52<00:00,  3.06it/s]
Epoch 2: Processed 88576 samples in 113.00s (783.89 images/sec)

Benchmark Summary:
  Total samples: 177152
  Wall time: 256.79s
  Throughput: 783.89 images/sec
  Time to first batch: 31.5899s
Benchmark complete
