DATASET STREAMING BENCHMARKS
Started at: 2025-04-25 05:00:51
Configuration: batch_size=256, num_workers=4, prefetch_factor=1



========== WebDataset ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/.venv/lib/python3.13/site-packages/webdataset/compat.py:389: UserWarning: WebDataset(shardshuffle=...) is None; set explicitly to False or a number
  warnings.warn(
Seed set to 42
Using remote path: s3://datology-assets-dev/users/haoli/shards/webdataset
Using remote path: s3://datology-assets-dev/users/haoli/shards/webdataset
Listing objects...
Found 23 objects in S3
Found 23 train tar files matching pattern 'benchmark-train-'
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2: 0it [00:00, ?it/s]
Epoch 1/2: 1it [00:02,  2.23s/it]
Epoch 1/2: 9it [00:03,  2.47it/s]
Epoch 1/2: 17it [00:05,  3.34it/s]
Epoch 1/2: 25it [00:06,  3.83it/s]
Epoch 1/2: 33it [00:07,  4.17it/s]
Epoch 1/2: 41it [00:09,  4.38it/s]
Epoch 1/2: 49it [00:10,  4.55it/s]
Epoch 1/2: 57it [00:13,  4.17it/s]
Epoch 1/2: 65it [00:15,  4.29it/s]
Epoch 1/2: 73it [00:16,  4.40it/s]
Epoch 1/2: 81it [00:18,  4.50it/s]
Epoch 1/2: 89it [00:19,  4.58it/s]
Epoch 1/2: 97it [00:20,  4.65it/s]
Epoch 1/2: 105it [00:22,  4.71it/s]
Epoch 1/2: 113it [00:23,  4.76it/s]
Epoch 1/2: 121it [00:26,  4.49it/s]
Epoch 1/2: 129it [00:28,  4.54it/s]
Epoch 1/2: 137it [00:29,  4.59it/s]
Epoch 1/2: 145it [00:31,  4.64it/s]
Epoch 1/2: 153it [00:32,  4.68it/s]
Epoch 1/2: 161it [00:34,  4.71it/s]
Epoch 1/2: 169it [00:35,  4.74it/s]
Epoch 1/2: 177it [00:38,  4.61it/s]
Epoch 1/2: 185it [00:41,  4.50it/s]
Epoch 1/2: 193it [00:42,  4.54it/s]
Epoch 1/2: 201it [00:44,  4.57it/s]
Epoch 1/2: 209it [00:45,  4.60it/s]
Epoch 1/2: 217it [00:46,  4.63it/s]
Epoch 1/2: 225it [00:48,  4.66it/s]
Epoch 1/2: 233it [00:49,  4.68it/s]
Epoch 1/2: 241it [00:52,  4.58it/s]
Epoch 1/2: 249it [00:54,  4.53it/s]
Epoch 1/2: 257it [00:56,  4.56it/s]
Epoch 1/2: 265it [00:57,  4.58it/s]
Epoch 1/2: 273it [00:59,  4.60it/s]
Epoch 1/2: 281it [01:00,  4.62it/s]
Epoch 1/2: 289it [01:02,  4.64it/s]
Epoch 1/2: 297it [01:05,  4.57it/s]
Epoch 1/2: 305it [01:07,  4.53it/s]
Epoch 1/2: 313it [01:09,  4.51it/s]
Epoch 1/2: 321it [01:11,  4.50it/s]
Epoch 1/2: 329it [01:12,  4.52it/s]
Epoch 1/2: 337it [01:14,  4.50it/s]
Epoch 1/2: 345it [01:16,  4.49it/s]
Epoch 1/2: 348it [01:17,  4.50it/s]
Time to first batch: 2.2307s
Epoch 1: Processed 88514 samples in 77.33s (1144.62 images/sec)

Epoch 2/2: 0it [00:00, ?it/s]
Epoch 2/2: 5it [00:01,  3.24it/s]
Epoch 2/2: 13it [00:02,  4.36it/s]
Epoch 2/2: 21it [00:04,  4.75it/s]
Epoch 2/2: 29it [00:05,  4.93it/s]
Epoch 2/2: 37it [00:07,  5.05it/s]
Epoch 2/2: 45it [00:08,  5.13it/s]
Epoch 2/2: 53it [00:10,  5.18it/s]
Epoch 2/2: 61it [00:11,  5.22it/s]
Epoch 2/2: 69it [00:13,  5.25it/s]
Epoch 2/2: 77it [00:14,  5.27it/s]
Epoch 2/2: 85it [00:16,  5.30it/s]
Epoch 2/2: 93it [00:17,  5.32it/s]
Epoch 2/2: 101it [00:18,  5.34it/s]
Epoch 2/2: 109it [00:20,  5.36it/s]
Epoch 2/2: 117it [00:21,  5.36it/s]
Epoch 2/2: 125it [00:23,  5.37it/s]
Epoch 2/2: 133it [00:24,  5.39it/s]
Epoch 2/2: 141it [00:26,  5.39it/s]
Epoch 2/2: 149it [00:27,  5.40it/s]
Epoch 2/2: 157it [00:29,  5.41it/s]
Epoch 2/2: 165it [00:30,  5.42it/s]
Epoch 2/2: 173it [00:31,  5.42it/s]
Epoch 2/2: 181it [00:33,  5.43it/s]
Epoch 2/2: 189it [00:34,  5.44it/s]
Epoch 2/2: 197it [00:36,  5.44it/s]
Epoch 2/2: 205it [00:37,  5.46it/s]
Epoch 2/2: 213it [00:38,  5.46it/s]
Epoch 2/2: 221it [00:40,  5.46it/s]
Epoch 2/2: 229it [00:41,  5.47it/s]
Epoch 2/2: 237it [00:43,  5.47it/s]
Epoch 2/2: 245it [00:44,  5.47it/s]
Epoch 2/2: 253it [00:46,  5.48it/s]
Epoch 2/2: 261it [00:47,  5.48it/s]
Epoch 2/2: 269it [00:49,  5.48it/s]
Epoch 2/2: 277it [00:50,  5.49it/s]
Epoch 2/2: 285it [00:51,  5.49it/s]
Epoch 2/2: 293it [00:53,  5.49it/s]
Epoch 2/2: 301it [00:54,  5.49it/s]
Epoch 2/2: 309it [00:56,  5.50it/s]
Epoch 2/2: 317it [00:58,  5.45it/s]
Epoch 2/2: 325it [00:59,  5.45it/s]
Epoch 2/2: 333it [01:01,  5.41it/s]
Epoch 2/2: 341it [01:03,  5.37it/s]
Epoch 2/2: 348it [01:04,  5.37it/s]
Epoch 2: Processed 88514 samples in 64.76s (1366.72 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 142.09s
  Throughput: 1366.72 images/sec
  Time to first batch: 2.2307s
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/webdataset_benchmark


========== MosaicML MDS ==========
Seed set to 42
Seed set to 42
Using remote path: s3://datology-assets-dev/users/haoli/shards/mds
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   0%|          | 1/346 [00:19<1:53:01, 19.66s/it]
Epoch 1/2:   3%|▎         | 9/346 [00:21<13:10,  2.35s/it]  
Epoch 1/2:   5%|▍         | 17/346 [00:22<07:14,  1.32s/it]
Epoch 1/2:   7%|▋         | 25/346 [00:23<05:05,  1.05it/s]
Epoch 1/2:  10%|▉         | 33/346 [00:25<03:57,  1.32it/s]
Epoch 1/2:  12%|█▏        | 41/346 [00:26<03:16,  1.56it/s]
Epoch 1/2:  14%|█▍        | 49/346 [00:27<02:47,  1.77it/s]
Epoch 1/2:  16%|█▋        | 57/346 [00:28<02:26,  1.97it/s]
Epoch 1/2:  19%|█▉        | 65/346 [00:30<02:10,  2.15it/s]
Epoch 1/2:  21%|██        | 73/346 [00:31<01:58,  2.31it/s]
Epoch 1/2:  23%|██▎       | 81/346 [00:32<01:47,  2.46it/s]
Epoch 1/2:  26%|██▌       | 89/346 [00:34<01:38,  2.60it/s]
Epoch 1/2:  28%|██▊       | 97/346 [00:35<01:31,  2.73it/s]
Epoch 1/2:  30%|███       | 105/346 [00:36<01:24,  2.85it/s]
Epoch 1/2:  33%|███▎      | 113/346 [00:38<01:18,  2.96it/s]
Epoch 1/2:  35%|███▍      | 121/346 [00:39<01:13,  3.06it/s]
Epoch 1/2:  37%|███▋      | 129/346 [00:40<01:08,  3.15it/s]
Epoch 1/2:  40%|███▉      | 137/346 [00:42<01:04,  3.24it/s]
Epoch 1/2:  42%|████▏     | 145/346 [00:43<01:00,  3.33it/s]
Epoch 1/2:  44%|████▍     | 153/346 [00:44<00:56,  3.41it/s]
Epoch 1/2:  47%|████▋     | 161/346 [00:46<00:53,  3.49it/s]
Epoch 1/2:  49%|████▉     | 169/346 [00:47<00:49,  3.56it/s]
Epoch 1/2:  51%|█████     | 177/346 [00:48<00:46,  3.62it/s]
Epoch 1/2:  53%|█████▎    | 185/346 [00:50<00:43,  3.69it/s]
Epoch 1/2:  56%|█████▌    | 193/346 [00:51<00:40,  3.75it/s]
Epoch 1/2:  58%|█████▊    | 201/346 [00:52<00:38,  3.81it/s]
Epoch 1/2:  60%|██████    | 209/346 [00:54<00:35,  3.87it/s]
Epoch 1/2:  63%|██████▎   | 217/346 [00:55<00:32,  3.92it/s]
Epoch 1/2:  65%|██████▌   | 225/346 [00:56<00:30,  3.97it/s]
Epoch 1/2:  67%|██████▋   | 233/346 [00:57<00:28,  4.02it/s]
Epoch 1/2:  70%|██████▉   | 241/346 [00:59<00:25,  4.07it/s]
Epoch 1/2:  72%|███████▏  | 249/346 [01:00<00:23,  4.11it/s]
Epoch 1/2:  74%|███████▍  | 257/346 [01:01<00:21,  4.16it/s]
Epoch 1/2:  77%|███████▋  | 265/346 [01:03<00:19,  4.20it/s]
Epoch 1/2:  79%|███████▉  | 273/346 [01:04<00:17,  4.23it/s]
Epoch 1/2:  81%|████████  | 281/346 [01:05<00:15,  4.27it/s]
Epoch 1/2:  84%|████████▎ | 289/346 [01:07<00:13,  4.30it/s]
Epoch 1/2:  86%|████████▌ | 297/346 [01:08<00:11,  4.33it/s]
Epoch 1/2:  88%|████████▊ | 305/346 [01:09<00:09,  4.36it/s]
Epoch 1/2:  90%|█████████ | 313/346 [01:11<00:07,  4.40it/s]
Epoch 1/2:  93%|█████████▎| 321/346 [01:12<00:05,  4.43it/s]
Epoch 1/2:  95%|█████████▌| 329/346 [01:13<00:03,  4.46it/s]
Epoch 1/2:  97%|█████████▋| 337/346 [01:14<00:02,  4.50it/s]
Epoch 1/2: 100%|█████████▉| 345/346 [01:16<00:00,  4.53it/s]
Epoch 1/2: 100%|██████████| 346/346 [01:16<00:00,  4.54it/s]
Time to first batch: 19.6570s
Epoch 1: Processed 88514 samples in 76.23s (1161.20 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   1%|          | 4/346 [00:01<01:25,  3.98it/s]
Epoch 2/2:   3%|▎         | 9/346 [00:02<01:25,  3.95it/s]
Epoch 2/2:   5%|▍         | 17/346 [00:03<01:08,  4.78it/s]
Epoch 2/2:   7%|▋         | 25/346 [00:04<01:01,  5.18it/s]
Epoch 2/2:  10%|▉         | 33/346 [00:06<00:58,  5.37it/s]
Epoch 2/2:  12%|█▏        | 41/346 [00:07<00:55,  5.50it/s]
Epoch 2/2:  14%|█▍        | 49/346 [00:08<00:52,  5.62it/s]
Epoch 2/2:  16%|█▋        | 57/346 [00:10<00:51,  5.65it/s]
Epoch 2/2:  19%|█▉        | 65/346 [00:11<00:49,  5.69it/s]
Epoch 2/2:  21%|██        | 73/346 [00:12<00:47,  5.74it/s]
Epoch 2/2:  23%|██▎       | 81/346 [00:14<00:46,  5.76it/s]
Epoch 2/2:  26%|██▌       | 89/346 [00:15<00:44,  5.78it/s]
Epoch 2/2:  28%|██▊       | 97/346 [00:16<00:42,  5.79it/s]
Epoch 2/2:  30%|███       | 105/346 [00:18<00:41,  5.81it/s]
Epoch 2/2:  33%|███▎      | 113/346 [00:19<00:39,  5.84it/s]
Epoch 2/2:  35%|███▍      | 121/346 [00:20<00:38,  5.86it/s]
Epoch 2/2:  37%|███▋      | 129/346 [00:21<00:36,  5.88it/s]
Epoch 2/2:  40%|███▉      | 137/346 [00:23<00:35,  5.89it/s]
Epoch 2/2:  42%|████▏     | 145/346 [00:24<00:34,  5.91it/s]
Epoch 2/2:  44%|████▍     | 153/346 [00:25<00:32,  5.92it/s]
Epoch 2/2:  47%|████▋     | 161/346 [00:27<00:31,  5.93it/s]
Epoch 2/2:  49%|████▉     | 169/346 [00:28<00:29,  5.92it/s]
Epoch 2/2:  51%|█████     | 177/346 [00:29<00:28,  5.92it/s]
Epoch 2/2:  53%|█████▎    | 185/346 [00:31<00:27,  5.92it/s]
Epoch 2/2:  56%|█████▌    | 193/346 [00:32<00:25,  5.92it/s]
Epoch 2/2:  58%|█████▊    | 201/346 [00:33<00:24,  5.93it/s]
Epoch 2/2:  60%|██████    | 209/346 [00:35<00:23,  5.94it/s]
Epoch 2/2:  63%|██████▎   | 217/346 [00:36<00:21,  5.95it/s]
Epoch 2/2:  65%|██████▌   | 225/346 [00:37<00:20,  5.96it/s]
Epoch 2/2:  67%|██████▋   | 233/346 [00:39<00:18,  5.96it/s]
Epoch 2/2:  70%|██████▉   | 241/346 [00:40<00:17,  5.96it/s]
Epoch 2/2:  72%|███████▏  | 249/346 [00:41<00:16,  5.97it/s]
Epoch 2/2:  74%|███████▍  | 257/346 [00:43<00:14,  5.97it/s]
Epoch 2/2:  77%|███████▋  | 265/346 [00:44<00:13,  5.97it/s]
Epoch 2/2:  79%|███████▉  | 273/346 [00:45<00:12,  5.98it/s]
Epoch 2/2:  81%|████████  | 281/346 [00:46<00:10,  5.98it/s]
Epoch 2/2:  84%|████████▎ | 289/346 [00:48<00:09,  5.98it/s]
Epoch 2/2:  86%|████████▌ | 297/346 [00:49<00:08,  5.98it/s]
Epoch 2/2:  88%|████████▊ | 305/346 [00:50<00:06,  5.99it/s]
Epoch 2/2:  90%|█████████ | 313/346 [00:52<00:05,  5.98it/s]
Epoch 2/2:  93%|█████████▎| 321/346 [00:53<00:04,  5.99it/s]
Epoch 2/2:  95%|█████████▌| 329/346 [00:54<00:02,  6.00it/s]
Epoch 2/2:  97%|█████████▋| 337/346 [00:56<00:01,  6.01it/s]
Epoch 2/2: 100%|█████████▉| 345/346 [00:57<00:00,  6.02it/s]
Epoch 2/2: 100%|██████████| 346/346 [00:57<00:00,  6.02it/s]
Epoch 2: Processed 88514 samples in 57.43s (1541.19 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 133.66s
  Throughput: 1541.19 images/sec
  Time to first batch: 19.6570s
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/mds_benchmark


========== LitData ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/stream/lightning_data.py:77: A newer version of litdata is available (0.2.45). Please consider upgrading with `pip install -U litdata`. Not all functionalities of the platform can be guaranteed to work with the current version.
Seed set to 42
Using S3 path from environment...
Using remote path: s3://datology-assets-dev/users/haoli/shards/litdata
Using remote path: s3://datology-assets-dev/users/haoli/shards/litdata
Cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark
Using cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark
Using 4 worker threads for data loading
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   1%|▏         | 5/346 [00:01<01:32,  3.68it/s]
Epoch 1/2:   4%|▍         | 13/346 [00:02<01:07,  4.96it/s]
Epoch 1/2:   6%|▌         | 21/346 [00:03<00:59,  5.42it/s]
Epoch 1/2:   8%|▊         | 29/346 [00:05<00:56,  5.62it/s]
Epoch 1/2:  11%|█         | 37/346 [00:06<00:53,  5.75it/s]
Epoch 1/2:  13%|█▎        | 45/346 [00:07<00:51,  5.86it/s]
Epoch 1/2:  15%|█▌        | 53/346 [00:08<00:49,  5.92it/s]
Epoch 1/2:  18%|█▊        | 61/346 [00:10<00:47,  5.95it/s]
Epoch 1/2:  20%|█▉        | 69/346 [00:11<00:46,  6.02it/s]
Epoch 1/2:  22%|██▏       | 77/346 [00:12<00:44,  6.05it/s]
Epoch 1/2:  25%|██▍       | 85/346 [00:13<00:42,  6.09it/s]
Epoch 1/2:  27%|██▋       | 93/346 [00:15<00:41,  6.12it/s]
Epoch 1/2:  29%|██▉       | 101/346 [00:16<00:39,  6.14it/s]
Epoch 1/2:  32%|███▏      | 109/346 [00:17<00:38,  6.16it/s]
Epoch 1/2:  34%|███▍      | 117/346 [00:18<00:37,  6.18it/s]
Epoch 1/2:  36%|███▌      | 125/346 [00:20<00:35,  6.20it/s]
Epoch 1/2:  38%|███▊      | 133/346 [00:21<00:34,  6.22it/s]
Epoch 1/2:  41%|████      | 141/346 [00:22<00:32,  6.23it/s]
Epoch 1/2:  43%|████▎     | 149/346 [00:23<00:31,  6.24it/s]
Epoch 1/2:  45%|████▌     | 157/346 [00:25<00:30,  6.24it/s]
Epoch 1/2:  48%|████▊     | 165/346 [00:26<00:28,  6.24it/s]
Epoch 1/2:  50%|█████     | 173/346 [00:27<00:27,  6.24it/s]
Epoch 1/2:  52%|█████▏    | 181/346 [00:28<00:26,  6.26it/s]
Epoch 1/2:  55%|█████▍    | 189/346 [00:30<00:25,  6.26it/s]
Epoch 1/2:  57%|█████▋    | 197/346 [00:31<00:23,  6.26it/s]
Epoch 1/2:  59%|█████▉    | 205/346 [00:32<00:22,  6.27it/s]
Epoch 1/2:  62%|██████▏   | 213/346 [00:33<00:21,  6.28it/s]
Epoch 1/2:  64%|██████▍   | 221/346 [00:35<00:19,  6.28it/s]
Epoch 1/2:  66%|██████▌   | 229/346 [00:36<00:18,  6.28it/s]
Epoch 1/2:  68%|██████▊   | 237/346 [00:37<00:17,  6.29it/s]
Epoch 1/2:  71%|███████   | 245/346 [00:38<00:16,  6.29it/s]
Epoch 1/2:  73%|███████▎  | 253/346 [00:40<00:14,  6.29it/s]
Epoch 1/2:  75%|███████▌  | 261/346 [00:41<00:13,  6.30it/s]
Epoch 1/2:  78%|███████▊  | 269/346 [00:42<00:12,  6.30it/s]
Epoch 1/2:  80%|████████  | 277/346 [00:43<00:10,  6.31it/s]
Epoch 1/2:  82%|████████▏ | 285/346 [00:45<00:09,  6.31it/s]
Epoch 1/2:  85%|████████▍ | 293/346 [00:46<00:08,  6.31it/s]
Epoch 1/2:  87%|████████▋ | 301/346 [00:47<00:07,  6.32it/s]
Epoch 1/2:  89%|████████▉ | 309/346 [00:48<00:05,  6.32it/s]
Epoch 1/2:  92%|█████████▏| 317/346 [00:50<00:04,  6.33it/s]
Epoch 1/2:  94%|█████████▍| 325/346 [00:51<00:03,  6.33it/s]
Epoch 1/2:  96%|█████████▌| 333/346 [00:52<00:02,  6.33it/s]
Epoch 1/2:  99%|█████████▊| 341/346 [00:53<00:00,  6.34it/s]
Epoch 1/2: 100%|██████████| 346/346 [00:54<00:00,  6.33it/s]
Time to first batch: 0.7243s
Epoch 1: Processed 88514 samples in 54.70s (1618.23 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   1%|▏         | 5/346 [00:01<01:32,  3.67it/s]
Epoch 2/2:   4%|▍         | 13/346 [00:02<01:07,  4.94it/s]
Epoch 2/2:   6%|▌         | 21/346 [00:03<01:00,  5.41it/s]
Epoch 2/2:   8%|▊         | 29/346 [00:05<00:56,  5.61it/s]
Epoch 2/2:  11%|█         | 37/346 [00:06<00:53,  5.75it/s]
Epoch 2/2:  13%|█▎        | 45/346 [00:07<00:51,  5.86it/s]
Epoch 2/2:  15%|█▌        | 53/346 [00:08<00:49,  5.93it/s]
Epoch 2/2:  18%|█▊        | 61/346 [00:10<00:47,  5.97it/s]
Epoch 2/2:  20%|█▉        | 69/346 [00:11<00:45,  6.03it/s]
Epoch 2/2:  22%|██▏       | 77/346 [00:12<00:44,  6.06it/s]
Epoch 2/2:  25%|██▍       | 85/346 [00:13<00:42,  6.09it/s]
Epoch 2/2:  27%|██▋       | 93/346 [00:15<00:41,  6.12it/s]
Epoch 2/2:  29%|██▉       | 101/346 [00:16<00:39,  6.13it/s]
Epoch 2/2:  32%|███▏      | 109/346 [00:17<00:38,  6.16it/s]
Epoch 2/2:  34%|███▍      | 117/346 [00:18<00:37,  6.17it/s]
Epoch 2/2:  36%|███▌      | 125/346 [00:20<00:35,  6.19it/s]
Epoch 2/2:  38%|███▊      | 133/346 [00:21<00:34,  6.20it/s]
Epoch 2/2:  41%|████      | 141/346 [00:22<00:33,  6.21it/s]
Epoch 2/2:  43%|████▎     | 149/346 [00:23<00:31,  6.22it/s]
Epoch 2/2:  45%|████▌     | 157/346 [00:25<00:30,  6.23it/s]
Epoch 2/2:  48%|████▊     | 165/346 [00:26<00:29,  6.23it/s]
Epoch 2/2:  50%|█████     | 173/346 [00:27<00:27,  6.24it/s]
Epoch 2/2:  52%|█████▏    | 181/346 [00:28<00:26,  6.25it/s]
Epoch 2/2:  55%|█████▍    | 189/346 [00:30<00:25,  6.26it/s]
Epoch 2/2:  57%|█████▋    | 197/346 [00:31<00:23,  6.26it/s]
Epoch 2/2:  59%|█████▉    | 205/346 [00:32<00:22,  6.27it/s]
Epoch 2/2:  62%|██████▏   | 213/346 [00:33<00:21,  6.27it/s]
Epoch 2/2:  64%|██████▍   | 221/346 [00:35<00:19,  6.28it/s]
Epoch 2/2:  66%|██████▌   | 229/346 [00:36<00:18,  6.28it/s]
Epoch 2/2:  68%|██████▊   | 237/346 [00:37<00:17,  6.29it/s]
Epoch 2/2:  71%|███████   | 245/346 [00:38<00:16,  6.29it/s]
Epoch 2/2:  73%|███████▎  | 253/346 [00:40<00:14,  6.29it/s]
Epoch 2/2:  75%|███████▌  | 261/346 [00:41<00:13,  6.30it/s]
Epoch 2/2:  78%|███████▊  | 269/346 [00:42<00:12,  6.30it/s]
Epoch 2/2:  80%|████████  | 277/346 [00:43<00:10,  6.31it/s]
Epoch 2/2:  82%|████████▏ | 285/346 [00:45<00:09,  6.31it/s]
Epoch 2/2:  85%|████████▍ | 293/346 [00:46<00:08,  6.32it/s]
Epoch 2/2:  87%|████████▋ | 301/346 [00:47<00:07,  6.32it/s]
Epoch 2/2:  89%|████████▉ | 309/346 [00:48<00:05,  6.32it/s]
Epoch 2/2:  92%|█████████▏| 317/346 [00:50<00:04,  6.33it/s]
Epoch 2/2:  94%|█████████▍| 325/346 [00:51<00:03,  6.33it/s]
Epoch 2/2:  96%|█████████▌| 333/346 [00:52<00:02,  6.33it/s]
Epoch 2/2:  99%|█████████▊| 341/346 [00:53<00:00,  6.34it/s]
Epoch 2/2: 100%|██████████| 346/346 [00:54<00:00,  6.33it/s]
Epoch 2: Processed 88514 samples in 54.67s (1618.92 images/sec)

Benchmark Summary:
  Total samples: 177028
  Wall time: 109.37s
  Throughput: 1618.92 images/sec
  Time to first batch: 0.7243s
Benchmark complete
Benchmark complete
Cleaning up cache directory: /home/ec2-user/benchmark-dataloader/stream/cache/litdata_benchmark


========== Energon ==========
Seed set to 42
/home/ec2-user/benchmark-dataloader/.venv/lib/python3.13/site-packages/megatron/energon/loader.py:89: FutureWarning: Passing a worker_config to get_loader() is deprecated and will have no effect.
  warn_deprecated(
Using MSC_CONFIG: /home/ec2-user/benchmark-dataloader/stream/.msc_config.yaml
Using remote path: s3://datology-assets-dev/users/haoli/shards/energon
rank=0, worker=0: sample_range=[0, 22129] in 221 slices, sum(count)=22129: indexes=[0, 100, 201 ...<216> 21930, 22029, 22129] slices=[benchmark-train-000000.tar[0(start), 100], benchmark-train-000000.tar[100, 201], benchmark-train-000000.tar[201, 301] ...<216> benchmark-train-000005.tar[2483, 2583], benchmark-train-000005.tar[2583, 2682], benchmark-train-000005.tar[2682, 2782]]
rank=0, worker=1: sample_range=[22129, 44257] in 221 slices, sum(count)=22128: indexes=[22129, 22228, 22328 ...<216> 44057, 44157, 44257] slices=[benchmark-train-000005.tar[2782, 2881], benchmark-train-000005.tar[2881, 2981], benchmark-train-000005.tar[2981, 3080] ...<216> benchmark-train-000011.tar[1493, 1592], benchmark-train-000011.tar[1592, 1692], benchmark-train-000011.tar[1692, 1792]]
rank=0, worker=2: sample_range=[44257, 66386] in 221 slices, sum(count)=22129: indexes=[44257, 44356, 44456 ...<216> 66180, 66283, 66386] slices=[benchmark-train-000011.tar[1792, 1891], benchmark-train-000011.tar[1891, 1991], benchmark-train-000011.tar[1991, 2091] ...<216> benchmark-train-000017.tar[410, 512], benchmark-train-000017.tar[512, 615], benchmark-train-000017.tar[615, 718]]
rank=0, worker=3: sample_range=[66386, 88514] in 221 slices, sum(count)=22128: indexes=[66386, 66487, 66588 ...<216> 88313, 88413, 88514] slices=[benchmark-train-000017.tar[718, 819], benchmark-train-000017.tar[819, 920], benchmark-train-000017.tar[920, 1021] ...<216> benchmark-train-000022.tar[3114, 3215], benchmark-train-000022.tar[3215, 3315], benchmark-train-000022.tar[3315, 3416(end)]]
Starting benchmark with batch size 256

Epoch 1/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 1/2:   0%|          | 1/346 [00:26<2:31:13, 26.30s/it]
Epoch 1/2:   2%|▏         | 6/346 [00:27<26:02,  4.60s/it]  
Epoch 1/2:   3%|▎         | 11/346 [00:28<14:31,  2.60s/it]
Epoch 1/2:   5%|▍         | 16/346 [00:29<10:11,  1.85s/it]
Epoch 1/2:   6%|▌         | 21/346 [00:32<08:25,  1.56s/it]
Epoch 1/2:   8%|▊         | 26/346 [00:36<07:29,  1.41s/it]
Epoch 1/2:   9%|▉         | 31/346 [00:37<06:21,  1.21s/it]
Epoch 1/2:  10%|█         | 36/346 [00:38<05:34,  1.08s/it]
Epoch 1/2:  12%|█▏        | 41/346 [00:39<04:57,  1.03it/s]
Epoch 1/2:  13%|█▎        | 46/346 [00:42<04:36,  1.08it/s]
Epoch 1/2:  15%|█▍        | 51/346 [00:44<04:16,  1.15it/s]
Epoch 1/2:  16%|█▌        | 56/346 [00:46<03:58,  1.22it/s]
Epoch 1/2:  18%|█▊        | 61/346 [00:47<03:40,  1.29it/s]
Epoch 1/2:  19%|█▉        | 66/346 [00:48<03:27,  1.35it/s]
Epoch 1/2:  21%|██        | 71/346 [00:50<03:17,  1.39it/s]
Epoch 1/2:  22%|██▏       | 76/346 [00:52<03:06,  1.44it/s]
Epoch 1/2:  23%|██▎       | 81/346 [00:54<02:57,  1.49it/s]
Epoch 1/2:  25%|██▍       | 86/346 [00:56<02:49,  1.53it/s]
Epoch 1/2:  26%|██▋       | 91/346 [00:57<02:40,  1.59it/s]
Epoch 1/2:  28%|██▊       | 96/346 [00:58<02:33,  1.63it/s]
Epoch 1/2:  29%|██▉       | 101/346 [01:01<02:28,  1.65it/s]
Epoch 1/2:  31%|███       | 106/346 [01:02<02:22,  1.69it/s]
Epoch 1/2:  32%|███▏      | 111/346 [01:04<02:16,  1.73it/s]
Epoch 1/2:  34%|███▎      | 116/346 [01:06<02:11,  1.75it/s]
Epoch 1/2:  35%|███▍      | 121/346 [01:08<02:07,  1.77it/s]
Epoch 1/2:  36%|███▋      | 126/346 [01:10<02:02,  1.80it/s]
Epoch 1/2:  38%|███▊      | 131/346 [01:11<01:57,  1.82it/s]
Epoch 1/2:  39%|███▉      | 136/346 [01:13<01:53,  1.86it/s]
Epoch 1/2:  41%|████      | 141/346 [01:14<01:48,  1.89it/s]
Epoch 1/2:  42%|████▏     | 146/346 [01:16<01:44,  1.91it/s]
Epoch 1/2:  44%|████▎     | 151/346 [01:18<01:41,  1.92it/s]
Epoch 1/2:  45%|████▌     | 156/346 [01:20<01:37,  1.94it/s]
Epoch 1/2:  47%|████▋     | 161/346 [01:21<01:33,  1.98it/s]
Epoch 1/2:  48%|████▊     | 166/346 [01:23<01:30,  1.99it/s]
Epoch 1/2:  49%|████▉     | 171/346 [01:25<01:27,  2.01it/s]
Epoch 1/2:  51%|█████     | 176/346 [01:26<01:24,  2.02it/s]
Epoch 1/2:  52%|█████▏    | 181/346 [01:28<01:20,  2.04it/s]
Epoch 1/2:  54%|█████▍    | 186/346 [01:30<01:17,  2.06it/s]
Epoch 1/2:  55%|█████▌    | 191/346 [01:31<01:14,  2.08it/s]
Epoch 1/2:  57%|█████▋    | 196/346 [01:33<01:11,  2.10it/s]
Epoch 1/2:  58%|█████▊    | 201/346 [01:35<01:09,  2.10it/s]
Epoch 1/2:  60%|█████▉    | 206/346 [01:37<01:06,  2.12it/s]
Epoch 1/2:  61%|██████    | 211/346 [01:38<01:03,  2.13it/s]
Epoch 1/2:  62%|██████▏   | 216/346 [01:40<01:00,  2.16it/s]
Epoch 1/2:  64%|██████▍   | 221/346 [01:42<00:57,  2.16it/s]
Epoch 1/2:  65%|██████▌   | 226/346 [01:44<00:55,  2.17it/s]
Epoch 1/2:  67%|██████▋   | 231/346 [01:45<00:52,  2.18it/s]
Epoch 1/2:  68%|██████▊   | 236/346 [01:47<00:49,  2.20it/s]
Epoch 1/2:  70%|██████▉   | 241/346 [01:49<00:47,  2.20it/s]
Epoch 1/2:  71%|███████   | 246/346 [01:51<00:45,  2.21it/s]
Epoch 1/2:  73%|███████▎  | 251/346 [01:52<00:42,  2.23it/s]
Epoch 1/2:  74%|███████▍  | 256/346 [01:54<00:40,  2.24it/s]
Epoch 1/2:  75%|███████▌  | 261/346 [01:56<00:37,  2.25it/s]
Epoch 1/2:  77%|███████▋  | 266/346 [01:57<00:35,  2.26it/s]
Epoch 1/2:  78%|███████▊  | 271/346 [01:59<00:33,  2.27it/s]
Epoch 1/2:  80%|███████▉  | 276/346 [02:01<00:30,  2.28it/s]
Epoch 1/2:  81%|████████  | 281/346 [02:02<00:28,  2.29it/s]
Epoch 1/2:  83%|████████▎ | 286/346 [02:04<00:26,  2.30it/s]
Epoch 1/2:  84%|████████▍ | 291/346 [02:05<00:23,  2.31it/s]
Epoch 1/2:  86%|████████▌ | 296/346 [02:07<00:21,  2.32it/s]
Epoch 1/2:  87%|████████▋ | 301/346 [02:09<00:19,  2.32it/s]
Epoch 1/2:  88%|████████▊ | 306/346 [02:11<00:17,  2.33it/s]
Epoch 1/2:  90%|████████▉ | 311/346 [02:13<00:15,  2.33it/s]
Epoch 1/2:  91%|█████████▏| 316/346 [02:15<00:12,  2.34it/s]
Epoch 1/2:  93%|█████████▎| 321/346 [02:16<00:10,  2.35it/s]
Epoch 1/2:  94%|█████████▍| 326/346 [02:17<00:08,  2.37it/s]
Epoch 1/2:  96%|█████████▌| 331/346 [02:19<00:06,  2.37it/s]
Epoch 1/2:  97%|█████████▋| 336/346 [02:21<00:04,  2.38it/s]
Epoch 1/2:  99%|█████████▊| 341/346 [02:22<00:02,  2.39it/s]
Epoch 1/2: 100%|██████████| 346/346 [02:24<00:00,  2.40it/s]
Epoch 1/2: 100%|██████████| 346/346 [02:24<00:00,  2.40it/s]
Time to first batch: 26.3021s
Epoch 1: Processed 88576 samples in 144.26s (613.98 images/sec)

Epoch 2/2:   0%|          | 0/346 [00:00<?, ?it/s]
Epoch 2/2:   0%|          | 1/346 [00:01<07:07,  1.24s/it]
Epoch 2/2:   2%|▏         | 6/346 [00:02<02:07,  2.67it/s]
Epoch 2/2:   3%|▎         | 11/346 [00:04<02:02,  2.73it/s]
Epoch 2/2:   5%|▍         | 16/346 [00:05<01:44,  3.15it/s]
Epoch 2/2:   6%|▌         | 21/346 [00:07<02:00,  2.70it/s]
Epoch 2/2:   8%|▊         | 26/346 [00:09<01:52,  2.84it/s]
Epoch 2/2:   9%|▉         | 31/346 [00:11<01:56,  2.71it/s]
Epoch 2/2:  10%|█         | 36/346 [00:12<01:47,  2.88it/s]
Epoch 2/2:  12%|█▏        | 41/346 [00:14<01:46,  2.87it/s]
Epoch 2/2:  13%|█▎        | 46/346 [00:16<01:44,  2.86it/s]
Epoch 2/2:  15%|█▍        | 51/346 [00:17<01:42,  2.88it/s]
Epoch 2/2:  16%|█▌        | 56/346 [00:19<01:41,  2.85it/s]
Epoch 2/2:  18%|█▊        | 61/346 [00:21<01:38,  2.89it/s]
Epoch 2/2:  19%|█▉        | 66/346 [00:22<01:35,  2.94it/s]
Epoch 2/2:  21%|██        | 71/346 [00:24<01:34,  2.92it/s]
Epoch 2/2:  22%|██▏       | 76/346 [00:26<01:32,  2.92it/s]
Epoch 2/2:  23%|██▎       | 81/346 [00:28<01:32,  2.87it/s]
Epoch 2/2:  25%|██▍       | 86/346 [00:29<01:28,  2.94it/s]
Epoch 2/2:  26%|██▋       | 91/346 [00:31<01:27,  2.91it/s]
Epoch 2/2:  28%|██▊       | 96/346 [00:32<01:25,  2.94it/s]
Epoch 2/2:  29%|██▉       | 101/346 [00:35<01:25,  2.87it/s]
Epoch 2/2:  31%|███       | 106/346 [00:36<01:23,  2.89it/s]
Epoch 2/2:  32%|███▏      | 111/346 [00:38<01:20,  2.90it/s]
Epoch 2/2:  34%|███▎      | 116/346 [00:39<01:18,  2.93it/s]
Epoch 2/2:  35%|███▍      | 121/346 [00:41<01:17,  2.91it/s]
Epoch 2/2:  36%|███▋      | 126/346 [00:43<01:16,  2.88it/s]
Epoch 2/2:  38%|███▊      | 131/346 [00:45<01:15,  2.86it/s]
Epoch 2/2:  39%|███▉      | 136/346 [00:46<01:12,  2.90it/s]
Epoch 2/2:  41%|████      | 141/346 [00:48<01:10,  2.90it/s]
Epoch 2/2:  42%|████▏     | 146/346 [00:50<01:09,  2.89it/s]
Epoch 2/2:  44%|████▎     | 151/346 [00:52<01:07,  2.88it/s]
Epoch 2/2:  45%|████▌     | 156/346 [00:54<01:06,  2.87it/s]
Epoch 2/2:  47%|████▋     | 161/346 [00:55<01:04,  2.88it/s]
Epoch 2/2:  48%|████▊     | 166/346 [00:57<01:02,  2.89it/s]
Epoch 2/2:  49%|████▉     | 171/346 [00:59<01:00,  2.89it/s]
Epoch 2/2:  51%|█████     | 176/346 [01:00<00:58,  2.90it/s]
Epoch 2/2:  52%|█████▏    | 181/346 [01:02<00:57,  2.89it/s]
Epoch 2/2:  54%|█████▍    | 186/346 [01:04<00:55,  2.90it/s]
Epoch 2/2:  55%|█████▌    | 191/346 [01:06<00:53,  2.89it/s]
Epoch 2/2:  57%|█████▋    | 196/346 [01:07<00:51,  2.90it/s]
Epoch 2/2:  58%|█████▊    | 201/346 [01:09<00:50,  2.88it/s]
Epoch 2/2:  60%|█████▉    | 206/346 [01:11<00:48,  2.90it/s]
Epoch 2/2:  61%|██████    | 211/346 [01:12<00:46,  2.89it/s]
Epoch 2/2:  62%|██████▏   | 216/346 [01:14<00:44,  2.90it/s]
Epoch 2/2:  64%|██████▍   | 221/346 [01:16<00:43,  2.90it/s]
Epoch 2/2:  65%|██████▌   | 226/346 [01:18<00:41,  2.90it/s]
Epoch 2/2:  67%|██████▋   | 231/346 [01:19<00:39,  2.91it/s]
Epoch 2/2:  68%|██████▊   | 236/346 [01:21<00:37,  2.91it/s]
Epoch 2/2:  70%|██████▉   | 241/346 [01:23<00:36,  2.90it/s]
Epoch 2/2:  71%|███████   | 246/346 [01:25<00:34,  2.89it/s]
Epoch 2/2:  73%|███████▎  | 251/346 [01:26<00:32,  2.89it/s]
Epoch 2/2:  74%|███████▍  | 256/346 [01:28<00:31,  2.90it/s]
Epoch 2/2:  75%|███████▌  | 261/346 [01:30<00:29,  2.89it/s]
Epoch 2/2:  77%|███████▋  | 266/346 [01:31<00:27,  2.91it/s]
Epoch 2/2:  78%|███████▊  | 271/346 [01:33<00:25,  2.89it/s]
Epoch 2/2:  80%|███████▉  | 276/346 [01:35<00:24,  2.90it/s]
Epoch 2/2:  81%|████████  | 281/346 [01:37<00:22,  2.89it/s]
Epoch 2/2:  83%|████████▎ | 286/346 [01:39<00:20,  2.88it/s]
Epoch 2/2:  84%|████████▍ | 291/346 [01:40<00:18,  2.90it/s]
Epoch 2/2:  86%|████████▌ | 296/346 [01:42<00:17,  2.89it/s]
Epoch 2/2:  87%|████████▋ | 301/346 [01:44<00:15,  2.89it/s]
Epoch 2/2:  88%|████████▊ | 306/346 [01:46<00:13,  2.87it/s]
Epoch 2/2:  90%|████████▉ | 311/346 [01:47<00:12,  2.88it/s]
Epoch 2/2:  91%|█████████▏| 316/346 [01:49<00:10,  2.88it/s]
Epoch 2/2:  93%|█████████▎| 321/346 [01:51<00:08,  2.88it/s]
Epoch 2/2:  94%|█████████▍| 326/346 [01:52<00:06,  2.89it/s]
Epoch 2/2:  96%|█████████▌| 331/346 [01:55<00:05,  2.87it/s]
Epoch 2/2:  97%|█████████▋| 336/346 [01:56<00:03,  2.89it/s]
Epoch 2/2:  99%|█████████▊| 341/346 [01:58<00:01,  2.89it/s]
Epoch 2/2: 100%|██████████| 346/346 [01:59<00:00,  2.90it/s]
Epoch 2/2: 100%|██████████| 346/346 [01:59<00:00,  2.90it/s]
Epoch 2: Processed 88576 samples in 119.15s (743.42 images/sec)

Benchmark Summary:
  Total samples: 177152
  Wall time: 263.41s
  Throughput: 743.42 images/sec
  Time to first batch: 26.3021s
Benchmark complete
