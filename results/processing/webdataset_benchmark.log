Reading parquet file: ./data/benchmark_dataset.parquet
Loaded 88514 samples from parquet file
Processing all 88514 samples as train split
Using 16 worker processes
Total samples: 88514, divided into 886 batches
# writing ./shards/webdataset/benchmark-train-000000.tar 0 0.0 GB 0

Processing batches:   0%|          | 0/886 [00:00<?, ?it/s]
Processing batches:   0%|          | 1/886 [00:00<01:30,  9.82it/s]
Processing batches:   0%|          | 3/886 [00:00<01:11, 12.35it/s]
Processing batches:   1%|          | 5/886 [00:00<01:00, 14.62it/s]
Processing batches:   1%|          | 7/886 [00:00<00:55, 15.77it/s]
Processing batches:   1%|          | 10/886 [00:00<00:48, 17.98it/s]
Processing batches:   1%|▏         | 13/886 [00:00<00:46, 18.68it/s]
Processing batches:   2%|▏         | 16/886 [00:00<00:44, 19.59it/s]
Processing batches:   2%|▏         | 19/886 [00:01<00:42, 20.33it/s]
Processing batches:   2%|▏         | 22/886 [00:01<00:41, 20.88it/s]
Processing batches:   3%|▎         | 25/886 [00:01<00:40, 21.30it/s]
Processing batches:   3%|▎         | 28/886 [00:01<00:40, 21.37it/s]
Processing batches:   3%|▎         | 31/886 [00:01<00:39, 21.59it/s]
Processing batches:   4%|▍         | 34/886 [00:01<00:39, 21.67it/s]
Processing batches:   4%|▍         | 37/886 [00:01<00:38, 21.93it/s]
Processing batches:   5%|▍         | 40/886 [00:01<00:38, 22.22it/s]
Processing batches:   5%|▍         | 43/886 [00:02<00:38, 21.77it/s]
Processing batches:   5%|▌         | 46/886 [00:02<00:38, 21.85it/s]
Processing batches:   6%|▌         | 49/886 [00:02<00:38, 21.77it/s]
Processing batches:   6%|▌         | 52/886 [00:02<00:38, 21.64it/s]
Processing batches:   6%|▌         | 55/886 [00:02<00:37, 22.11it/s]
Processing batches:   7%|▋         | 58/886 [00:02<00:37, 22.38it/s]
Processing batches:   7%|▋         | 61/886 [00:02<00:37, 21.87it/s]
Processing batches:   7%|▋         | 64/886 [00:03<00:36, 22.53it/s]
Processing batches:   8%|▊         | 67/886 [00:03<00:35, 22.87it/s]
Processing batches:   8%|▊         | 70/886 [00:03<00:35, 22.72it/s]
Processing batches:   8%|▊         | 73/886 [00:03<00:35, 22.89it/s]
Processing batches:   9%|▊         | 76/886 [00:03<00:35, 22.55it/s]
Processing batches:   9%|▉         | 79/886 [00:03<00:36, 22.25it/s]
Processing batches:   9%|▉         | 82/886 [00:03<00:36, 22.07it/s]
Processing batches:  10%|▉         | 85/886 [00:04<00:35, 22.49it/s]
Processing batches:  10%|▉         | 88/886 [00:04<00:35, 22.19it/s]
Processing batches:  10%|█         | 91/886 [00:04<00:35, 22.69it/s]
Processing batches:  11%|█         | 94/886 [00:04<00:35, 22.54it/s]
Processing batches:  11%|█         | 97/886 [00:04<00:34, 22.78it/s]
Processing batches:  11%|█▏        | 100/886 [00:04<00:34, 22.81it/s]
Processing batches:  12%|█▏        | 103/886 [00:04<00:34, 22.47it/s]
Processing batches:  12%|█▏        | 106/886 [00:04<00:34, 22.70it/s]
Processing batches:  12%|█▏        | 109/886 [00:05<00:33, 22.91it/s]
Processing batches:  13%|█▎        | 112/886 [00:05<00:33, 22.89it/s]
Processing batches:  13%|█▎        | 115/886 [00:05<00:34, 22.35it/s]
Processing batches:  13%|█▎        | 118/886 [00:05<00:34, 22.28it/s]
Processing batches:  14%|█▎        | 121/886 [00:05<00:34, 22.18it/s]
Processing batches:  14%|█▍        | 124/886 [00:05<00:34, 21.79it/s]
Processing batches:  14%|█▍        | 127/886 [00:05<00:35, 21.66it/s]
Processing batches:  15%|█▍        | 130/886 [00:06<00:33, 22.29it/s]
Processing batches:  15%|█▌        | 133/886 [00:06<00:34, 22.04it/s]
Processing batches:  15%|█▌        | 136/886 [00:06<00:34, 21.93it/s]
Processing batches:  16%|█▌        | 139/886 [00:06<00:32, 22.74it/s]
Processing batches:  16%|█▌        | 142/886 [00:06<00:33, 22.48it/s]
Processing batches:  16%|█▋        | 145/886 [00:06<00:33, 22.22it/s]
Processing batches:  17%|█▋        | 148/886 [00:06<00:33, 22.17it/s]
Processing batches:  17%|█▋        | 151/886 [00:06<00:32, 22.67it/s]
Processing batches:  17%|█▋        | 154/886 [00:07<00:33, 22.03it/s]
Processing batches:  18%|█▊        | 157/886 [00:07<00:33, 21.86it/s]
Processing batches:  18%|█▊        | 160/886 [00:07<00:33, 21.40it/s]
Processing batches:  18%|█▊        | 163/886 [00:07<00:34, 21.11it/s]
Processing batches:  19%|█▊        | 166/886 [00:07<00:33, 21.38it/s]
Processing batches:  19%|█▉        | 169/886 [00:07<00:33, 21.63it/s]
Processing batches:  19%|█▉        | 172/886 [00:07<00:32, 22.09it/s]
Processing batches:  20%|█▉        | 175/886 [00:08<00:31, 22.34it/s]
Processing batches:  20%|██        | 178/886 [00:08<00:31, 22.32it/s]
Processing batches:  20%|██        | 181/886 [00:08<00:32, 21.91it/s]
Processing batches:  21%|██        | 184/886 [00:08<00:31, 21.95it/s]
Processing batches:  21%|██        | 187/886 [00:08<00:31, 22.16it/s]
Processing batches:  21%|██▏       | 190/886 [00:08<00:31, 21.81it/s]
Processing batches:  22%|██▏       | 193/886 [00:08<00:31, 21.98it/s]
Processing batches:  22%|██▏       | 196/886 [00:09<00:31, 21.74it/s]
Processing batches:  22%|██▏       | 199/886 [00:09<00:31, 21.50it/s]
Processing batches:  23%|██▎       | 202/886 [00:09<00:30, 22.15it/s]
Processing batches:  23%|██▎       | 205/886 [00:09<00:30, 22.38it/s]
Processing batches:  23%|██▎       | 208/886 [00:09<00:30, 22.19it/s]
Processing batches:  24%|██▍       | 211/886 [00:09<00:30, 21.85it/s]
Processing batches:  24%|██▍       | 214/886 [00:09<00:30, 21.96it/s]
Processing batches:  24%|██▍       | 217/886 [00:09<00:30, 22.03it/s]
Processing batches:  25%|██▍       | 220/886 [00:10<00:30, 22.15it/s]
Processing batches:  25%|██▌       | 223/886 [00:10<00:29, 22.30it/s]
Processing batches:  26%|██▌       | 226/886 [00:10<00:29, 22.51it/s]
Processing batches:  26%|██▌       | 229/886 [00:10<00:29, 22.39it/s]
Processing batches:  26%|██▌       | 232/886 [00:10<00:28, 22.69it/s]
Processing batches:  27%|██▋       | 235/886 [00:10<00:28, 22.95it/s]
Processing batches:  27%|██▋       | 238/886 [00:10<00:28, 22.79it/s]
Processing batches:  27%|██▋       | 241/886 [00:11<00:28, 22.69it/s]
Processing batches:  28%|██▊       | 244/886 [00:11<00:28, 22.57it/s]
Processing batches:  28%|██▊       | 248/886 [00:11<00:25, 25.13it/s]
Processing batches:  29%|██▊       | 254/886 [00:11<00:19, 32.61it/s]
Processing batches:  29%|██▉       | 261/886 [00:11<00:15, 40.82it/s]
Processing batches:  30%|███       | 268/886 [00:11<00:13, 46.98it/s]
Processing batches:  31%|███       | 275/886 [00:11<00:11, 51.22it/s]
Processing batches:  32%|███▏      | 282/886 [00:11<00:11, 54.45it/s]
Processing batches:  33%|███▎      | 289/886 [00:11<00:10, 56.78it/s]
Processing batches:  33%|███▎      | 296/886 [00:12<00:10, 58.49it/s]
Processing batches:  34%|███▍      | 303/886 [00:12<00:09, 59.08it/s]
Processing batches:  35%|███▍      | 310/886 [00:12<00:09, 59.84it/s]
Processing batches:  36%|███▌      | 317/886 [00:12<00:09, 60.81it/s]
Processing batches:  37%|███▋      | 324/886 [00:12<00:09, 61.23it/s]
Processing batches:  37%|███▋      | 331/886 [00:12<00:08, 61.85it/s]
Processing batches:  38%|███▊      | 338/886 [00:12<00:08, 62.22it/s]
Processing batches:  39%|███▉      | 345/886 [00:12<00:08, 62.39it/s]
Processing batches:  40%|███▉      | 352/886 [00:12<00:08, 62.19it/s]
Processing batches:  41%|████      | 359/886 [00:13<00:08, 62.49it/s]
Processing batches:  41%|████▏     | 366/886 [00:13<00:08, 62.83it/s]
Processing batches:  42%|████▏     | 373/886 [00:13<00:08, 62.49it/s]
Processing batches:  43%|████▎     | 380/886 [00:13<00:08, 62.71it/s]
Processing batches:  44%|████▎     | 387/886 [00:13<00:07, 62.42it/s]
Processing batches:  44%|████▍     | 394/886 [00:13<00:07, 62.69it/s]
Processing batches:  45%|████▌     | 401/886 [00:13<00:07, 62.62it/s]
Processing batches:  46%|████▌     | 408/886 [00:13<00:07, 62.93it/s]
Processing batches:  47%|████▋     | 415/886 [00:13<00:07, 63.02it/s]
Processing batches:  48%|████▊     | 422/886 [00:14<00:07, 63.16it/s]
Processing batches:  48%|████▊     | 429/886 [00:14<00:07, 62.50it/s]
Processing batches:  49%|████▉     | 436/886 [00:14<00:07, 62.59it/s]
Processing batches:  50%|█████     | 443/886 [00:14<00:07, 62.56it/s]
Processing batches:  51%|█████     | 450/886 [00:14<00:06, 62.69it/s]
Processing batches:  52%|█████▏    | 457/886 [00:14<00:06, 62.64it/s]
Processing batches:  52%|█████▏    | 464/886 [00:14<00:06, 62.43it/s]
Processing batches:  53%|█████▎    | 471/886 [00:14<00:06, 62.52it/s]
Processing batches:  54%|█████▍    | 478/886 [00:14<00:06, 62.72it/s]
Processing batches:  55%|█████▍    | 485/886 [00:15<00:06, 62.91it/s]
Processing batches:  56%|█████▌    | 492/886 [00:15<00:06, 62.85it/s]
Processing batches:  56%|█████▋    | 499/886 [00:15<00:06, 62.29it/s]
Processing batches:  57%|█████▋    | 506/886 [00:15<00:06, 62.09it/s]
Processing batches:  58%|█████▊    | 513/886 [00:15<00:06, 62.07it/s]
Processing batches:  59%|█████▊    | 520/886 [00:15<00:05, 62.12it/s]
Processing batches:  59%|█████▉    | 527/886 [00:15<00:05, 62.00it/s]
Processing batches:  60%|██████    | 534/886 [00:15<00:05, 62.15it/s]
Processing batches:  61%|██████    | 541/886 [00:16<00:05, 59.42it/s]
Processing batches:  62%|██████▏   | 547/886 [00:16<00:05, 58.28it/s]
Processing batches:  63%|██████▎   | 554/886 [00:16<00:05, 59.78it/s]
Processing batches:  63%|██████▎   | 561/886 [00:16<00:05, 60.82it/s]
Processing batches:  64%|██████▍   | 568/886 [00:16<00:05, 60.90it/s]
Processing batches:  65%|██████▍   | 575/886 [00:16<00:05, 61.36it/s]
Processing batches:  66%|██████▌   | 582/886 [00:16<00:04, 61.62it/s]
Processing batches:  66%|██████▋   | 589/886 [00:16<00:04, 61.95it/s]
Processing batches:  67%|██████▋   | 596/886 [00:16<00:04, 62.26it/s]
Processing batches:  68%|██████▊   | 603/886 [00:17<00:04, 62.66it/s]
Processing batches:  69%|██████▉   | 610/886 [00:17<00:04, 62.90it/s]
Processing batches:  70%|██████▉   | 617/886 [00:17<00:04, 62.77it/s]
Processing batches:  70%|███████   | 624/886 [00:17<00:04, 62.44it/s]
Processing batches:  71%|███████   | 631/886 [00:17<00:04, 62.42it/s]
Processing batches:  72%|███████▏  | 638/886 [00:17<00:03, 62.30it/s]
Processing batches:  73%|███████▎  | 645/886 [00:17<00:03, 62.60it/s]
Processing batches:  74%|███████▎  | 652/886 [00:17<00:03, 62.77it/s]
Processing batches:  74%|███████▍  | 659/886 [00:17<00:03, 62.40it/s]
Processing batches:  75%|███████▌  | 666/886 [00:18<00:03, 62.60it/s]
Processing batches:  76%|███████▌  | 673/886 [00:18<00:03, 62.68it/s]
Processing batches:  77%|███████▋  | 680/886 [00:18<00:03, 62.74it/s]
Processing batches:  78%|███████▊  | 687/886 [00:18<00:03, 62.71it/s]
Processing batches:  78%|███████▊  | 694/886 [00:18<00:03, 62.72it/s]
Processing batches:  79%|███████▉  | 701/886 [00:18<00:02, 62.39it/s]
Processing batches:  80%|███████▉  | 708/886 [00:18<00:02, 62.42it/s]
Processing batches:  81%|████████  | 715/886 [00:18<00:02, 62.70it/s]
Processing batches:  81%|████████▏ | 722/886 [00:18<00:02, 62.71it/s]
Processing batches:  82%|████████▏ | 729/886 [00:19<00:02, 62.83it/s]
Processing batches:  83%|████████▎ | 736/886 [00:19<00:02, 62.58it/s]
Processing batches:  84%|████████▍ | 743/886 [00:19<00:02, 62.59it/s]
Processing batches:  85%|████████▍ | 750/886 [00:19<00:02, 62.66it/s]
Processing batches:  85%|████████▌ | 757/886 [00:19<00:02, 62.62it/s]
Processing batches:  86%|████████▌ | 764/886 [00:19<00:01, 62.78it/s]
Processing batches:  87%|████████▋ | 771/886 [00:19<00:01, 62.48it/s]
Processing batches:  88%|████████▊ | 778/886 [00:19<00:01, 62.26it/s]
Processing batches:  89%|████████▊ | 785/886 [00:19<00:01, 62.40it/s]
Processing batches:  89%|████████▉ | 792/886 [00:20<00:01, 62.47it/s]
Processing batches:  90%|█████████ | 799/886 [00:20<00:01, 62.29it/s]
Processing batches:  91%|█████████ | 806/886 [00:20<00:01, 62.26it/s]
Processing batches:  92%|█████████▏| 813/886 [00:20<00:01, 62.11it/s]
Processing batches:  93%|█████████▎| 820/886 [00:20<00:01, 62.27it/s]
Processing batches:  93%|█████████▎| 827/886 [00:20<00:00, 62.39it/s]
Processing batches:  94%|█████████▍| 834/886 [00:20<00:00, 62.26it/s]
Processing batches:  95%|█████████▍| 841/886 [00:20<00:00, 62.49it/s]
Processing batches:  96%|█████████▌| 848/886 [00:20<00:00, 62.65it/s]
Processing batches:  97%|█████████▋| 855/886 [00:21<00:00, 62.43it/s]
Processing batches:  97%|█████████▋| 862/886 [00:21<00:00, 62.66it/s]
Processing batches:  98%|█████████▊| 869/886 [00:21<00:00, 62.80it/s]
Processing batches:  99%|█████████▉| 876/886 [00:21<00:00, 62.91it/s]
Processing batches: 100%|█████████▉| 883/886 [00:21<00:00, 62.92it/s]
Processing batches: 100%|██████████| 886/886 [00:21<00:00, 41.15it/s]
# writing ./shards/webdataset/benchmark-train-000001.tar 3820 0.1 GB 3820
# writing ./shards/webdataset/benchmark-train-000002.tar 3905 0.1 GB 7725
# writing ./shards/webdataset/benchmark-train-000003.tar 3882 0.1 GB 11607
# writing ./shards/webdataset/benchmark-train-000004.tar 3932 0.1 GB 15539
# writing ./shards/webdataset/benchmark-train-000005.tar 3808 0.1 GB 19347
# writing ./shards/webdataset/benchmark-train-000006.tar 3777 0.1 GB 23124
# writing ./shards/webdataset/benchmark-train-000007.tar 3862 0.1 GB 26986
# writing ./shards/webdataset/benchmark-train-000008.tar 3844 0.1 GB 30830
# writing ./shards/webdataset/benchmark-train-000009.tar 3850 0.1 GB 34680
# writing ./shards/webdataset/benchmark-train-000010.tar 3876 0.1 GB 38556
# writing ./shards/webdataset/benchmark-train-000011.tar 3909 0.1 GB 42465
# writing ./shards/webdataset/benchmark-train-000012.tar 3791 0.1 GB 46256
# writing ./shards/webdataset/benchmark-train-000013.tar 3846 0.1 GB 50102
# writing ./shards/webdataset/benchmark-train-000014.tar 3863 0.1 GB 53965
# writing ./shards/webdataset/benchmark-train-000015.tar 3848 0.1 GB 57813
# writing ./shards/webdataset/benchmark-train-000016.tar 3961 0.1 GB 61774
# writing ./shards/webdataset/benchmark-train-000017.tar 3894 0.1 GB 65668
# writing ./shards/webdataset/benchmark-train-000018.tar 3955 0.1 GB 69623
# writing ./shards/webdataset/benchmark-train-000019.tar 3906 0.1 GB 73529
# writing ./shards/webdataset/benchmark-train-000020.tar 3828 0.1 GB 77357
# writing ./shards/webdataset/benchmark-train-000021.tar 3860 0.1 GB 81217
# writing ./shards/webdataset/benchmark-train-000022.tar 3881 0.1 GB 85098
Successfully processed and wrote 88514 samples
Dataset processed. Output in ./shards/webdataset/
Dataset write time: 24.43 seconds
Total script execution time: 28.49 seconds
Converting ./data/benchmark_dataset.parquet to WebDataset format in ./shards/webdataset
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/webdataset_converter.py --data ./data/benchmark_dataset.parquet --shards ./shards/webdataset --prefix benchmark

Timing Summary:
  Converter execution time: 30.87 seconds
  Total script time: 30.87 seconds
