Reading parquet file: ./data/benchmark_dataset.parquet
Loaded 88514 samples from parquet file
Using 1 worker processes
Writing 88514 samples to MDS format at: ./shards/mds

  0%|          | 0/88514 [00:00<?, ?it/s]
  2%|▏         | 1830/88514 [00:00<00:04, 18290.77it/s]
  4%|▍         | 3660/88514 [00:00<00:07, 11884.64it/s]
  6%|▌         | 4975/88514 [00:00<00:08, 9919.63it/s] 
  7%|▋         | 6045/88514 [00:00<00:09, 8680.90it/s]
  9%|▉         | 7813/88514 [00:00<00:08, 9032.80it/s]
 11%|█         | 9759/88514 [00:00<00:08, 9443.49it/s]
 13%|█▎        | 11745/88514 [00:01<00:07, 9727.85it/s]
 15%|█▌        | 13657/88514 [00:01<00:07, 9825.90it/s]
 18%|█▊        | 15600/88514 [00:01<00:07, 9926.79it/s]
 20%|█▉        | 17505/88514 [00:01<00:07, 9959.39it/s]
 22%|██▏       | 19467/88514 [00:01<00:06, 10053.40it/s]
 24%|██▍       | 21369/88514 [00:02<00:06, 10054.98it/s]
 26%|██▋       | 23302/88514 [00:02<00:06, 10078.42it/s]
 29%|██▊       | 25248/88514 [00:02<00:06, 10124.97it/s]
 31%|███       | 27180/88514 [00:02<00:06, 10159.70it/s]
 33%|███▎      | 29108/88514 [00:02<00:05, 10171.26it/s]
 35%|███▌      | 31054/88514 [00:03<00:05, 10111.48it/s]
 37%|███▋      | 32986/88514 [00:03<00:05, 10020.60it/s]
 40%|███▉      | 34964/88514 [00:03<00:05, 10141.06it/s]
 42%|████▏     | 36881/88514 [00:03<00:05, 10144.29it/s]
 44%|████▍     | 38790/88514 [00:03<00:04, 10124.18it/s]
 46%|████▌     | 40752/88514 [00:04<00:04, 10175.94it/s]
 48%|████▊     | 42699/88514 [00:04<00:04, 10197.72it/s]
 50%|█████     | 44673/88514 [00:04<00:04, 10255.40it/s]
 53%|█████▎    | 46622/88514 [00:04<00:04, 10259.76it/s]
 55%|█████▍    | 48592/88514 [00:04<00:03, 10287.33it/s]
 57%|█████▋    | 50452/88514 [00:04<00:03, 10192.49it/s]
 59%|█████▉    | 52330/88514 [00:05<00:03, 10143.99it/s]
 61%|██████▏   | 54249/88514 [00:05<00:03, 10122.55it/s]
 63%|██████▎   | 56162/88514 [00:05<00:03, 10073.26it/s]
 66%|██████▌   | 58069/88514 [00:05<00:03, 10096.50it/s]
 68%|██████▊   | 59968/88514 [00:05<00:02, 10078.39it/s]
 70%|██████▉   | 61862/88514 [00:06<00:02, 10010.17it/s]
 72%|███████▏  | 63734/88514 [00:06<00:02, 9978.98it/s] 
 74%|███████▍  | 65663/88514 [00:06<00:02, 10027.53it/s]
 76%|███████▋  | 67628/88514 [00:06<00:02, 10098.57it/s]
 79%|███████▊  | 69566/88514 [00:06<00:01, 10110.99it/s]
 81%|████████  | 71455/88514 [00:07<00:01, 10069.05it/s]
 83%|████████▎ | 73362/88514 [00:07<00:01, 10056.34it/s]
 85%|████████▌ | 75291/88514 [00:07<00:01, 10081.02it/s]
 87%|████████▋ | 77265/88514 [00:07<00:01, 10146.86it/s]
 89%|████████▉ | 79211/88514 [00:07<00:00, 10145.82it/s]
 92%|█████████▏| 81131/88514 [00:08<00:00, 10127.18it/s]
 94%|█████████▍| 83107/88514 [00:08<00:00, 10179.71it/s]
 96%|█████████▌| 85072/88514 [00:08<00:00, 10214.38it/s]
 98%|█████████▊| 86985/88514 [00:08<00:00, 10179.02it/s]
100%|██████████| 88514/88514 [00:08<00:00, 10203.41it/s]
Successfully wrote MDS dataset to ./shards/mds
Conversion completed in 12.80 seconds
Converting ./data/benchmark_dataset.parquet to MDS format in ./shards/mds
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/mosaicdataset_converter.py --data ./data/benchmark_dataset.parquet --out_dir ./shards/mds --num_workers 1
MDS conversion completed in 16.96 seconds
