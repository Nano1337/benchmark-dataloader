Seed set to 42
<sys>:0: UserWarning: A newer version of litdata is available (0.2.45). Please consider upgrading with `pip install -U litdata`. Not all functionalities of the platform can be guaranteed to work with the current version.
Using 1 worker processes
Found 15 parquet files in directory: ./data/benchmark_dataset.parquet
Processing 15 parquet files with 1 workers...
Create an account on https://lightning.ai/ to optimize your data faster using multiple nodes and large machines.
Setting multiprocessing start_method to spawn. 
Storing the files under /home/ec2-user/benchmark-dataloader/shards/litdata
Setup started with fast_dev_run=False.
Setup finished in 0.001 seconds. Found 15 items to process.
Starting 1 workers with 15 items. The progress bar is only updated when a worker finishes.
Workers are ready ! Starting data processing...


Progress:   0%|          | 0/15 [00:00<?, ?it/s][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (64.0 MB). The current chunk will be 64.0 MB in size.
  warnings.warn(


Progress:   7%|â–‹         | 1/15 [00:05<01:21,  5.82s/it][A

Progress:  13%|â–ˆâ–Ž        | 2/15 [00:07<00:48,  3.72s/it][A

Progress:  20%|â–ˆâ–ˆ        | 3/15 [00:09<00:36,  3.06s/it][A

Progress:  27%|â–ˆâ–ˆâ–‹       | 4/15 [00:10<00:29,  2.68s/it][A

Progress:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 5/15 [00:12<00:24,  2.45s/it][A

Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 6/15 [00:13<00:20,  2.33s/it][A

Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 7/15 [00:15<00:17,  2.21s/it][A

Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 8/15 [00:16<00:14,  2.12s/it][A

Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 9/15 [00:18<00:12,  2.08s/it][A

Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 10/15 [00:20<00:10,  2.02s/it][A

Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 11/15 [00:21<00:07,  1.97s/it][A

Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 12/15 [00:23<00:05,  1.93s/it][AWorker processing parquet file: ./data/benchmark_dataset.parquet/part-00000-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20422-1-c000.snappy.parquet (6309 rows)
Rank 0 inferred the following `['bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00001-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20423-1-c000.snappy.parquet (6218 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00002-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20424-1-c000.snappy.parquet (6173 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00003-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20425-1-c000.snappy.parquet (6060 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00004-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20426-1-c000.snappy.parquet (6158 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00005-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20427-1-c000.snappy.parquet (6030 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00006-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20428-1-c000.snappy.parquet (6067 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00007-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20429-1-c000.snappy.parquet (6056 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00008-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20430-1-c000.snappy.parquet (5921 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00009-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20431-1-c000.snappy.parquet (5986 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00010-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20432-1-c000.snappy.parquet (5898 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00011-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20433-1-c000.snappy.parquet (5964 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00012-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20434-1-c000.snappy.parquet (5944 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00013-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20435-1-c000.snappy.parquet (5826 rows)
Worker processing parquet file: ./data/benchmark_dataset.parquet/part-00014-tid-322500825160024747-799a60dc-6a6f-4117-804f-d1ad8b30f831-20436-1-c000.snappy.parquet (3904 rows)
Worker 0 is terminating.
Worker 0 is done.


Progress: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [00:28<00:00,  1.93s/it][A
Progress: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [00:29<00:00,  1.99s/it]
Workers are finished.
Finished data processing!
Counting total samples in parquet files...

Counting samples:   0%|          | 0/15 [00:00<?, ?it/s]
Counting samples: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15/15 [00:00<00:00, 6892.48it/s]

LitData statistics:
  Output directory: ./shards/litdata
  Number of samples in parquet files: 88514
  Number of files created: 49
  Prefix: benchmark

Timing Summary:
  Dataset write time: 29.82 seconds
  Total script time: 29.83 seconds
Converting ./data/benchmark_dataset.parquet to LitData format in ./shards/litdata
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/litdata_converter.py --data ./data/benchmark_dataset.parquet --out_dir ./shards/litdata --prefix benchmark --num_workers 1

Timing Summary:
  Dataset write time: 34.36 seconds
  Total script time: 34.36 seconds
