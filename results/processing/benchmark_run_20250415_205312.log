Cleaning up existing shards directory...
Creating fresh shards directory...
Starting benchmark at Tue Apr 15 20:53:12 UTC 2025
CPU count: 16



=========================================
   WEBDATASET BENCHMARK
   Tue Apr 15 20:53:12 UTC 2025
=========================================

Reading parquet file: ./data/benchmark_shard.parquet
Loaded 176453 samples from parquet file
Processing all 176453 samples as train split
Processing dataset:   0%|          | 0/176453 [00:00<?, ?it/s]Processing dataset:   0%|          | 427/176453 [00:00<00:41, 4267.19it/s]Processing dataset:   1%|          | 890/176453 [00:00<00:39, 4479.77it/s]Processing dataset:   1%|          | 1348/176453 [00:00<00:38, 4521.80it/s]Processing dataset:   1%|          | 1811/176453 [00:00<00:38, 4562.86it/s]Processing dataset:   1%|▏         | 2268/176453 [00:00<00:38, 4560.92it/s]Processing dataset:   2%|▏         | 2727/176453 [00:00<00:38, 4568.68it/s]Processing dataset:   2%|▏         | 3185/176453 [00:00<00:37, 4571.85it/s]Processing dataset:   2%|▏         | 3648/176453 [00:00<00:37, 4586.86it/s]Processing dataset:   2%|▏         | 4107/176453 [00:00<00:37, 4570.66it/s]Processing dataset:   3%|▎         | 4568/176453 [00:01<00:37, 4579.80it/s]Processing dataset:   3%|▎         | 5026/176453 [00:01<00:37, 4572.00it/s]Processing dataset:   3%|▎         | 5489/176453 [00:01<00:37, 4589.11it/s]Processing dataset:   3%|▎         | 5948/176453 [00:01<00:37, 4584.51it/s]Processing dataset:   4%|▎         | 6407/176453 [00:01<00:37, 4573.72it/s]Processing dataset:   4%|▍         | 6869/176453 [00:01<00:36, 4587.12it/s]Processing dataset:   4%|▍         | 7328/176453 [00:01<00:36, 4587.08it/s]Processing dataset:   4%|▍         | 7787/176453 [00:01<00:37, 4539.59it/s]Processing dataset:   5%|▍         | 8242/176453 [00:01<00:37, 4524.45it/s]Processing dataset:   5%|▍         | 8699/176453 [00:01<00:36, 4536.77it/s]Processing dataset:   5%|▌         | 9160/176453 [00:02<00:36, 4556.95it/s]Processing dataset:   5%|▌         | 9624/176453 [00:02<00:36, 4580.41it/s]Processing dataset:   6%|▌         | 10084/176453 [00:02<00:36, 4583.79it/s]Processing dataset:   6%|▌         | 10546/176453 [00:02<00:36, 4592.46it/s]Processing dataset:   6%|▌         | 11013/176453 [00:02<00:35, 4614.05it/s]Processing dataset:   7%|▋         | 11477/176453 [00:02<00:35, 4620.83it/s]Processing dataset:   7%|▋         | 11940/176453 [00:02<00:35, 4602.34it/s]Processing dataset:   7%|▋         | 12403/176453 [00:02<00:35, 4609.68it/s]Processing dataset:   7%|▋         | 12864/176453 [00:02<00:35, 4607.55it/s]Processing dataset:   8%|▊         | 13327/176453 [00:02<00:35, 4613.10it/s]Processing dataset:   8%|▊         | 13792/176453 [00:03<00:35, 4621.44it/s]Processing dataset:   8%|▊         | 14255/176453 [00:03<00:35, 4618.34it/s]Processing dataset:   8%|▊         | 14717/176453 [00:03<00:35, 4613.75it/s]Processing dataset:   9%|▊         | 15179/176453 [00:03<00:34, 4610.96it/s]Processing dataset:   9%|▉         | 15641/176453 [00:03<00:35, 4587.52it/s]Processing dataset:   9%|▉         | 16103/176453 [00:03<00:34, 4595.30it/s]Processing dataset:   9%|▉         | 16563/176453 [00:03<00:34, 4595.29it/s]Processing dataset:  10%|▉         | 17026/176453 [00:03<00:34, 4604.71it/s]Processing dataset:  10%|▉         | 17491/176453 [00:03<00:34, 4618.06it/s]Processing dataset:  10%|█         | 17957/176453 [00:03<00:34, 4628.52it/s]Processing dataset:  10%|█         | 18421/176453 [00:04<00:34, 4631.53it/s]Processing dataset:  11%|█         | 18885/176453 [00:04<00:34, 4620.25it/s]Processing dataset:  11%|█         | 19348/176453 [00:04<00:34, 4598.16it/s]Processing dataset:  11%|█         | 19808/176453 [00:04<00:34, 4585.39it/s]Processing dataset:  11%|█▏        | 20274/176453 [00:04<00:33, 4607.49it/s]Processing dataset:  12%|█▏        | 20736/176453 [00:04<00:33, 4609.80it/s]Processing dataset:  12%|█▏        | 21198/176453 [00:04<00:33, 4606.98it/s]Processing dataset:  12%|█▏        | 21660/176453 [00:04<00:33, 4610.75it/s]Processing dataset:  13%|█▎        | 22129/176453 [00:04<00:33, 4633.55it/s]Processing dataset:  13%|█▎        | 22594/176453 [00:04<00:33, 4635.87it/s]Processing dataset:  13%|█▎        | 23058/176453 [00:05<00:33, 4634.97it/s]Processing dataset:  13%|█▎        | 23522/176453 [00:05<00:33, 4606.73it/s]Processing dataset:  14%|█▎        | 23983/176453 [00:05<00:33, 4593.01it/s]Processing dataset:  14%|█▍        | 24447/176453 [00:05<00:33, 4604.95it/s]Processing dataset:  14%|█▍        | 24910/176453 [00:05<00:32, 4611.14it/s]Processing dataset:  14%|█▍        | 25378/176453 [00:05<00:32, 4629.61it/s]Processing dataset:  15%|█▍        | 25843/176453 [00:05<00:32, 4635.65it/s]Processing dataset:  15%|█▍        | 26307/176453 [00:05<00:32, 4613.93it/s]Processing dataset:  15%|█▌        | 26771/176453 [00:05<00:32, 4618.68it/s]Processing dataset:  15%|█▌        | 27233/176453 [00:05<00:32, 4607.78it/s]Processing dataset:  16%|█▌        | 27697/176453 [00:06<00:32, 4615.87it/s]Processing dataset:  16%|█▌        | 28159/176453 [00:06<00:32, 4611.70it/s]Processing dataset:  16%|█▌        | 28622/176453 [00:06<00:32, 4615.46it/s]Processing dataset:  16%|█▋        | 29084/176453 [00:06<00:31, 4612.97it/s]Processing dataset:  17%|█▋        | 29549/176453 [00:06<00:31, 4622.01it/s]Processing dataset:  17%|█▋        | 30012/176453 [00:06<00:31, 4622.79it/s]Processing dataset:  17%|█▋        | 30475/176453 [00:06<00:31, 4616.99it/s]Processing dataset:  18%|█▊        | 30937/176453 [00:06<00:31, 4590.38it/s]Processing dataset:  18%|█▊        | 31397/176453 [00:06<00:31, 4588.59it/s]Processing dataset:  18%|█▊        | 31856/176453 [00:06<00:31, 4577.12it/s]Processing dataset:  18%|█▊        | 32314/176453 [00:07<00:32, 4484.83it/s]Processing dataset:  19%|█▊        | 32766/176453 [00:07<00:31, 4492.37it/s]Processing dataset:  19%|█▉        | 33216/176453 [00:07<00:31, 4482.38it/s]Processing dataset:  19%|█▉        | 33676/176453 [00:07<00:31, 4516.32it/s]Processing dataset:  19%|█▉        | 34138/176453 [00:07<00:31, 4545.04it/s]Processing dataset:  20%|█▉        | 34597/176453 [00:07<00:31, 4557.17it/s]Processing dataset:  20%|█▉        | 35053/176453 [00:07<00:31, 4549.12it/s]Processing dataset:  20%|██        | 35512/176453 [00:07<00:30, 4558.25it/s]Processing dataset:  20%|██        | 35975/176453 [00:07<00:30, 4577.68it/s]Processing dataset:  21%|██        | 36437/176453 [00:07<00:30, 4587.63it/s]Processing dataset:  21%|██        | 36899/176453 [00:08<00:30, 4593.61it/s]Processing dataset:  21%|██        | 37364/176453 [00:08<00:30, 4610.41it/s]Processing dataset:  21%|██▏       | 37831/176453 [00:08<00:29, 4627.34it/s]Processing dataset:  22%|██▏       | 38294/176453 [00:08<00:29, 4620.77it/s]Processing dataset:  22%|██▏       | 38757/176453 [00:08<00:29, 4596.55it/s]Processing dataset:  22%|██▏       | 39217/176453 [00:08<00:29, 4591.86it/s]Processing dataset:  22%|██▏       | 39678/176453 [00:08<00:29, 4596.75it/s]Processing dataset:  23%|██▎       | 40140/176453 [00:08<00:29, 4602.57it/s]Processing dataset:  23%|██▎       | 40607/176453 [00:08<00:29, 4620.60it/s]Processing dataset:  23%|██▎       | 41070/176453 [00:08<00:29, 4621.71it/s]Processing dataset:  24%|██▎       | 41533/176453 [00:09<00:29, 4612.58it/s]Processing dataset:  24%|██▍       | 41997/176453 [00:09<00:29, 4618.45it/s]Processing dataset:  24%|██▍       | 42459/176453 [00:09<00:29, 4590.49it/s]Processing dataset:  24%|██▍       | 42919/176453 [00:09<00:29, 4586.36it/s]Processing dataset:  25%|██▍       | 43378/176453 [00:09<00:29, 4581.76it/s]Processing dataset:  25%|██▍       | 43837/176453 [00:09<00:28, 4583.95it/s]Processing dataset:  25%|██▌       | 44302/176453 [00:09<00:28, 4601.63it/s]Processing dataset:  25%|██▌       | 44764/176453 [00:09<00:28, 4606.94it/s]Processing dataset:  26%|██▌       | 45225/176453 [00:09<00:28, 4600.53it/s]Processing dataset:  26%|██▌       | 45686/176453 [00:09<00:28, 4597.68it/s]Processing dataset:  26%|██▌       | 46146/176453 [00:10<00:28, 4571.44it/s]Processing dataset:  26%|██▋       | 46604/176453 [00:10<00:28, 4554.34it/s]Processing dataset:  27%|██▋       | 47065/176453 [00:10<00:28, 4567.86it/s]Processing dataset:  27%|██▋       | 47522/176453 [00:10<00:28, 4565.77it/s]Processing dataset:  27%|██▋       | 47983/176453 [00:10<00:28, 4577.50it/s]Processing dataset:  27%|██▋       | 48446/176453 [00:10<00:27, 4591.69it/s]Processing dataset:  28%|██▊       | 48906/176453 [00:10<00:27, 4593.23it/s]Processing dataset:  28%|██▊       | 49371/176453 [00:10<00:27, 4609.94it/s]Processing dataset:  28%|██▊       | 49833/176453 [00:10<00:27, 4610.22it/s]Processing dataset:  29%|██▊       | 50295/176453 [00:10<00:27, 4569.69it/s]Processing dataset:  29%|██▉       | 50753/176453 [00:11<00:27, 4562.83it/s]Processing dataset:  29%|██▉       | 51216/176453 [00:11<00:27, 4581.44it/s]Processing dataset:  29%|██▉       | 51676/176453 [00:11<00:27, 4585.58it/s]Processing dataset:  30%|██▉       | 52137/176453 [00:11<00:27, 4589.74it/s]Processing dataset:  30%|██▉       | 52597/176453 [00:11<00:27, 4583.12it/s]Processing dataset:  30%|███       | 53058/176453 [00:11<00:26, 4589.20it/s]Processing dataset:  30%|███       | 53517/176453 [00:11<00:26, 4583.50it/s]Processing dataset:  31%|███       | 53976/176453 [00:11<00:26, 4564.82it/s]Processing dataset:  31%|███       | 54438/176453 [00:11<00:26, 4580.73it/s]Processing dataset:  31%|███       | 54897/176453 [00:11<00:26, 4575.71it/s]Processing dataset:  31%|███▏      | 55359/176453 [00:12<00:26, 4586.69it/s]Processing dataset:  32%|███▏      | 55823/176453 [00:12<00:26, 4600.34it/s]Processing dataset:  32%|███▏      | 56284/176453 [00:12<00:26, 4534.52it/s]Processing dataset:  32%|███▏      | 56746/176453 [00:12<00:26, 4557.50it/s]Processing dataset:  32%|███▏      | 57213/176453 [00:12<00:25, 4589.36it/s]Processing dataset:  33%|███▎      | 57677/176453 [00:12<00:25, 4603.04it/s]Processing dataset:  33%|███▎      | 58138/176453 [00:12<00:25, 4574.49it/s]Processing dataset:  33%|███▎      | 58597/176453 [00:12<00:25, 4575.78it/s]Processing dataset:  33%|███▎      | 59055/176453 [00:12<00:25, 4576.90it/s]Processing dataset:  34%|███▎      | 59513/176453 [00:12<00:25, 4570.52it/s]Processing dataset:  34%|███▍      | 59977/176453 [00:13<00:25, 4588.56it/s]Processing dataset:  34%|███▍      | 60439/176453 [00:13<00:25, 4595.63it/s]Processing dataset:  35%|███▍      | 60903/176453 [00:13<00:25, 4605.34it/s]Processing dataset:  35%|███▍      | 61364/176453 [00:13<00:25, 4592.81it/s]Processing dataset:  35%|███▌      | 61824/176453 [00:13<00:25, 4582.29it/s]Processing dataset:  35%|███▌      | 62284/176453 [00:13<00:24, 4586.18it/s]Processing dataset:  36%|███▌      | 62743/176453 [00:13<00:24, 4584.12it/s]Processing dataset:  36%|███▌      | 63208/176453 [00:13<00:24, 4601.64it/s]Processing dataset:  36%|███▌      | 63672/176453 [00:13<00:24, 4612.10it/s]Processing dataset:  36%|███▋      | 64134/176453 [00:13<00:24, 4600.02it/s]Processing dataset:  37%|███▋      | 64596/176453 [00:14<00:24, 4603.37it/s]Processing dataset:  37%|███▋      | 65057/176453 [00:14<00:24, 4603.86it/s]Processing dataset:  37%|███▋      | 65518/176453 [00:14<00:24, 4580.82it/s]Processing dataset:  37%|███▋      | 65977/176453 [00:14<00:24, 4571.52it/s]Processing dataset:  38%|███▊      | 66435/176453 [00:14<00:29, 3791.84it/s]Processing dataset:  38%|███▊      | 66882/176453 [00:14<00:27, 3967.46it/s]Processing dataset:  38%|███▊      | 67337/176453 [00:14<00:26, 4124.78it/s]Processing dataset:  38%|███▊      | 67788/176453 [00:14<00:25, 4231.16it/s]Processing dataset:  39%|███▊      | 68241/176453 [00:14<00:25, 4316.21it/s]Processing dataset:  39%|███▉      | 68694/176453 [00:15<00:24, 4377.74it/s]Processing dataset:  39%|███▉      | 69139/176453 [00:15<00:24, 4396.26it/s]Processing dataset:  39%|███▉      | 69602/176453 [00:15<00:23, 4463.19it/s]Processing dataset:  40%|███▉      | 70060/176453 [00:15<00:23, 4497.54it/s]Processing dataset:  40%|███▉      | 70525/176453 [00:15<00:23, 4540.12it/s]Processing dataset:  40%|████      | 70988/176453 [00:15<00:23, 4564.09it/s]Processing dataset:  40%|████      | 71448/176453 [00:15<00:22, 4574.71it/s]Processing dataset:  41%|████      | 71907/176453 [00:15<00:22, 4572.20it/s]Processing dataset:  41%|████      | 72368/176453 [00:15<00:22, 4582.24it/s]Processing dataset:  41%|████▏     | 72827/176453 [00:15<00:22, 4565.29it/s]Processing dataset:  42%|████▏     | 73284/176453 [00:16<00:22, 4564.13it/s]Processing dataset:  42%|████▏     | 73742/176453 [00:16<00:22, 4567.86it/s]Processing dataset:  42%|████▏     | 74200/176453 [00:16<00:22, 4571.30it/s]Processing dataset:  42%|████▏     | 74661/176453 [00:16<00:22, 4580.19it/s]Processing dataset:  43%|████▎     | 75120/176453 [00:16<00:22, 4575.73it/s]Processing dataset:  43%|████▎     | 75579/176453 [00:16<00:22, 4578.07it/s]Processing dataset:  43%|████▎     | 76038/176453 [00:16<00:21, 4580.32it/s]Processing dataset:  43%|████▎     | 76497/176453 [00:16<00:21, 4578.97it/s]Processing dataset:  44%|████▎     | 76955/176453 [00:16<00:21, 4552.04it/s]Processing dataset:  44%|████▍     | 77412/176453 [00:16<00:21, 4555.35it/s]Processing dataset:  44%|████▍     | 77869/176453 [00:17<00:21, 4558.76it/s]Processing dataset:  44%|████▍     | 78326/176453 [00:17<00:21, 4561.88it/s]Processing dataset:  45%|████▍     | 78783/176453 [00:17<00:21, 4525.47it/s]Processing dataset:  45%|████▍     | 79239/176453 [00:17<00:21, 4517.98it/s]Processing dataset:  45%|████▌     | 79700/176453 [00:17<00:21, 4545.08it/s]Processing dataset:  45%|████▌     | 80162/176453 [00:17<00:21, 4565.78it/s]Processing dataset:  46%|████▌     | 80620/176453 [00:17<00:20, 4568.50it/s]Processing dataset:  46%|████▌     | 81077/176453 [00:17<00:20, 4559.61it/s]Processing dataset:  46%|████▌     | 81536/176453 [00:17<00:20, 4567.80it/s]Processing dataset:  46%|████▋     | 81995/176453 [00:17<00:20, 4571.37it/s]Processing dataset:  47%|████▋     | 82453/176453 [00:18<00:20, 4567.84it/s]Processing dataset:  47%|████▋     | 82910/176453 [00:18<00:20, 4567.51it/s]Processing dataset:  47%|████▋     | 83367/176453 [00:18<00:20, 4564.94it/s]Processing dataset:  48%|████▊     | 83824/176453 [00:18<00:20, 4557.95it/s]Processing dataset:  48%|████▊     | 84280/176453 [00:18<00:20, 4555.07it/s]Processing dataset:  48%|████▊     | 84736/176453 [00:18<00:20, 4537.89it/s]Processing dataset:  48%|████▊     | 85197/176453 [00:18<00:20, 4558.60it/s]Processing dataset:  49%|████▊     | 85656/176453 [00:18<00:19, 4566.15it/s]Processing dataset:  49%|████▉     | 86113/176453 [00:18<00:19, 4548.16it/s]Processing dataset:  49%|████▉     | 86578/176453 [00:18<00:19, 4578.34it/s]Processing dataset:  49%|████▉     | 87036/176453 [00:19<00:19, 4514.05it/s]Processing dataset:  50%|████▉     | 87500/176453 [00:19<00:19, 4550.76it/s]Processing dataset:  50%|████▉     | 87958/176453 [00:19<00:19, 4556.94it/s]Processing dataset:  50%|█████     | 88414/176453 [00:19<00:19, 4542.73it/s]Processing dataset:  50%|█████     | 88871/176453 [00:19<00:19, 4550.06it/s]Processing dataset:  51%|█████     | 89329/176453 [00:19<00:19, 4557.23it/s]Processing dataset:  51%|█████     | 89790/176453 [00:19<00:18, 4571.10it/s]Processing dataset:  51%|█████     | 90256/176453 [00:19<00:18, 4597.32it/s]Processing dataset:  51%|█████▏    | 90717/176453 [00:19<00:18, 4600.13it/s]Processing dataset:  52%|█████▏    | 91183/176453 [00:19<00:18, 4617.05it/s]Processing dataset:  52%|█████▏    | 91645/176453 [00:20<00:18, 4611.13it/s]Processing dataset:  52%|█████▏    | 92107/176453 [00:20<00:18, 4609.11it/s]Processing dataset:  52%|█████▏    | 92568/176453 [00:20<00:18, 4540.19it/s]Processing dataset:  53%|█████▎    | 93023/176453 [00:20<00:18, 4540.20it/s]Processing dataset:  53%|█████▎    | 93482/176453 [00:20<00:18, 4553.99it/s]Processing dataset:  53%|█████▎    | 93943/176453 [00:20<00:18, 4570.06it/s]Processing dataset:  53%|█████▎    | 94402/176453 [00:20<00:17, 4575.65it/s]Processing dataset:  54%|█████▍    | 94860/176453 [00:20<00:17, 4575.06it/s]Processing dataset:  54%|█████▍    | 95324/176453 [00:20<00:17, 4593.46it/s]Processing dataset:  54%|█████▍    | 95784/176453 [00:20<00:17, 4576.75it/s]Processing dataset:  55%|█████▍    | 96242/176453 [00:21<00:17, 4549.64it/s]Processing dataset:  55%|█████▍    | 96698/176453 [00:21<00:17, 4537.58it/s]Processing dataset:  55%|█████▌    | 97158/176453 [00:21<00:17, 4555.00it/s]Processing dataset:  55%|█████▌    | 97621/176453 [00:21<00:17, 4574.49it/s]Processing dataset:  56%|█████▌    | 98082/176453 [00:21<00:17, 4583.55it/s]Processing dataset:  56%|█████▌    | 98541/176453 [00:21<00:17, 4574.74it/s]Processing dataset:  56%|█████▌    | 98999/176453 [00:21<00:16, 4564.17it/s]Processing dataset:  56%|█████▋    | 99459/176453 [00:21<00:16, 4573.13it/s]Processing dataset:  57%|█████▋    | 99917/176453 [00:21<00:16, 4564.06it/s]Processing dataset:  57%|█████▋    | 100378/176453 [00:21<00:16, 4577.37it/s]Processing dataset:  57%|█████▋    | 100836/176453 [00:22<00:16, 4576.62it/s]Processing dataset:  57%|█████▋    | 101295/176453 [00:22<00:16, 4578.60it/s]Processing dataset:  58%|█████▊    | 101753/176453 [00:22<00:16, 4566.48it/s]Processing dataset:  58%|█████▊    | 102213/176453 [00:22<00:16, 4574.09it/s]Processing dataset:  58%|█████▊    | 102671/176453 [00:22<00:16, 4561.84it/s]Processing dataset:  58%|█████▊    | 103130/176453 [00:22<00:16, 4567.34it/s]Processing dataset:  59%|█████▊    | 103588/176453 [00:22<00:15, 4568.83it/s]Processing dataset:  59%|█████▉    | 104045/176453 [00:22<00:15, 4555.36it/s]Processing dataset:  59%|█████▉    | 104501/176453 [00:22<00:15, 4555.16it/s]Processing dataset:  59%|█████▉    | 104960/176453 [00:22<00:15, 4563.09it/s]Processing dataset:  60%|█████▉    | 105419/176453 [00:23<00:15, 4570.88it/s]Processing dataset:  60%|██████    | 105883/176453 [00:23<00:15, 4591.31it/s]Processing dataset:  60%|██████    | 106345/176453 [00:23<00:15, 4599.31it/s]Processing dataset:  61%|██████    | 106807/176453 [00:23<00:15, 4605.22it/s]Processing dataset:  61%|██████    | 107271/176453 [00:23<00:14, 4614.81it/s]Processing dataset:  61%|██████    | 107733/176453 [00:23<00:14, 4591.13it/s]Processing dataset:  61%|██████▏   | 108197/176453 [00:23<00:14, 4604.73it/s]Processing dataset:  62%|██████▏   | 108661/176453 [00:23<00:14, 4614.27it/s]Processing dataset:  62%|██████▏   | 109124/176453 [00:23<00:14, 4617.58it/s]Processing dataset:  62%|██████▏   | 109586/176453 [00:23<00:14, 4616.55it/s]Processing dataset:  62%|██████▏   | 110048/176453 [00:24<00:14, 4603.46it/s]Processing dataset:  63%|██████▎   | 110515/176453 [00:24<00:14, 4622.38it/s]Processing dataset:  63%|██████▎   | 110979/176453 [00:24<00:14, 4625.25it/s]Processing dataset:  63%|██████▎   | 111442/176453 [00:24<00:14, 4602.07it/s]Processing dataset:  63%|██████▎   | 111903/176453 [00:24<00:14, 4587.93it/s]Processing dataset:  64%|██████▎   | 112362/176453 [00:24<00:13, 4580.53it/s]Processing dataset:  64%|██████▍   | 112821/176453 [00:24<00:13, 4572.30it/s]Processing dataset:  64%|██████▍   | 113281/176453 [00:24<00:13, 4580.20it/s]Processing dataset:  64%|██████▍   | 113742/176453 [00:24<00:13, 4587.38it/s]Processing dataset:  65%|██████▍   | 114201/176453 [00:24<00:13, 4584.11it/s]Processing dataset:  65%|██████▍   | 114660/176453 [00:25<00:13, 4582.91it/s]Processing dataset:  65%|██████▌   | 115119/176453 [00:25<00:13, 4558.44it/s]Processing dataset:  66%|██████▌   | 115582/176453 [00:25<00:13, 4577.76it/s]Processing dataset:  66%|██████▌   | 116052/176453 [00:25<00:13, 4613.15it/s]Processing dataset:  66%|██████▌   | 116515/176453 [00:25<00:12, 4616.14it/s]Processing dataset:  66%|██████▋   | 116977/176453 [00:25<00:12, 4614.73it/s]Processing dataset:  67%|██████▋   | 117440/176453 [00:25<00:12, 4615.85it/s]Processing dataset:  67%|██████▋   | 117903/176453 [00:25<00:12, 4617.46it/s]Processing dataset:  67%|██████▋   | 118365/176453 [00:25<00:12, 4583.33it/s]Processing dataset:  67%|██████▋   | 118829/176453 [00:26<00:12, 4599.09it/s]Processing dataset:  68%|██████▊   | 119289/176453 [00:26<00:12, 4580.83it/s]Processing dataset:  68%|██████▊   | 119751/176453 [00:26<00:12, 4589.51it/s]Processing dataset:  68%|██████▊   | 120212/176453 [00:26<00:12, 4592.57it/s]Processing dataset:  68%|██████▊   | 120673/176453 [00:26<00:12, 4594.96it/s]Processing dataset:  69%|██████▊   | 121136/176453 [00:26<00:12, 4604.84it/s]Processing dataset:  69%|██████▉   | 121597/176453 [00:26<00:11, 4589.34it/s]Processing dataset:  69%|██████▉   | 122059/176453 [00:26<00:11, 4597.18it/s]Processing dataset:  69%|██████▉   | 122519/176453 [00:26<00:11, 4596.64it/s]Processing dataset:  70%|██████▉   | 122979/176453 [00:26<00:11, 4573.16it/s]Processing dataset:  70%|██████▉   | 123440/176453 [00:27<00:11, 4583.69it/s]Processing dataset:  70%|███████   | 123904/176453 [00:27<00:11, 4597.93it/s]Processing dataset:  70%|███████   | 124369/176453 [00:27<00:11, 4612.80it/s]Processing dataset:  71%|███████   | 124831/176453 [00:27<00:11, 4596.98it/s]Processing dataset:  71%|███████   | 125299/176453 [00:27<00:11, 4620.18it/s]Processing dataset:  71%|███████▏  | 125765/176453 [00:27<00:10, 4630.55it/s]Processing dataset:  72%|███████▏  | 126233/176453 [00:27<00:10, 4642.61it/s]Processing dataset:  72%|███████▏  | 126698/176453 [00:27<00:10, 4624.31it/s]Processing dataset:  72%|███████▏  | 127161/176453 [00:27<00:10, 4614.73it/s]Processing dataset:  72%|███████▏  | 127628/176453 [00:27<00:10, 4628.39it/s]Processing dataset:  73%|███████▎  | 128093/176453 [00:28<00:10, 4632.12it/s]Processing dataset:  73%|███████▎  | 128557/176453 [00:28<00:10, 4622.56it/s]Processing dataset:  73%|███████▎  | 129020/176453 [00:28<00:10, 4620.32it/s]Processing dataset:  73%|███████▎  | 129485/176453 [00:28<00:10, 4627.35it/s]Processing dataset:  74%|███████▎  | 129948/176453 [00:28<00:10, 4626.85it/s]Processing dataset:  74%|███████▍  | 130411/176453 [00:28<00:09, 4622.35it/s]Processing dataset:  74%|███████▍  | 130874/176453 [00:28<00:09, 4594.01it/s]Processing dataset:  74%|███████▍  | 131341/176453 [00:28<00:09, 4615.83it/s]Processing dataset:  75%|███████▍  | 131808/176453 [00:28<00:09, 4630.11it/s]Processing dataset:  75%|███████▍  | 132272/176453 [00:28<00:09, 4629.94it/s]Processing dataset:  75%|███████▌  | 132736/176453 [00:29<00:09, 4632.03it/s]Processing dataset:  75%|███████▌  | 133201/176453 [00:29<00:09, 4634.83it/s]Processing dataset:  76%|███████▌  | 133667/176453 [00:29<00:09, 4641.56it/s]Processing dataset:  76%|███████▌  | 134132/176453 [00:29<00:09, 4636.13it/s]Processing dataset:  76%|███████▋  | 134596/176453 [00:29<00:09, 4608.90it/s]Processing dataset:  77%|███████▋  | 135057/176453 [00:29<00:09, 4586.73it/s]Processing dataset:  77%|███████▋  | 135519/176453 [00:29<00:08, 4595.45it/s]Processing dataset:  77%|███████▋  | 135982/176453 [00:29<00:08, 4604.61it/s]Processing dataset:  77%|███████▋  | 136443/176453 [00:29<00:08, 4596.54it/s]Processing dataset:  78%|███████▊  | 136906/176453 [00:29<00:08, 4603.49it/s]Processing dataset:  78%|███████▊  | 137367/176453 [00:30<00:08, 4599.59it/s]Processing dataset:  78%|███████▊  | 137827/176453 [00:30<00:08, 4570.35it/s]Processing dataset:  78%|███████▊  | 138285/176453 [00:30<00:08, 4573.14it/s]Processing dataset:  79%|███████▊  | 138743/176453 [00:30<00:08, 4550.35it/s]Processing dataset:  79%|███████▉  | 139205/176453 [00:30<00:08, 4568.42it/s]Processing dataset:  79%|███████▉  | 139671/176453 [00:30<00:08, 4595.43it/s]Processing dataset:  79%|███████▉  | 140131/176453 [00:30<00:07, 4584.26it/s]Processing dataset:  80%|███████▉  | 140590/176453 [00:30<00:07, 4575.12it/s]Processing dataset:  80%|███████▉  | 141051/176453 [00:30<00:07, 4582.96it/s]Processing dataset:  80%|████████  | 141510/176453 [00:30<00:07, 4579.41it/s]Processing dataset:  80%|████████  | 141972/176453 [00:31<00:07, 4591.03it/s]Processing dataset:  81%|████████  | 142432/176453 [00:31<00:07, 4570.74it/s]Processing dataset:  81%|████████  | 142894/176453 [00:31<00:07, 4585.23it/s]Processing dataset:  81%|████████  | 143359/176453 [00:31<00:07, 4604.02it/s]Processing dataset:  82%|████████▏ | 143825/176453 [00:31<00:07, 4620.11it/s]Processing dataset:  82%|████████▏ | 144288/176453 [00:31<00:06, 4615.31it/s]Processing dataset:  82%|████████▏ | 144750/176453 [00:31<00:08, 3790.13it/s]Processing dataset:  82%|████████▏ | 145213/176453 [00:31<00:07, 4006.27it/s]Processing dataset:  83%|████████▎ | 145673/176453 [00:31<00:07, 4166.62it/s]Processing dataset:  83%|████████▎ | 146125/176453 [00:32<00:07, 4262.72it/s]Processing dataset:  83%|████████▎ | 146576/176453 [00:32<00:06, 4331.97it/s]Processing dataset:  83%|████████▎ | 147036/176453 [00:32<00:06, 4409.27it/s]Processing dataset:  84%|████████▎ | 147497/176453 [00:32<00:06, 4465.71it/s]Processing dataset:  84%|████████▍ | 147958/176453 [00:32<00:06, 4505.86it/s]Processing dataset:  84%|████████▍ | 148416/176453 [00:32<00:06, 4527.19it/s]Processing dataset:  84%|████████▍ | 148875/176453 [00:32<00:06, 4544.65it/s]Processing dataset:  85%|████████▍ | 149333/176453 [00:32<00:05, 4553.11it/s]Processing dataset:  85%|████████▍ | 149793/176453 [00:32<00:05, 4566.19it/s]Processing dataset:  85%|████████▌ | 150251/176453 [00:32<00:05, 4546.14it/s]Processing dataset:  85%|████████▌ | 150708/176453 [00:33<00:05, 4551.19it/s]Processing dataset:  86%|████████▌ | 151164/176453 [00:33<00:05, 4552.14it/s]Processing dataset:  86%|████████▌ | 151620/176453 [00:33<00:05, 4542.76it/s]Processing dataset:  86%|████████▌ | 152080/176453 [00:33<00:05, 4557.19it/s]Processing dataset:  86%|████████▋ | 152539/176453 [00:33<00:05, 4566.54it/s]Processing dataset:  87%|████████▋ | 152996/176453 [00:33<00:05, 4566.69it/s]Processing dataset:  87%|████████▋ | 153457/176453 [00:33<00:05, 4578.86it/s]Processing dataset:  87%|████████▋ | 153920/176453 [00:33<00:04, 4590.98it/s]Processing dataset:  87%|████████▋ | 154380/176453 [00:33<00:04, 4569.24it/s]Processing dataset:  88%|████████▊ | 154839/176453 [00:33<00:04, 4572.75it/s]Processing dataset:  88%|████████▊ | 155297/176453 [00:34<00:04, 4566.14it/s]Processing dataset:  88%|████████▊ | 155754/176453 [00:34<00:04, 4564.43it/s]Processing dataset:  89%|████████▊ | 156215/176453 [00:34<00:04, 4576.13it/s]Processing dataset:  89%|████████▉ | 156674/176453 [00:34<00:04, 4578.90it/s]Processing dataset:  89%|████████▉ | 157135/176453 [00:34<00:04, 4587.34it/s]Processing dataset:  89%|████████▉ | 157594/176453 [00:34<00:04, 4463.46it/s]Processing dataset:  90%|████████▉ | 158046/176453 [00:34<00:04, 4480.00it/s]Processing dataset:  90%|████████▉ | 158504/176453 [00:34<00:03, 4508.44it/s]Processing dataset:  90%|█████████ | 158962/176453 [00:34<00:03, 4528.66it/s]Processing dataset:  90%|█████████ | 159418/176453 [00:34<00:03, 4537.63it/s]Processing dataset:  91%|█████████ | 159877/176453 [00:35<00:03, 4551.12it/s]Processing dataset:  91%|█████████ | 160342/176453 [00:35<00:03, 4578.03it/s]Processing dataset:  91%|█████████ | 160803/176453 [00:35<00:03, 4585.71it/s]Processing dataset:  91%|█████████▏| 161263/176453 [00:35<00:03, 4588.89it/s]Processing dataset:  92%|█████████▏| 161722/176453 [00:35<00:03, 4587.30it/s]Processing dataset:  92%|█████████▏| 162181/176453 [00:35<00:03, 4563.89it/s]Processing dataset:  92%|█████████▏| 162639/176453 [00:35<00:03, 4567.78it/s]Processing dataset:  92%|█████████▏| 163096/176453 [00:35<00:02, 4561.75it/s]Processing dataset:  93%|█████████▎| 163559/176453 [00:35<00:02, 4582.04it/s]Processing dataset:  93%|█████████▎| 164021/176453 [00:35<00:02, 4592.03it/s]Processing dataset:  93%|█████████▎| 164481/176453 [00:36<00:02, 4581.39it/s]Processing dataset:  93%|█████████▎| 164944/176453 [00:36<00:02, 4594.89it/s]Processing dataset:  94%|█████████▎| 165404/176453 [00:36<00:02, 4591.01it/s]Processing dataset:  94%|█████████▍| 165864/176453 [00:36<00:02, 4569.14it/s]Processing dataset:  94%|█████████▍| 166322/176453 [00:36<00:02, 4570.89it/s]Processing dataset:  95%|█████████▍| 166781/176453 [00:36<00:02, 4573.99it/s]Processing dataset:  95%|█████████▍| 167242/176453 [00:36<00:02, 4582.92it/s]Processing dataset:  95%|█████████▌| 167701/176453 [00:36<00:01, 4582.04it/s]Processing dataset:  95%|█████████▌| 168160/176453 [00:36<00:01, 4559.68it/s]Processing dataset:  96%|█████████▌| 168616/176453 [00:36<00:01, 4539.21it/s]Processing dataset:  96%|█████████▌| 169070/176453 [00:37<00:01, 4505.51it/s]Processing dataset:  96%|█████████▌| 169521/176453 [00:37<00:01, 4497.61it/s]Processing dataset:  96%|█████████▋| 169971/176453 [00:37<00:01, 4497.16it/s]Processing dataset:  97%|█████████▋| 170429/176453 [00:37<00:01, 4520.88it/s]Processing dataset:  97%|█████████▋| 170885/176453 [00:37<00:01, 4532.44it/s]Processing dataset:  97%|█████████▋| 171342/176453 [00:37<00:01, 4543.00it/s]Processing dataset:  97%|█████████▋| 171800/176453 [00:37<00:01, 4551.47it/s]Processing dataset:  98%|█████████▊| 172257/176453 [00:37<00:00, 4555.12it/s]Processing dataset:  98%|█████████▊| 172721/176453 [00:37<00:00, 4577.72it/s]Processing dataset:  98%|█████████▊| 173182/176453 [00:37<00:00, 4585.71it/s]Processing dataset:  98%|█████████▊| 173641/176453 [00:38<00:00, 4575.27it/s]Processing dataset:  99%|█████████▊| 174099/176453 [00:38<00:00, 4576.08it/s]Processing dataset:  99%|█████████▉| 174563/176453 [00:38<00:00, 4593.06it/s]Processing dataset:  99%|█████████▉| 175031/176453 [00:38<00:00, 4617.58it/s]Processing dataset:  99%|█████████▉| 175493/176453 [00:38<00:00, 4612.10it/s]Processing dataset: 100%|█████████▉| 175956/176453 [00:38<00:00, 4617.42it/s]Processing dataset: 100%|█████████▉| 176422/176453 [00:38<00:00, 4629.67it/s]Processing dataset: 100%|██████████| 176453/176453 [00:38<00:00, 4565.82it/s]
Dataset processed. Output in ./shards/webdataset/
Dataset write time: 38.73 seconds
Total script execution time: 48.37 seconds
Converting ./data/benchmark_shard.parquet to WebDataset format in ./shards/webdataset
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/webdataset_converter.py --data ./data/benchmark_shard.parquet --shards ./shards/webdataset --prefix benchmark

Timing Summary:
  Converter execution time: 50.60 seconds
  Total script time: 50.61 seconds


=========================================
   MOSAICML MDS BENCHMARK
   Tue Apr 15 20:54:03 UTC 2025
=========================================

Reading parquet file: ./data/benchmark_shard.parquet
Loaded 176453 samples from parquet file
Using 16 worker processes
Writing 176453 samples to MDS format at: ./shards/mds
  0%|          | 0/176453 [00:00<?, ?it/s]  1%|          | 1670/176453 [00:00<00:10, 16694.44it/s]  2%|▏         | 3340/176453 [00:00<00:15, 10862.31it/s]  3%|▎         | 4541/176453 [00:00<00:18, 9098.90it/s]   3%|▎         | 5667/176453 [00:00<00:20, 8152.51it/s]  4%|▍         | 7633/176453 [00:00<00:19, 8877.33it/s]  5%|▌         | 9595/176453 [00:01<00:18, 9267.12it/s]  7%|▋         | 11565/176453 [00:01<00:17, 9514.29it/s]  8%|▊         | 13505/176453 [00:01<00:16, 9628.26it/s]  9%|▉         | 15486/176453 [00:01<00:16, 9760.42it/s] 10%|▉         | 17405/176453 [00:01<00:16, 9787.61it/s] 11%|█         | 19291/176453 [00:02<00:16, 9763.02it/s] 12%|█▏        | 21187/176453 [00:02<00:15, 9744.99it/s] 13%|█▎        | 23094/176453 [00:02<00:15, 9755.74it/s] 14%|█▍        | 25041/176453 [00:02<00:15, 9807.40it/s] 15%|█▌        | 26991/176453 [00:02<00:15, 9863.08it/s] 16%|█▋        | 28919/176453 [00:02<00:14, 9881.28it/s] 17%|█▋        | 30824/176453 [00:03<00:14, 9870.41it/s] 19%|█▊        | 32772/176453 [00:03<00:14, 9899.65it/s] 20%|█▉        | 34700/176453 [00:03<00:14, 9904.79it/s] 21%|██        | 36656/176453 [00:03<00:14, 9939.34it/s] 22%|██▏       | 38522/176453 [00:03<00:13, 9863.52it/s] 23%|██▎       | 40451/176453 [00:04<00:13, 9736.08it/s] 24%|██▍       | 42334/176453 [00:04<00:13, 9725.29it/s] 25%|██▌       | 44313/176453 [00:04<00:13, 9831.52it/s] 26%|██▌       | 46244/176453 [00:04<00:13, 9852.62it/s] 27%|██▋       | 48130/176453 [00:04<00:13, 9826.80it/s] 28%|██▊       | 50071/176453 [00:05<00:12, 9880.08it/s] 30%|██▉       | 52067/176453 [00:05<00:12, 9975.27it/s] 31%|███       | 54041/176453 [00:05<00:12, 10020.12it/s] 32%|███▏      | 55973/176453 [00:05<00:12, 9997.19it/s]  33%|███▎      | 57895/176453 [00:05<00:11, 9969.17it/s] 34%|███▍      | 59870/176453 [00:06<00:11, 10007.40it/s] 35%|███▌      | 61800/176453 [00:06<00:11, 9973.23it/s]  36%|███▌      | 63705/176453 [00:06<00:11, 9934.37it/s] 37%|███▋      | 65596/176453 [00:06<00:11, 9898.94it/s] 38%|███▊      | 67534/176453 [00:06<00:10, 9923.20it/s] 39%|███▉      | 69491/176453 [00:07<00:10, 9945.75it/s] 40%|████      | 71440/176453 [00:07<00:10, 9953.95it/s] 42%|████▏     | 73337/176453 [00:07<00:10, 9910.98it/s] 43%|████▎     | 75294/176453 [00:07<00:10, 9937.97it/s] 44%|████▍     | 77294/176453 [00:07<00:09, 10012.33it/s] 45%|████▍     | 79226/176453 [00:08<00:09, 9981.18it/s]  46%|████▌     | 81242/176453 [00:08<00:09, 10056.85it/s] 47%|████▋     | 83156/176453 [00:08<00:09, 9983.58it/s]  48%|████▊     | 85022/176453 [00:08<00:09, 9897.92it/s] 49%|████▉     | 86980/176453 [00:08<00:09, 9935.36it/s] 50%|█████     | 88888/176453 [00:09<00:08, 9905.10it/s] 51%|█████▏    | 90766/176453 [00:09<00:08, 9858.71it/s] 53%|█████▎    | 92645/176453 [00:09<00:08, 9827.17it/s] 54%|█████▎    | 94544/176453 [00:09<00:08, 9825.52it/s] 55%|█████▍    | 96468/176453 [00:09<00:08, 9850.60it/s] 56%|█████▌    | 98339/176453 [00:09<00:07, 9815.50it/s] 57%|█████▋    | 100281/176453 [00:10<00:07, 9855.09it/s] 58%|█████▊    | 102238/176453 [00:10<00:07, 9893.65it/s] 59%|█████▉    | 104186/176453 [00:10<00:07, 9912.69it/s] 60%|██████    | 106113/176453 [00:10<00:07, 9917.86it/s] 61%|██████    | 108015/176453 [00:11<00:08, 7961.83it/s] 62%|██████▏   | 109933/176453 [00:11<00:10, 6639.83it/s] 63%|██████▎   | 111902/176453 [00:11<00:09, 6757.81it/s] 65%|██████▍   | 113841/176453 [00:12<00:09, 6537.01it/s] 66%|██████▌   | 115734/176453 [00:12<00:09, 6463.48it/s] 67%|██████▋   | 117638/176453 [00:12<00:09, 6423.57it/s] 68%|██████▊   | 119593/176453 [00:13<00:08, 6460.74it/s] 69%|██████▉   | 121501/176453 [00:13<00:08, 6697.83it/s] 70%|██████▉   | 123406/176453 [00:13<00:07, 6872.82it/s] 71%|███████   | 125335/176453 [00:13<00:07, 7027.70it/s] 72%|███████▏  | 127243/176453 [00:14<00:06, 7039.19it/s] 73%|███████▎  | 129217/176453 [00:14<00:06, 7280.08it/s] 74%|███████▍  | 131158/176453 [00:14<00:06, 7095.09it/s] 75%|███████▌  | 133072/176453 [00:14<00:06, 6863.82it/s] 76%|███████▋  | 134967/176453 [00:15<00:07, 5737.06it/s] 78%|███████▊  | 136954/176453 [00:15<00:07, 5294.31it/s] 79%|███████▊  | 138879/176453 [00:16<00:07, 4980.68it/s] 80%|███████▉  | 140813/176453 [00:16<00:07, 4861.89it/s] 81%|████████  | 142698/176453 [00:17<00:07, 4712.01it/s] 82%|████████▏ | 144644/176453 [00:17<00:06, 4688.72it/s] 83%|████████▎ | 146601/176453 [00:17<00:06, 4746.35it/s] 84%|████████▍ | 148523/176453 [00:18<00:05, 4695.92it/s] 85%|████████▌ | 150398/176453 [00:18<00:05, 4659.69it/s] 86%|████████▋ | 152323/176453 [00:19<00:05, 4703.49it/s] 87%|████████▋ | 154204/176453 [00:19<00:04, 4702.41it/s] 88%|████████▊ | 156107/176453 [00:19<00:04, 4718.69it/s] 90%|████████▉ | 158055/176453 [00:20<00:03, 4730.07it/s] 91%|█████████ | 159930/176453 [00:20<00:03, 4717.31it/s] 92%|█████████▏| 161909/176453 [00:21<00:03, 4750.65it/s] 93%|█████████▎| 163891/176453 [00:21<00:02, 4809.62it/s] 94%|█████████▍| 165790/176453 [00:22<00:02, 4652.93it/s] 95%|█████████▌| 167733/176453 [00:22<00:01, 4424.08it/s] 96%|█████████▌| 169696/176453 [00:22<00:01, 4373.17it/s] 97%|█████████▋| 171633/176453 [00:23<00:01, 4323.28it/s] 98%|█████████▊| 173594/176453 [00:23<00:00, 4249.15it/s] 99%|█████████▉| 175565/176453 [00:24<00:00, 4231.36it/s]100%|██████████| 176453/176453 [00:24<00:00, 7229.85it/s]
Successfully wrote MDS dataset to ./shards/mds
Conversion completed in 34.04 seconds
Converting ./data/benchmark_shard.parquet to MDS format in ./shards/mds
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/mosaicdataset_converter.py --data ./data/benchmark_shard.parquet --out_dir ./shards/mds
MDS conversion completed in 38.11 seconds


=========================================
   LITDATA BENCHMARK
   Tue Apr 15 20:54:45 UTC 2025
=========================================

Seed set to 42
Found 88 parquet files in directory: ./data/benchmark_shard.parquet
Processing 88 parquet files...
Counting total number of samples...
Counting samples:   0%|          | 0/88 [00:00<?, ?it/s]Counting samples: 100%|██████████| 88/88 [00:00<00:00, 6771.34it/s]
<sys>:0: UserWarning: A newer version of litdata is available (0.2.45). Please consider upgrading with `pip install -U litdata`. Not all functionalities of the platform can be guaranteed to work with the current version.
Found 176453 total samples across all parquet files
Create an account on https://lightning.ai/ to optimize your data faster using multiple nodes and large machines.
Setting multiprocessing start_method to spawn. 
Storing the files under /home/ec2-user/benchmark-dataloader/shards/litdata
Setup started with fast_dev_run=False.
Setup finished in 0.001 seconds. Found 88 items to process.
Starting 16 workers with 88 items. The progress bar is only updated when a worker finishes.
Workers are ready ! Starting data processing...

Progress:   0%|          | 0/88 [00:00<?, ?it/s][A
Progress:   1%|          | 1/88 [00:08<12:49,  8.85s/it][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(

Progress:   5%|▍         | 4/88 [00:10<03:35,  2.56s/it][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(

Progress:  14%|█▎        | 12/88 [00:11<01:11,  1.06it/s][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(

Progress:  23%|██▎       | 20/88 [00:13<00:45,  1.51it/s][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(

Progress:  32%|███▏      | 28/88 [00:15<00:32,  1.84it/s][A
Progress:  41%|████      | 36/88 [00:16<00:23,  2.19it/s][A/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
/home/ec2-user/benchmark-dataloader/litData/src/litdata/streaming/writer.py:275: UserWarning: An item was larger than the target chunk size (67.0 MB). The current chunk will be 67.0 MB in size.
  warnings.warn(
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00058-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 11 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00059-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00060-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00061-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00062-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00063-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 11 is terminating.
Worker 11 is done.

Progress:  49%|████▉     | 43/88 [00:29<00:31,  1.44it/s][AWorker processing parquet file: ./data/benchmark_shard.parquet/part-00030-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 6 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00031-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00032-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00033-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00034-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 6 is terminating.
Worker 6 is done.

Progress:  52%|█████▏    | 46/88 [00:30<00:27,  1.51it/s][AWorker processing parquet file: ./data/benchmark_shard.parquet/part-00015-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 3 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00016-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00017-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00018-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00019-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 3 is terminating.
Worker 3 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00005-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 1 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00006-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00007-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00008-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00009-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 1 is terminating.
Worker 1 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00064-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 12 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00065-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00066-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00067-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00068-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00069-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 12 is terminating.
Worker 12 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00025-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 5 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00026-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00027-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00028-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00029-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 5 is terminating.
Worker 5 is done.

Progress:  66%|██████▌   | 58/88 [00:31<00:16,  1.84it/s][AWorker processing parquet file: ./data/benchmark_shard.parquet/part-00076-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 14 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00077-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00078-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00079-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00080-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00081-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 14 is terminating.
Worker 14 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00070-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 13 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00071-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00072-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00073-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00074-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00075-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 13 is terminating.
Worker 13 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00052-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 10 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00053-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00054-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00055-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00056-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00057-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 10 is terminating.
Worker 10 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00082-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 15 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00083-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00084-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00085-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00086-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00087-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 15 is terminating.
Worker 15 is done.

Progress:  80%|███████▉  | 70/88 [00:40<00:10,  1.73it/s][AWorker processing parquet file: ./data/benchmark_shard.parquet/part-00035-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 7 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00036-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00037-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00038-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00039-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 7 is terminating.
Worker 7 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00040-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 8 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00041-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00042-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00043-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00044-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00045-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 8 is terminating.
Worker 8 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00010-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 2 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00011-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00012-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00013-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00014-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 2 is terminating.
Worker 2 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00000-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 0 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00001-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00002-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00003-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00004-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 0 is terminating.
Worker 0 is done.

Progress:  93%|█████████▎| 82/88 [00:42<00:03,  1.93it/s][AWorker processing parquet file: ./data/benchmark_shard.parquet/part-00020-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 4 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00021-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00022-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00023-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00024-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 4 is terminating.
Worker 4 is done.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00046-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Rank 9 inferred the following `['str', 'bytes', 'str']` data format.
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00047-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00048-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00049-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00050-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker processing parquet file: ./data/benchmark_shard.parquet/part-00051-f06807c7-c3e0-4873-b694-8bbaba2261c3-c000.snappy.parquet
Worker 9 is terminating.
Worker 9 is done.
Progress: 100%|██████████| 88/88 [00:43<00:00,  2.01it/s]
Workers are finished.
Finished data processing!

LitData statistics:
  Output directory: ./shards/litdata
  Number of samples: 176453
  Number of files created: 105

Timing Summary:
  Dataset write time: 43.77 seconds
  Total script time: 43.79 seconds
Converting ./data/benchmark_shard.parquet to LitData format in ./shards/litdata
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/litdata_converter.py --data ./data/benchmark_shard.parquet --out_dir ./shards/litdata --prefix benchmark

Timing Summary:
  Dataset write time: 48.39 seconds
  Total script time: 48.39 seconds


=========================================
   BENCHMARK SUMMARY
   Tue Apr 15 20:55:33 UTC 2025
=========================================

BENCHMARK SUMMARY
Date: Tue Apr 15 20:55:33 UTC 2025
CPU Count: 16

| Format | Total Time (s) | Dataset Write (s) | Size (GB) | # Files |
| --- | --- | --- | --- | --- |
| LitData (PL) | 48.00 | 43.77 | 5.54 | 105 |
| WebDataset (WDS) | 51.00 | 38.73 | 6.32 | 46 |
| MosaicML Dataset (MDS) | 42.00 | 34.04 | 5.71 | 93 |

Total benchmark time: 141.00 seconds

Benchmark complete! Summary saved to results/processing/summary_20250415_205312.txt
Full logs available at results/processing/benchmark_run_20250415_205312.log
