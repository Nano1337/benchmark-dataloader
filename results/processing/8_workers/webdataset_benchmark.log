Reading parquet file: ./data/benchmark_dataset.parquet
Loaded 88514 samples from parquet file
Processing all 88514 samples as train split
Using 8 worker processes
Total samples: 88514, divided into 886 batches
# writing ./shards/webdataset/benchmark-train-000000.tar 0 0.0 GB 0

Processing batches:   0%|          | 0/886 [00:00<?, ?it/s]
Processing batches:   0%|          | 1/886 [00:00<01:33,  9.47it/s]
Processing batches:   0%|          | 3/886 [00:00<01:01, 14.41it/s]
Processing batches:   1%|          | 5/886 [00:00<00:53, 16.43it/s]
Processing batches:   1%|          | 7/886 [00:00<00:51, 17.15it/s]
Processing batches:   1%|          | 10/886 [00:00<00:47, 18.52it/s]
Processing batches:   1%|▏         | 13/886 [00:00<00:45, 19.25it/s]
Processing batches:   2%|▏         | 16/886 [00:00<00:44, 19.38it/s]
Processing batches:   2%|▏         | 19/886 [00:01<00:43, 20.04it/s]
Processing batches:   2%|▏         | 21/886 [00:01<00:43, 19.92it/s]
Processing batches:   3%|▎         | 24/886 [00:01<00:42, 20.22it/s]
Processing batches:   3%|▎         | 27/886 [00:01<00:43, 19.70it/s]
Processing batches:   3%|▎         | 30/886 [00:01<00:43, 19.74it/s]
Processing batches:   4%|▎         | 32/886 [00:01<00:43, 19.47it/s]
Processing batches:   4%|▍         | 35/886 [00:01<00:44, 19.29it/s]
Processing batches:   4%|▍         | 38/886 [00:01<00:41, 20.23it/s]
Processing batches:   5%|▍         | 41/886 [00:02<00:41, 20.50it/s]
Processing batches:   5%|▍         | 44/886 [00:02<00:40, 20.97it/s]
Processing batches:   5%|▌         | 47/886 [00:02<00:40, 20.84it/s]
Processing batches:   6%|▌         | 50/886 [00:02<00:40, 20.84it/s]
Processing batches:   6%|▌         | 53/886 [00:02<00:39, 20.88it/s]
Processing batches:   6%|▋         | 56/886 [00:02<00:39, 21.14it/s]
Processing batches:   7%|▋         | 59/886 [00:02<00:38, 21.61it/s]
Processing batches:   7%|▋         | 62/886 [00:03<00:37, 22.07it/s]
Processing batches:   7%|▋         | 65/886 [00:03<00:37, 21.80it/s]
Processing batches:   8%|▊         | 68/886 [00:03<00:37, 21.77it/s]
Processing batches:   8%|▊         | 71/886 [00:03<00:36, 22.21it/s]
Processing batches:   8%|▊         | 74/886 [00:03<00:36, 22.27it/s]
Processing batches:   9%|▊         | 77/886 [00:03<00:35, 22.49it/s]
Processing batches:   9%|▉         | 80/886 [00:03<00:36, 22.08it/s]
Processing batches:   9%|▉         | 83/886 [00:04<00:36, 22.16it/s]
Processing batches:  10%|▉         | 86/886 [00:04<00:37, 21.25it/s]
Processing batches:  10%|█         | 89/886 [00:04<00:37, 21.26it/s]
Processing batches:  10%|█         | 92/886 [00:04<00:37, 21.30it/s]
Processing batches:  11%|█         | 95/886 [00:04<00:36, 21.42it/s]
Processing batches:  11%|█         | 98/886 [00:04<00:36, 21.64it/s]
Processing batches:  11%|█▏        | 101/886 [00:04<00:35, 22.14it/s]
Processing batches:  12%|█▏        | 104/886 [00:05<00:36, 21.65it/s]
Processing batches:  12%|█▏        | 107/886 [00:05<00:36, 21.27it/s]
Processing batches:  12%|█▏        | 110/886 [00:05<00:35, 21.74it/s]
Processing batches:  13%|█▎        | 113/886 [00:05<00:36, 21.29it/s]
Processing batches:  13%|█▎        | 116/886 [00:05<00:36, 21.33it/s]
Processing batches:  13%|█▎        | 119/886 [00:05<00:35, 21.42it/s]
Processing batches:  14%|█▍        | 122/886 [00:05<00:35, 21.75it/s]
Processing batches:  14%|█▍        | 125/886 [00:05<00:34, 21.98it/s]
Processing batches:  14%|█▍        | 128/886 [00:06<00:33, 22.37it/s]
Processing batches:  15%|█▍        | 131/886 [00:06<00:33, 22.61it/s]
Processing batches:  15%|█▌        | 134/886 [00:06<00:33, 22.56it/s]
Processing batches:  15%|█▌        | 137/886 [00:06<00:33, 22.47it/s]
Processing batches:  16%|█▌        | 140/886 [00:06<00:32, 22.66it/s]
Processing batches:  16%|█▌        | 143/886 [00:06<00:32, 22.62it/s]
Processing batches:  16%|█▋        | 146/886 [00:06<00:32, 22.43it/s]
Processing batches:  17%|█▋        | 149/886 [00:07<00:32, 22.65it/s]
Processing batches:  17%|█▋        | 152/886 [00:07<00:32, 22.73it/s]
Processing batches:  17%|█▋        | 155/886 [00:07<00:32, 22.29it/s]
Processing batches:  18%|█▊        | 158/886 [00:07<00:33, 21.68it/s]
Processing batches:  18%|█▊        | 161/886 [00:07<00:34, 21.00it/s]
Processing batches:  19%|█▊        | 164/886 [00:07<00:34, 20.64it/s]
Processing batches:  19%|█▉        | 167/886 [00:07<00:33, 21.19it/s]
Processing batches:  19%|█▉        | 170/886 [00:08<00:33, 21.26it/s]
Processing batches:  20%|█▉        | 173/886 [00:08<00:33, 21.25it/s]
Processing batches:  20%|█▉        | 176/886 [00:08<00:33, 21.24it/s]
Processing batches:  20%|██        | 179/886 [00:08<00:33, 21.10it/s]
Processing batches:  21%|██        | 182/886 [00:08<00:33, 21.19it/s]
Processing batches:  21%|██        | 185/886 [00:08<00:32, 21.48it/s]
Processing batches:  21%|██        | 188/886 [00:08<00:31, 21.92it/s]
Processing batches:  22%|██▏       | 191/886 [00:09<00:32, 21.64it/s]
Processing batches:  22%|██▏       | 194/886 [00:09<00:32, 21.00it/s]
Processing batches:  22%|██▏       | 197/886 [00:09<00:32, 20.93it/s]
Processing batches:  23%|██▎       | 200/886 [00:09<00:32, 21.11it/s]
Processing batches:  23%|██▎       | 203/886 [00:09<00:32, 21.33it/s]
Processing batches:  23%|██▎       | 206/886 [00:09<00:31, 21.80it/s]
Processing batches:  24%|██▎       | 209/886 [00:09<00:30, 21.91it/s]
Processing batches:  24%|██▍       | 212/886 [00:09<00:30, 22.09it/s]
Processing batches:  24%|██▍       | 215/886 [00:10<00:29, 22.45it/s]
Processing batches:  25%|██▍       | 218/886 [00:10<00:29, 22.86it/s]
Processing batches:  25%|██▍       | 221/886 [00:10<00:29, 22.54it/s]
Processing batches:  25%|██▌       | 224/886 [00:10<00:29, 22.38it/s]
Processing batches:  26%|██▌       | 227/886 [00:10<00:28, 22.78it/s]
Processing batches:  26%|██▌       | 230/886 [00:10<00:28, 23.16it/s]
Processing batches:  26%|██▋       | 233/886 [00:10<00:28, 23.10it/s]
Processing batches:  27%|██▋       | 236/886 [00:11<00:28, 22.64it/s]
Processing batches:  27%|██▋       | 239/886 [00:11<00:28, 22.95it/s]
Processing batches:  28%|██▊       | 244/886 [00:11<00:22, 29.08it/s]
Processing batches:  28%|██▊       | 251/886 [00:11<00:16, 38.47it/s]
Processing batches:  29%|██▉       | 258/886 [00:11<00:13, 45.28it/s]
Processing batches:  30%|██▉       | 265/886 [00:11<00:12, 49.83it/s]
Processing batches:  31%|███       | 272/886 [00:11<00:11, 53.34it/s]
Processing batches:  31%|███▏      | 279/886 [00:11<00:10, 55.62it/s]
Processing batches:  32%|███▏      | 286/886 [00:11<00:10, 57.62it/s]
Processing batches:  33%|███▎      | 293/886 [00:12<00:10, 59.27it/s]
Processing batches:  34%|███▍      | 300/886 [00:12<00:09, 60.23it/s]
Processing batches:  35%|███▍      | 307/886 [00:12<00:09, 60.90it/s]
Processing batches:  35%|███▌      | 314/886 [00:12<00:09, 61.19it/s]
Processing batches:  36%|███▌      | 321/886 [00:12<00:09, 61.75it/s]
Processing batches:  37%|███▋      | 328/886 [00:12<00:08, 62.00it/s]
Processing batches:  38%|███▊      | 335/886 [00:12<00:08, 62.12it/s]
Processing batches:  39%|███▊      | 342/886 [00:12<00:08, 62.39it/s]
Processing batches:  39%|███▉      | 349/886 [00:12<00:08, 62.18it/s]
Processing batches:  40%|████      | 356/886 [00:13<00:08, 62.38it/s]
Processing batches:  41%|████      | 363/886 [00:13<00:08, 62.66it/s]
Processing batches:  42%|████▏     | 370/886 [00:13<00:08, 62.81it/s]
Processing batches:  43%|████▎     | 377/886 [00:13<00:08, 62.64it/s]
Processing batches:  43%|████▎     | 384/886 [00:13<00:07, 62.90it/s]
Processing batches:  44%|████▍     | 391/886 [00:13<00:07, 62.52it/s]
Processing batches:  45%|████▍     | 398/886 [00:13<00:07, 62.65it/s]
Processing batches:  46%|████▌     | 405/886 [00:13<00:07, 62.91it/s]
Processing batches:  47%|████▋     | 412/886 [00:13<00:07, 63.06it/s]
Processing batches:  47%|████▋     | 419/886 [00:14<00:07, 63.16it/s]
Processing batches:  48%|████▊     | 426/886 [00:14<00:07, 62.76it/s]
Processing batches:  49%|████▉     | 433/886 [00:14<00:07, 62.81it/s]
Processing batches:  50%|████▉     | 440/886 [00:14<00:07, 62.96it/s]
Processing batches:  50%|█████     | 447/886 [00:14<00:06, 62.92it/s]
Processing batches:  51%|█████     | 454/886 [00:14<00:06, 63.02it/s]
Processing batches:  52%|█████▏    | 461/886 [00:14<00:06, 62.57it/s]
Processing batches:  53%|█████▎    | 468/886 [00:14<00:06, 62.54it/s]
Processing batches:  54%|█████▎    | 475/886 [00:14<00:06, 62.76it/s]
Processing batches:  54%|█████▍    | 482/886 [00:15<00:06, 62.99it/s]
Processing batches:  55%|█████▌    | 489/886 [00:15<00:06, 62.98it/s]
Processing batches:  56%|█████▌    | 496/886 [00:15<00:06, 62.94it/s]
Processing batches:  57%|█████▋    | 503/886 [00:15<00:06, 62.74it/s]
Processing batches:  58%|█████▊    | 510/886 [00:15<00:05, 62.87it/s]
Processing batches:  58%|█████▊    | 517/886 [00:15<00:05, 62.83it/s]
Processing batches:  59%|█████▉    | 524/886 [00:15<00:05, 62.89it/s]
Processing batches:  60%|█████▉    | 531/886 [00:15<00:05, 62.89it/s]
Processing batches:  61%|██████    | 538/886 [00:15<00:05, 63.07it/s]
Processing batches:  62%|██████▏   | 545/886 [00:16<00:05, 62.48it/s]
Processing batches:  62%|██████▏   | 552/886 [00:16<00:05, 62.80it/s]
Processing batches:  63%|██████▎   | 559/886 [00:16<00:05, 63.13it/s]
Processing batches:  64%|██████▍   | 566/886 [00:16<00:05, 63.09it/s]
Processing batches:  65%|██████▍   | 573/886 [00:16<00:04, 63.06it/s]
Processing batches:  65%|██████▌   | 580/886 [00:16<00:04, 62.71it/s]
Processing batches:  66%|██████▋   | 587/886 [00:16<00:04, 62.97it/s]
Processing batches:  67%|██████▋   | 594/886 [00:16<00:04, 62.95it/s]
Processing batches:  68%|██████▊   | 601/886 [00:16<00:04, 63.28it/s]
Processing batches:  69%|██████▊   | 608/886 [00:17<00:04, 63.44it/s]
Processing batches:  69%|██████▉   | 615/886 [00:17<00:04, 63.34it/s]
Processing batches:  70%|███████   | 622/886 [00:17<00:04, 62.96it/s]
Processing batches:  71%|███████   | 629/886 [00:17<00:04, 63.08it/s]
Processing batches:  72%|███████▏  | 636/886 [00:17<00:03, 63.22it/s]
Processing batches:  73%|███████▎  | 643/886 [00:17<00:03, 63.29it/s]
Processing batches:  73%|███████▎  | 650/886 [00:17<00:03, 63.34it/s]
Processing batches:  74%|███████▍  | 657/886 [00:17<00:03, 63.02it/s]
Processing batches:  75%|███████▍  | 664/886 [00:17<00:03, 63.27it/s]
Processing batches:  76%|███████▌  | 671/886 [00:18<00:03, 63.39it/s]
Processing batches:  77%|███████▋  | 678/886 [00:18<00:03, 63.43it/s]
Processing batches:  77%|███████▋  | 685/886 [00:18<00:03, 63.36it/s]
Processing batches:  78%|███████▊  | 692/886 [00:18<00:03, 63.32it/s]
Processing batches:  79%|███████▉  | 699/886 [00:18<00:02, 62.99it/s]
Processing batches:  80%|███████▉  | 706/886 [00:18<00:02, 63.06it/s]
Processing batches:  80%|████████  | 713/886 [00:18<00:02, 63.06it/s]
Processing batches:  81%|████████▏ | 720/886 [00:18<00:02, 63.16it/s]
Processing batches:  82%|████████▏ | 727/886 [00:18<00:02, 62.98it/s]
Processing batches:  83%|████████▎ | 734/886 [00:19<00:02, 63.07it/s]
Processing batches:  84%|████████▎ | 741/886 [00:19<00:02, 62.68it/s]
Processing batches:  84%|████████▍ | 748/886 [00:19<00:02, 63.00it/s]
Processing batches:  85%|████████▌ | 755/886 [00:19<00:02, 63.11it/s]
Processing batches:  86%|████████▌ | 762/886 [00:19<00:01, 63.00it/s]
Processing batches:  87%|████████▋ | 769/886 [00:19<00:01, 63.17it/s]
Processing batches:  88%|████████▊ | 776/886 [00:19<00:01, 62.82it/s]
Processing batches:  88%|████████▊ | 783/886 [00:19<00:01, 63.04it/s]
Processing batches:  89%|████████▉ | 790/886 [00:19<00:01, 63.17it/s]
Processing batches:  90%|████████▉ | 797/886 [00:20<00:01, 62.94it/s]
Processing batches:  91%|█████████ | 804/886 [00:20<00:01, 62.76it/s]
Processing batches:  92%|█████████▏| 811/886 [00:20<00:01, 62.74it/s]
Processing batches:  92%|█████████▏| 818/886 [00:20<00:01, 62.60it/s]
Processing batches:  93%|█████████▎| 825/886 [00:20<00:00, 62.94it/s]
Processing batches:  94%|█████████▍| 832/886 [00:20<00:00, 62.94it/s]
Processing batches:  95%|█████████▍| 839/886 [00:20<00:00, 63.02it/s]
Processing batches:  95%|█████████▌| 846/886 [00:20<00:00, 63.04it/s]
Processing batches:  96%|█████████▋| 853/886 [00:20<00:00, 62.72it/s]
Processing batches:  97%|█████████▋| 860/886 [00:21<00:00, 63.05it/s]
Processing batches:  98%|█████████▊| 867/886 [00:21<00:00, 62.97it/s]
Processing batches:  99%|█████████▊| 874/886 [00:21<00:00, 63.07it/s]
Processing batches:  99%|█████████▉| 881/886 [00:21<00:00, 63.04it/s]
Processing batches: 100%|██████████| 886/886 [00:21<00:00, 41.27it/s]
# writing ./shards/webdataset/benchmark-train-000001.tar 3820 0.1 GB 3820
# writing ./shards/webdataset/benchmark-train-000002.tar 3905 0.1 GB 7725
# writing ./shards/webdataset/benchmark-train-000003.tar 3882 0.1 GB 11607
# writing ./shards/webdataset/benchmark-train-000004.tar 3932 0.1 GB 15539
# writing ./shards/webdataset/benchmark-train-000005.tar 3808 0.1 GB 19347
# writing ./shards/webdataset/benchmark-train-000006.tar 3777 0.1 GB 23124
# writing ./shards/webdataset/benchmark-train-000007.tar 3862 0.1 GB 26986
# writing ./shards/webdataset/benchmark-train-000008.tar 3844 0.1 GB 30830
# writing ./shards/webdataset/benchmark-train-000009.tar 3850 0.1 GB 34680
# writing ./shards/webdataset/benchmark-train-000010.tar 3876 0.1 GB 38556
# writing ./shards/webdataset/benchmark-train-000011.tar 3909 0.1 GB 42465
# writing ./shards/webdataset/benchmark-train-000012.tar 3791 0.1 GB 46256
# writing ./shards/webdataset/benchmark-train-000013.tar 3846 0.1 GB 50102
# writing ./shards/webdataset/benchmark-train-000014.tar 3863 0.1 GB 53965
# writing ./shards/webdataset/benchmark-train-000015.tar 3848 0.1 GB 57813
# writing ./shards/webdataset/benchmark-train-000016.tar 3967 0.1 GB 61780
# writing ./shards/webdataset/benchmark-train-000017.tar 3888 0.1 GB 65668
# writing ./shards/webdataset/benchmark-train-000018.tar 3955 0.1 GB 69623
# writing ./shards/webdataset/benchmark-train-000019.tar 3906 0.1 GB 73529
# writing ./shards/webdataset/benchmark-train-000020.tar 3828 0.1 GB 77357
# writing ./shards/webdataset/benchmark-train-000021.tar 3860 0.1 GB 81217
# writing ./shards/webdataset/benchmark-train-000022.tar 3881 0.1 GB 85098
Successfully processed and wrote 88514 samples
Dataset processed. Output in ./shards/webdataset/
Dataset write time: 24.03 seconds
Total script execution time: 28.14 seconds
Converting ./data/benchmark_dataset.parquet to WebDataset format in ./shards/webdataset
Running: /home/ec2-user/benchmark-dataloader/.venv/bin/python prepare_data/webdataset_converter.py --data ./data/benchmark_dataset.parquet --shards ./shards/webdataset --prefix benchmark --num_workers 8

Timing Summary:
  Converter execution time: 30.49 seconds
  Total script time: 30.50 seconds
